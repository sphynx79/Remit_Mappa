(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return W})),n.d(e,"c",(function(){return H})),n.d(e,"b",(function(){return M}));var i=Object.assign;function r(t,e){-1===t.indexOf(e)&&t.push(e)}var o=0;var a=Object.freeze({equals:function(){return!1}});function s(t){return null!==t&&void 0!==t}var l=!1;function u(){return l}function c(t,e){return t._equals=e,t}function h(t,e,n){return(t._equals||function(t,e){return Object.is(t,e)||t&&"function"==typeof t.equals&&t.equals(e)})(e,n)}var p="ATOM",f="DERIVATION",d="LENS",m="REACTOR";function v(t){return t&&(t._type===f||t._type===p||t._type===d)}var g=0,y=1,_=2,x=3,b=[],w=null;function E(t,e){b.push({parents:e,offset:0,child:t}),w=t}function S(){b.pop(),w=0===b.length?null:b[b.length-1].child}function C(t){if(null!==w){var e=b[b.length-1];if(e.parents[e.offset]===t)e.offset++;else{var n=e.parents.indexOf(t);if(-1===n)void 0!==w&&r(t._activeChildren,w),e.offset===e.parents.length?e.parents.push(t):(e.parents.push(e.parents[e.offset]),e.parents[e.offset]=t),e.offset++;else if(n>e.offset){var i=e.parents[n];e.parents[n]=e.parents[e.offset],e.parents[e.offset]=i,e.offset++}}}}function T(t,e){void 0===e&&(e=null),this._deriver=t,this._parents=null,this._type=f,this._value=a,this._equals=null,this._activeChildren=[],this._state=x,this._meta=e,u()&&(this.stack=Error().stack)}function A(t,e){if(function(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}(t._activeChildren,e),0===t._activeChildren.length&&null!=t._parents){for(var n=t._parents.length,i=0;i<n;i++)A(t._parents[i],t);t._parents=null,t._state=x}}function M(t,e){if("function"!=typeof t)throw Error("derive requires function");return new T(t,e)}function I(t,e){this._parent=t,this.react=e,this._governor=null,this._active=!1,this._reacting=!1,this._type=m,u()&&(this.stack=Error().stack)}function k(t,e,n){if("function"!=typeof e)throw Error("the first argument to .react must be a function");var r=(n=i({once:!1,skipFirst:!1},n)).skipFirst,o=new I(t,function(t){r?r=!1:(e(t),n.once&&(o.stop(),p.stop()))}),a=function(t,e){if(v(t))return t;if("function"==typeof t)return t;if(void 0===t)return t;throw Error("react "+e+" condition must be derivable or function, got: "+JSON.stringify(t))},s=function(e,n){return e?"function"==typeof e?e(t):e.get():n},l=a(n.from,"from"),u=a(n.until,"until"),c=a(n.when,"when"),h=!1,p=new I(M((function(){return{from:s(l,!0),until:s(u,!1),when:s(c,!0)}})),function(t){t.from&&(h=!0),h&&(t.until?(o.stop(),p.stop()):t.when?o._active||(o.start(),o.force()):o._active&&o.stop())});p.start(),p.force(),o._governor=p}i(T.prototype,{_clone:function(){return c(M(this._deriver),this._equals)},_forceEval:function(){var t,e=null;try{if(null===this._parents&&(this._parents=[]),E(this,this._parents),u())try{e=this._deriver()}catch(t){throw console.error(this.stack),t}else e=this._deriver();t=b[b.length-1].offset}finally{S()}h(this,e,this._value)?this._state=_:this._state=y;for(var n=t,i=this._parents.length;n<i;n++){A(this._parents[n],this),this._parents[n]=null}this._parents.length=t,this._value=e},_update:function(){if(null===this._parents)this._forceEval();else if(this._state===g){for(var t=this._parents.length,e=0;e<t;e++){var n=this._parents[e];if(n._state===g&&n._update(),n._state===y){this._forceEval();break}}this._state===g&&(this._state=_)}},get:function(){if(C(this),this._activeChildren.length>0)this._update();else{E(void 0,[]);try{this._value=this._deriver()}finally{S()}}return this._value}}),i(I.prototype,{start:function(){this._active=!0,r(this._parent._activeChildren,this),this._parent.get()},_force:function(t){try{this._reacting=!0,this.react(t)}catch(t){throw u()&&console.error(this.stack),t}finally{this._reacting=!1}},force:function(){this._force(this._parent.get())},stop:function(){A(this._parent,this),this._active=!1},_maybeReact:function(){if(!this._reacting&&this._active&&(null!==this._governor&&this._governor._maybeReact(),this._active)){var t=this._parent.get();this._parent._state===y&&this._force(t)}}});var z={derive:function(t){var e=this;if("function"!=typeof t)throw Error("derive requires function");return M((function(){return t(e.get())}))},maybeDerive:function(t){var e=this;if("function"!=typeof t)throw Error("maybeDerive requires function");return M((function(){var n=e.get();return s(n)?t(n):null}))},orDefault:function(t){if(!s(t))throw Error("orDefault requires non-null value");return this.derive((function(e){return s(e)?e:t}))},react:function(t,e){k(this,t,e)},maybeReact:function(t,e){var n=this.derive(Boolean);if(e&&"when"in e&&!0!==e.when){var r=e.when;if("function"==typeof r||!1===r)r=M(r);else if(!v(r))throw new Error("when condition must be bool, function, or derivable");n=n.derive((function(t){return t&&r.get()}))}k(this,t,i({},e,{when:n}))},is:function(t){var e=this;return M((function(){return h(e,e.get(),v(n=t)?n.get():n);var n}))},withEquality:function(t){if(t){if("function"!=typeof t)throw new Error("equals must be function")}else t=null;return c(this._clone(),t)}},D={update:function(t,e,n,i,r){switch(arguments.length){case 0:throw Error("update method accepts at least 1 argument");case 1:return this.set(t(this.get()));case 2:return this.set(t(this.get(),e));case 3:return this.set(t(this.get(),e,n));case 4:return this.set(t(this.get(),e,n,i));case 5:return this.set(t(this.get(),e,n,i,r));default:throw Error("update method accepts only 5 arguments")}}};function L(t,e){for(var n=0,i=t._activeChildren.length;n<i;n++){var r=t._activeChildren[n];switch(r._type){case f:case d:r._state!==g&&(r._state=g,L(r,e));break;case m:e.push(r)}}}function P(t){for(var e=0,n=t.length;e<n;e++){var i=t[e];if(i._reacting)throw Error("Synchronous cyclical reactions disallowed. Use setImmediate.");i._maybeReact()}}var O={};function R(){throw O}var B=null;function F(){return null!==B}function N(t){j();try{t(R)}catch(t){if(q(),t!==O)throw t;return}U()}function V(t){F()?t():N(t)}function j(){B=new function(t){this.parent=t,this.id2originalValue={},this.modifiedAtoms=[]}(B)}function U(){var t=B;if(null===(B=t.parent)){var e=[];t.modifiedAtoms.forEach((function(n){h(n,n._value,t.id2originalValue[n._id])?n._state=_:(n._state=y,L(n,e))})),P(e),t.modifiedAtoms.forEach((function(t){t._state=_}))}}function q(){var t=B;B=t.parent,t.modifiedAtoms.forEach((function(e){e._value=t.id2originalValue[e._id],e._state=_,L(e,[])}))}var $="object"==typeof window?window:"object"==typeof t?t:{},Z=$.__DERIVABLE_DEVTOOLS_HOOK__;function G(t,e){void 0===e&&(e=null),this._id=o++,this._activeChildren=[],this._value=t,this._state=_,this._type=p,this._equals=null,this._meta=e}function W(t,e){return new G(t,e)}function Y(t,e){T.call(this,t.get,e),this._descriptor=t,this._type=d}function H(t,e){return new Y(t,e)}i(G.prototype,{_clone:function(){return c(W(this._value),this._equals)},set:function(t){var e;e=this,null!==B&&(e._id in B.id2originalValue||(B.modifiedAtoms.push(e),B.id2originalValue[e._id]=e._value));var n=this._value;if(this._value=t,!F()&&!h(this,t,n))try{this._state=y;var i=[];L(this,i),P(i)}finally{this._state=_}},get:function(){return"function"==typeof Z&&Z("captureAtom",this),C(this),this._value}}),i(Y.prototype,T.prototype,{_clone:function(){return c(new Y(this._descriptor),this._equals)},set:function(t){var e=this;V((function(){e._descriptor.set(t)}))}}),i(T.prototype,z),i(Y.prototype,z,D),i(G.prototype,z,D),$.__DERIVABLE_INIT_FLAG__&&console.warn("Multiple instances of derivable have been initialized on the same page"),$.__DERIVABLE_INIT_FLAG__=!0}).call(this,n(11))},1:function(t,e,n){(function(e,n){!(function(){"use strict";function i(t,e,n,i,r,o){return{tag:t,key:e,attrs:n,children:i,text:r,dom:o,domSize:void 0,state:void 0,_state:void 0,events:void 0,instance:void 0,skip:!1}}i.normalize=function(t){return Array.isArray(t)?i("[",void 0,void 0,i.normalizeChildren(t),void 0,void 0):null!=t&&"object"!=typeof t?i("#",void 0,void 0,!1===t?"":t,void 0,void 0):t},i.normalizeChildren=function(t){for(var e=0;e<t.length;e++)t[e]=i.normalize(t[e]);return t};var r=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,o={},a={}.hasOwnProperty;function s(t){for(var e in t)if(a.call(t,e))return!1;return!0}function l(t){var e,n=arguments[1],l=2;if(null==t||"string"!=typeof t&&"function"!=typeof t&&"function"!=typeof t.view)throw Error("The selector must be either a string or a component.");if("string"==typeof t)var u=o[t]||(function(t){for(var e,n="div",i=[],a={};e=r.exec(t);){var s=e[1],l=e[2];if(""===s&&""!==l)n=l;else if("#"===s)a.id=l;else if("."===s)i.push(l);else if("["===e[3][0]){var u=e[6];u&&(u=u.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===e[4]?i.push(u):a[e[4]]=""===u?u:u||!0}}return i.length>0&&(a.className=i.join(" ")),o[t]={tag:n,attrs:a}})(t);if(null==n?n={}:("object"!=typeof n||null!=n.tag||Array.isArray(n))&&(n={},l=1),arguments.length===l+1)e=arguments[l],Array.isArray(e)||(e=[e]);else for(e=[];l<arguments.length;)e.push(arguments[l++]);var c=i.normalizeChildren(e);return"string"==typeof t?(function(t,e,n){var r,o,l=!1,u=e.className||e.class;if(!s(t.attrs)&&!s(e)){var c={};for(var h in e)a.call(e,h)&&(c[h]=e[h]);e=c}for(var h in t.attrs)a.call(t.attrs,h)&&(e[h]=t.attrs[h]);for(var h in void 0!==u&&(void 0!==e.class&&(e.class=void 0,e.className=u),null!=t.attrs.className&&(e.className=t.attrs.className+" "+u)),e)if(a.call(e,h)&&"key"!==h){l=!0;break}return Array.isArray(n)&&1===n.length&&null!=n[0]&&"#"===n[0].tag?o=n[0].children:r=n,i(t.tag,e.key,l?e:void 0,r,o)})(u,n,c):i(t,n.key,n,c)}l.trust=function(t){return null==t&&(t=""),i("<",void 0,void 0,t,void 0,void 0)},l.fragment=function(t,e){return i("[",t.key,t,i.normalizeChildren(e),void 0,void 0)};var u=l;if((c=function(t){if(!(this instanceof c))throw new Error("Promise must be called with `new`");if("function"!=typeof t)throw new TypeError("executor must be a function");var n=this,i=[],r=[],o=u(i,!0),a=u(r,!1),s=n._instance={resolvers:i,rejectors:r},l="function"==typeof e?e:setTimeout;function u(t,e){return function o(u){var c;try{if(!e||null==u||"object"!=typeof u&&"function"!=typeof u||"function"!=typeof(c=u.then))l((function(){e||0!==t.length||console.error("Possible unhandled promise rejection:",u);for(var n=0;n<t.length;n++)t[n](u);i.length=0,r.length=0,s.state=e,s.retry=function(){o(u)}}));else{if(u===n)throw new TypeError("Promise can't be resolved w/ itself");h(c.bind(u))}}catch(t){a(t)}}}function h(t){var e=0;function n(t){return function(n){e++>0||t(n)}}var i=n(a);try{t(n(o),i)}catch(t){i(t)}}h(t)}).prototype.then=function(t,e){var n,i,r=this._instance;function o(t,e,o,a){e.push((function(e){if("function"!=typeof t)o(e);else try{n(t(e))}catch(t){i&&i(t)}})),"function"==typeof r.retry&&a===r.state&&r.retry()}var a=new c(function(t,e){n=t,i=e});return o(t,r.resolvers,n,!0),o(e,r.rejectors,i,!1),a},c.prototype.catch=function(t){return this.then(null,t)},c.resolve=function(t){return t instanceof c?t:new c(function(e){e(t)})},c.reject=function(t){return new c(function(e,n){n(t)})},c.all=function(t){return new c(function(e,n){var i=t.length,r=0,o=[];if(0===t.length)e([]);else for(var a=0;a<t.length;a++)!(function(a){function s(t){r++,o[a]=t,r===i&&e(o)}null==t[a]||"object"!=typeof t[a]&&"function"!=typeof t[a]||"function"!=typeof t[a].then?s(t[a]):t[a].then(s,n)})(a)})},c.race=function(t){return new c(function(e,n){for(var i=0;i<t.length;i++)t[i].then(e,n)})},"undefined"!=typeof window){void 0===window.Promise&&(window.Promise=c);var c=window.Promise}else if(void 0!==n){void 0===n.Promise&&(n.Promise=c);c=n.Promise}var h=function(t){if("[object Object]"!==Object.prototype.toString.call(t))return"";var e=[];for(var n in t)i(n,t[n]);return e.join("&");function i(t,n){if(Array.isArray(n))for(var r=0;r<n.length;r++)i(t+"["+r+"]",n[r]);else if("[object Object]"===Object.prototype.toString.call(n))for(var r in n)i(t+"["+r+"]",n[r]);else e.push(encodeURIComponent(t)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}},p=new RegExp("^file://","i"),f=(function(t,e){var n,i=0;function r(){var t=0;function e(){0==--t&&"function"==typeof n&&n()}return function n(i){var r=i.then;return i.then=function(){t++;var o=r.apply(i,arguments);return o.then(e,(function(n){if(e(),0===t)throw n})),n(o)},i}}function o(t,e){if("string"==typeof t){var n=t;null==(t=e||{}).url&&(t.url=n)}return t}function a(t,e){if(null==e)return t;for(var n=t.match(/:[^\/]+/gi)||[],i=0;i<n.length;i++){var r=n[i].slice(1);null!=e[r]&&(t=t.replace(n[i],e[r]))}return t}function s(t,e){var n=h(e);return""!==n&&(t+=(t.indexOf("?")<0?"?":"&")+n),t}function l(t){try{return""!==t?JSON.parse(t):null}catch(e){throw new Error(t)}}function u(t){return t.responseText}function c(t,e){if("function"==typeof t){if(!Array.isArray(e))return new t(e);for(var n=0;n<e.length;n++)e[n]=new t(e[n])}return e}return{request:function(n,i){var h=r();n=o(n,i);var f=new e(function(e,i){null==n.method&&(n.method="GET"),n.method=n.method.toUpperCase();var r="GET"!==n.method&&"TRACE"!==n.method&&("boolean"!=typeof n.useBody||n.useBody);"function"!=typeof n.serialize&&(n.serialize="undefined"!=typeof FormData&&n.data instanceof FormData?function(t){return t}:JSON.stringify),"function"!=typeof n.deserialize&&(n.deserialize=l),"function"!=typeof n.extract&&(n.extract=u),n.url=a(n.url,n.data),r?n.data=n.serialize(n.data):n.url=s(n.url,n.data);var o=new t.XMLHttpRequest,h=!1,f=o.abort;for(var d in o.abort=function(){h=!0,f.call(o)},o.open(n.method,n.url,"boolean"!=typeof n.async||n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),n.serialize!==JSON.stringify||!r||n.headers&&n.headers.hasOwnProperty("Content-Type")||o.setRequestHeader("Content-Type","application/json; charset=utf-8"),n.deserialize!==l||n.headers&&n.headers.hasOwnProperty("Accept")||o.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(o.withCredentials=n.withCredentials),n.headers)({}).hasOwnProperty.call(n.headers,d)&&o.setRequestHeader(d,n.headers[d]);"function"==typeof n.config&&(o=n.config(o,n)||o),o.onreadystatechange=function(){if(!h&&4===o.readyState)try{var t=n.extract!==u?n.extract(o,n):n.deserialize(n.extract(o,n));if(o.status>=200&&o.status<300||304===o.status||p.test(n.url))e(c(n.type,t));else{var r=new Error(o.responseText);for(var a in t)r[a]=t[a];i(r)}}catch(t){i(t)}},r&&null!=n.data?o.send(n.data):o.send()});return!0===n.background?f:h(f)},jsonp:function(n,l){var u=r();n=o(n,l);var h=new e(function(e,r){var o=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+i++,l=t.document.createElement("script");t[o]=function(i){l.parentNode.removeChild(l),e(c(n.type,i)),delete t[o]},l.onerror=function(){l.parentNode.removeChild(l),r(new Error("JSONP request failed")),delete t[o]},null==n.data&&(n.data={}),n.url=a(n.url,n.data),n.data[n.callbackKey||"callback"]=o,l.src=s(n.url,n.data),t.document.documentElement.appendChild(l)});return!0===n.background?h:u(h)},setCompletionCallback:function(t){n=t}}})(window,c),d=function(t){var e,n=t.document,r=n.createDocumentFragment(),o={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function a(t){return t.attrs&&t.attrs.xmlns||o[t.tag]}function s(t,e,n,i,r,o,a){for(var s=n;s<i;s++){var u=e[s];null!=u&&l(t,u,r,a,o)}}function l(t,e,o,h,p){var f=e.tag;if("string"!=typeof f)return (function(t,e,n,i,o){if(c(e,n),null!=e.instance){var a=l(t,e.instance,n,i,o);return e.dom=e.instance.dom,e.domSize=null!=e.dom?e.instance.domSize:0,v(t,a,o),a}return e.domSize=0,r})(t,e,o,h,p);switch(e.state={},null!=e.attrs&&S(e.attrs,e,o),f){case"#":return (function(t,e,i){return e.dom=n.createTextNode(e.children),v(t,e.dom,i),e.dom})(t,e,p);case"<":return u(t,e,p);case"[":return (function(t,e,i,r,o){var a=n.createDocumentFragment();if(null!=e.children){var l=e.children;s(a,l,0,l.length,i,null,r)}return e.dom=a.firstChild,e.domSize=a.childNodes.length,v(t,a,o),a})(t,e,o,h,p);default:return (function(t,e,r,o,l){var u=e.tag,c=e.attrs,h=c&&c.is,p=(o=a(e)||o)?h?n.createElementNS(o,u,{is:h}):n.createElementNS(o,u):h?n.createElement(u,{is:h}):n.createElement(u);e.dom=p,null!=c&&(function(t,e,n){for(var i in e)b(t,i,null,e[i],n)})(e,c,o);if(v(t,p,l),null!=e.attrs&&null!=e.attrs.contenteditable)g(e);else if(null!=e.text&&(""!==e.text?p.textContent=e.text:e.children=[i("#",void 0,void 0,e.text,void 0,void 0)]),null!=e.children){var f=e.children;s(p,f,0,f.length,r,null,o),(function(t){var e=t.attrs;"select"===t.tag&&null!=e&&("value"in e&&b(t,"value",null,e.value,void 0),"selectedIndex"in e&&b(t,"selectedIndex",null,e.selectedIndex,void 0))})(e)}return p})(t,e,o,h,p)}}function u(t,e,i){var r={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"}[(e.children.match(/^\s*?<(\w+)/im)||[])[1]]||"div",o=n.createElement(r);o.innerHTML=e.children,e.dom=o.firstChild,e.domSize=o.childNodes.length;for(var a,s=n.createDocumentFragment();a=o.firstChild;)s.appendChild(a);return v(t,s,i),s}function c(t,e){var n;if("function"==typeof t.tag.view){if(t.state=Object.create(t.tag),null!=(n=t.state.view).$$reentrantLock$$)return r;n.$$reentrantLock$$=!0}else{if(t.state=void 0,null!=(n=t.tag).$$reentrantLock$$)return r;n.$$reentrantLock$$=!0,t.state=null!=t.tag.prototype&&"function"==typeof t.tag.prototype.view?new t.tag(t):t.tag(t)}if(t._state=t.state,null!=t.attrs&&S(t.attrs,t,e),S(t._state,t,e),t.instance=i.normalize(t._state.view.call(t.state,t)),t.instance===t)throw Error("A view cannot return the vnode it received as argument");n.$$reentrantLock$$=null}function h(t,e,n,i,r,o,a){if(e!==n&&(null!=e||null!=n))if(null==e)s(t,n,0,n.length,r,o,a);else if(null==n)y(e,0,e.length,n);else{if(e.length===n.length){for(var u=!1,c=0;c<n.length;c++)if(null!=n[c]&&null!=e[c]){u=null==n[c].key&&null==e[c].key;break}if(u){for(c=0;c<e.length;c++)e[c]!==n[c]&&(null==e[c]&&null!=n[c]?l(t,n[c],r,a,m(e,c+1,o)):null==n[c]?y(e,c,c+1,n):p(t,e[c],n[c],r,m(e,c+1,o),i,a));return}}if(i=i||(function(t,e){if(null!=t.pool&&Math.abs(t.pool.length-e.length)<=Math.abs(t.length-e.length)){var n=t[0]&&t[0].children&&t[0].children.length||0,i=t.pool[0]&&t.pool[0].children&&t.pool[0].children.length||0,r=e[0]&&e[0].children&&e[0].children.length||0;if(Math.abs(i-r)<=Math.abs(n-r))return!0}return!1})(e,n)){var h=e.pool;e=e.concat(e.pool)}for(var g,_=0,x=0,b=e.length-1,w=n.length-1;b>=_&&w>=x;){if((S=e[_])!==(C=n[x])||i)if(null==S)_++;else if(null==C)x++;else if(S.key===C.key){var E=null!=h&&_>=e.length-h.length||null==h&&i;x++,p(t,S,C,r,m(e,++_,o),E,a),i&&S.tag===C.tag&&v(t,d(S),o)}else{if((S=e[b])!==C||i)if(null==S)b--;else if(null==C)x++;else{if(S.key!==C.key)break;E=null!=h&&b>=e.length-h.length||null==h&&i;p(t,S,C,r,m(e,b+1,o),E,a),(i||x<w)&&v(t,d(S),m(e,_,o)),b--,x++}else b--,x++}else _++,x++}for(;b>=_&&w>=x;){var S,C;if((S=e[b])!==(C=n[w])||i)if(null==S)b--;else if(null==C)w--;else if(S.key===C.key){E=null!=h&&b>=e.length-h.length||null==h&&i;p(t,S,C,r,m(e,b+1,o),E,a),i&&S.tag===C.tag&&v(t,d(S),o),null!=S.dom&&(o=S.dom),b--,w--}else{if(g||(g=f(e,b)),null!=C){var T=g[C.key];if(null!=T){var A=e[T];E=null!=h&&T>=e.length-h.length||null==h&&i;p(t,A,C,r,m(e,b+1,o),i,a),v(t,d(A),o),e[T].skip=!0,null!=A.dom&&(o=A.dom)}else{o=l(t,C,r,a,o)}}w--}else b--,w--;if(w<x)break}s(t,n,x,w+1,r,o,a),y(e,_,b+1,n)}}function p(t,e,n,r,o,s,f){var m=e.tag;if(m===n.tag){if(n.state=e.state,n._state=e._state,n.events=e.events,!s&&(function(t,e){var n,i;null!=t.attrs&&"function"==typeof t.attrs.onbeforeupdate&&(n=t.attrs.onbeforeupdate.call(t.state,t,e));"string"!=typeof t.tag&&"function"==typeof t._state.onbeforeupdate&&(i=t._state.onbeforeupdate.call(t.state,t,e));if(!(void 0===n&&void 0===i||n||i))return t.dom=e.dom,t.domSize=e.domSize,t.instance=e.instance,!0;return!1})(n,e))return;if("string"==typeof m)switch(null!=n.attrs&&(s?(n.state={},S(n.attrs,n,r)):C(n.attrs,n,r)),m){case"#":!(function(t,e){t.children.toString()!==e.children.toString()&&(t.dom.nodeValue=e.children);e.dom=t.dom})(e,n);break;case"<":!(function(t,e,n,i){e.children!==n.children?(d(e),u(t,n,i)):(n.dom=e.dom,n.domSize=e.domSize)})(t,e,n,o);break;case"[":!(function(t,e,n,i,r,o,a){h(t,e.children,n.children,i,r,o,a);var s=0,l=n.children;if(n.dom=null,null!=l){for(var u=0;u<l.length;u++){var c=l[u];null!=c&&null!=c.dom&&(null==n.dom&&(n.dom=c.dom),s+=c.domSize||1)}1!==s&&(n.domSize=s)}})(t,e,n,s,r,o,f);break;default:!(function(t,e,n,r,o){var s=e.dom=t.dom;o=a(e)||o,"textarea"===e.tag&&(null==e.attrs&&(e.attrs={}),null!=e.text&&(e.attrs.value=e.text,e.text=void 0));(function(t,e,n,i){if(null!=n)for(var r in n)b(t,r,e&&e[r],n[r],i);if(null!=e)for(var r in e)null!=n&&r in n||("className"===r&&(r="class"),"o"!==r[0]||"n"!==r[1]||w(r)?"key"!==r&&t.dom.removeAttribute(r):E(t,r,void 0))})(e,t.attrs,e.attrs,o),null!=e.attrs&&null!=e.attrs.contenteditable?g(e):null!=t.text&&null!=e.text&&""!==e.text?t.text.toString()!==e.text.toString()&&(t.dom.firstChild.nodeValue=e.text):(null!=t.text&&(t.children=[i("#",void 0,void 0,t.text,void 0,t.dom.firstChild)]),null!=e.text&&(e.children=[i("#",void 0,void 0,e.text,void 0,void 0)]),h(s,t.children,e.children,n,r,null,o))})(e,n,s,r,f)}else!(function(t,e,n,r,o,a,s){if(a)c(n,r);else{if(n.instance=i.normalize(n._state.view.call(n.state,n)),n.instance===n)throw Error("A view cannot return the vnode it received as argument");null!=n.attrs&&C(n.attrs,n,r),C(n._state,n,r)}null!=n.instance?(null==e.instance?l(t,n.instance,r,s,o):p(t,e.instance,n.instance,r,o,a,s),n.dom=n.instance.dom,n.domSize=n.instance.domSize):null!=e.instance?(_(e.instance,null),n.dom=void 0,n.domSize=0):(n.dom=e.dom,n.domSize=e.domSize)})(t,e,n,r,o,s,f)}else _(e,null),l(t,n,r,f,o)}function f(t,e){var n={},i=0;for(i=0;i<e;i++){var r=t[i];if(null!=r){var o=r.key;null!=o&&(n[o]=i)}}return n}function d(t){var e=t.domSize;if(null!=e||null==t.dom){var i=n.createDocumentFragment();if(e>0){for(var r=t.dom;--e;)i.appendChild(r.nextSibling);i.insertBefore(r,i.firstChild)}return i}return t.dom}function m(t,e,n){for(;e<t.length;e++)if(null!=t[e]&&null!=t[e].dom)return t[e].dom;return n}function v(t,e,n){n&&n.parentNode?t.insertBefore(e,n):t.appendChild(e)}function g(t){var e=t.children;if(null!=e&&1===e.length&&"<"===e[0].tag){var n=e[0].children;t.dom.innerHTML!==n&&(t.dom.innerHTML=n)}else if(null!=t.text||null!=e&&0!==e.length)throw new Error("Child node of a contenteditable must be trusted")}function y(t,e,n,i){for(var r=e;r<n;r++){var o=t[r];null!=o&&(o.skip?o.skip=!1:_(o,i))}}function _(t,e){var n,i=1,r=0;t.attrs&&"function"==typeof t.attrs.onbeforeremove&&(null!=(n=t.attrs.onbeforeremove.call(t.state,t))&&"function"==typeof n.then&&(i++,n.then(o,o)));"string"!=typeof t.tag&&"function"==typeof t._state.onbeforeremove&&(null!=(n=t._state.onbeforeremove.call(t.state,t))&&"function"==typeof n.then&&(i++,n.then(o,o)));function o(){if(++r===i&&(function t(e){e.attrs&&"function"==typeof e.attrs.onremove&&e.attrs.onremove.call(e.state,e);if("string"!=typeof e.tag)"function"==typeof e._state.onremove&&e._state.onremove.call(e.state,e),null!=e.instance&&t(e.instance);else{var n=e.children;if(Array.isArray(n))for(var i=0;i<n.length;i++){var r=n[i];null!=r&&t(r)}}}(t),t.dom)){var n=t.domSize||1;if(n>1)for(var o=t.dom;--n;)x(o.nextSibling);x(t.dom),null==e||null!=t.domSize||null!=(a=t.attrs)&&(a.oncreate||a.onupdate||a.onbeforeremove||a.onremove)||"string"!=typeof t.tag||(e.pool?e.pool.push(t):e.pool=[t])}var a}o()}function x(t){var e=t.parentNode;null!=e&&e.removeChild(t)}function b(t,e,i,r,o){var a=t.dom;if("key"!==e&&"is"!==e&&(i!==r||(function(t,e){return"value"===e||"checked"===e||"selectedIndex"===e||"selected"===e&&t.dom===n.activeElement})(t,e)||"object"==typeof r)&&void 0!==r&&!w(e)){var s,l=e.indexOf(":");if(l>-1&&"xlink"===e.substr(0,l))a.setAttributeNS("http://www.w3.org/1999/xlink",e.slice(l+1),r);else if("o"===e[0]&&"n"===e[1]&&"function"==typeof r)E(t,e,r);else if("style"===e)!(function(t,e,n){e===n&&(t.style.cssText="",e=null);if(null==n)t.style.cssText="";else if("string"==typeof n)t.style.cssText=n;else{for(var i in"string"==typeof e&&(t.style.cssText=""),n)t.style[i]=n[i];if(null!=e&&"string"!=typeof e)for(var i in e)i in n||(t.style[i]="")}})(a,i,r);else if(e in a&&("href"!==(s=e)&&"list"!==s&&"form"!==s&&"width"!==s&&"height"!==s)&&void 0===o&&!(function(t){return t.attrs.is||t.tag.indexOf("-")>-1})(t)){if("value"===e){var u=""+r;if(("input"===t.tag||"textarea"===t.tag)&&t.dom.value===u&&t.dom===n.activeElement)return;if("select"===t.tag)if(null===r){if(-1===t.dom.selectedIndex&&t.dom===n.activeElement)return}else if(null!==i&&t.dom.value===u&&t.dom===n.activeElement)return;if("option"===t.tag&&null!=i&&t.dom.value===u)return}if("input"===t.tag&&"type"===e)return void a.setAttribute(e,r);a[e]=r}else"boolean"==typeof r?r?a.setAttribute(e,""):a.removeAttribute(e):a.setAttribute("className"===e?"class":e,r)}}function w(t){return"oninit"===t||"oncreate"===t||"onupdate"===t||"onremove"===t||"onbeforeremove"===t||"onbeforeupdate"===t}function E(t,n,i){var r=t.dom,o="function"!=typeof e?i:function(t){var n=i.call(r,t);return e.call(r,t),n};if(n in r)r[n]="function"==typeof i?o:null;else{var a=n.slice(2);if(void 0===t.events&&(t.events={}),t.events[n]===o)return;null!=t.events[n]&&r.removeEventListener(a,t.events[n],!1),"function"==typeof i&&(t.events[n]=o,r.addEventListener(a,t.events[n],!1))}}function S(t,e,n){"function"==typeof t.oninit&&t.oninit.call(e.state,e),"function"==typeof t.oncreate&&n.push(t.oncreate.bind(e.state,e))}function C(t,e,n){"function"==typeof t.onupdate&&n.push(t.onupdate.bind(e.state,e))}return{render:function(t,e){if(!t)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var r=[],o=n.activeElement,a=t.namespaceURI;null==t.vnodes&&(t.textContent=""),Array.isArray(e)||(e=[e]),h(t,t.vnodes,i.normalizeChildren(e),!1,r,null,"http://www.w3.org/1999/xhtml"===a?void 0:a),t.vnodes=e,null!=o&&n.activeElement!==o&&o.focus();for(var s=0;s<r.length;s++)r[s]()},setEventCallback:function(t){return e=t}}};var m=(function(t){var e=d(t);e.setEventCallback((function(t){!1===t.redraw?t.redraw=void 0:r()}));var n=[];function i(t){var e=n.indexOf(t);e>-1&&n.splice(e,2)}function r(){for(var t=1;t<n.length;t+=2)n[t]()}return{subscribe:function(t,e){i(t),n.push(t,(function(t){var e=0,n=null,i="function"==typeof requestAnimationFrame?requestAnimationFrame:setTimeout;return function(){var r=Date.now();0===e||r-e>=16?(e=r,t()):null===n&&(n=i((function(){n=null,t(),e=Date.now()}),16-(r-e)))}})(e))},unsubscribe:i,redraw:r,render:e.render}})(window);f.setCompletionCallback(m.redraw);var v;u.mount=(v=m,function(t,e){if(null===e)return v.render(t,[]),void v.unsubscribe(t);if(null==e.view&&"function"!=typeof e)throw new Error("m.mount(element, component) expects a component, not a vnode");v.subscribe(t,(function(){v.render(t,i(e))})),v.redraw()});var g=c,y=function(t){if(""===t||null==t)return{};"?"===t.charAt(0)&&(t=t.slice(1));for(var e=t.split("&"),n={},i={},r=0;r<e.length;r++){var o=e[r].split("="),a=decodeURIComponent(o[0]),s=2===o.length?decodeURIComponent(o[1]):"";"true"===s?s=!0:"false"===s&&(s=!1);var l=a.split(/\]\[?|\[/),u=n;a.indexOf("[")>-1&&l.pop();for(var c=0;c<l.length;c++){var h=l[c],p=l[c+1],f=""==p||!isNaN(parseInt(p,10)),d=c===l.length-1;if(""===h)null==i[a=l.slice(0,c).join()]&&(i[a]=0),h=i[a]++;null==u[h]&&(u[h]=d?s:f?[]:{}),u=u[h]}}return n},_=function(t){var n,i="function"==typeof t.history.pushState,r="function"==typeof e?e:setTimeout;function o(e){var n=t.location[e].replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent);return"pathname"===e&&"/"!==n[0]&&(n="/"+n),n}function a(t,e,n){var i=t.indexOf("?"),r=t.indexOf("#"),o=i>-1?i:r>-1?r:t.length;if(i>-1){var a=r>-1?r:t.length,s=y(t.slice(i+1,a));for(var l in s)e[l]=s[l]}if(r>-1){var u=y(t.slice(r+1));for(var l in u)n[l]=u[l]}return t.slice(0,o)}var s={prefix:"#!",getPath:function(){switch(s.prefix.charAt(0)){case"#":return o("hash").slice(s.prefix.length);case"?":return o("search").slice(s.prefix.length)+o("hash");default:return o("pathname").slice(s.prefix.length)+o("search")+o("hash")}},setPath:function(e,n,r){var o={},l={};if(e=a(e,o,l),null!=n){for(var u in n)o[u]=n[u];e=e.replace(/:([^\/]+)/g,(function(t,e){return delete o[e],n[e]}))}var c=h(o);c&&(e+="?"+c);var p=h(l);if(p&&(e+="#"+p),i){var f=r?r.state:null,d=r?r.title:null;t.onpopstate(),r&&r.replace?t.history.replaceState(f,d,s.prefix+e):t.history.pushState(f,d,s.prefix+e)}else t.location.href=s.prefix+e}};return s.defineRoutes=function(e,o,l){function u(){var n=s.getPath(),i={},r=a(n,i,i),u=t.history.state;if(null!=u)for(var c in u)i[c]=u[c];for(var h in e){var p=new RegExp("^"+h.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(p.test(r))return void r.replace(p,(function(){for(var t=h.match(/:[^\/]+/g)||[],r=[].slice.call(arguments,1,-2),a=0;a<t.length;a++)i[t[a].replace(/:|\./g,"")]=decodeURIComponent(r[a]);o(e[h],i,n,h)}))}l(n,i)}var c;i?t.onpopstate=(c=u,function(){null==n&&(n=r((function(){n=null,c()})))}):"#"===s.prefix.charAt(0)&&(t.onhashchange=u),u()},s};u.route=(function(t,e){var n,r,o,a,s,l=_(t),u=function(t,u,c){if(null==t)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var h=function(){null!=n&&e.render(t,n(i(r,o.key,o)))},p=function(t){if(t===u)throw new Error("Could not resolve default route "+u);l.setPath(u,null,{replace:!0})};l.defineRoutes(c,(function(t,e,i){var l=s=function(t,u){l===s&&(r=null==u||"function"!=typeof u.view&&"function"!=typeof u?"div":u,o=e,a=i,s=null,n=(t.render||function(t){return t}).bind(t),h())};t.view||"function"==typeof t?l({},t):t.onmatch?g.resolve(t.onmatch(e,i)).then((function(e){l(t,e)}),p):l(t,"div")}),p),e.subscribe(t,h)};return u.set=function(t,e,n){null!=s&&((n=n||{}).replace=!0),s=null,l.setPath(t,e,n)},u.get=function(){return a},u.prefix=function(t){l.prefix=t},u.link=function(t){t.dom.setAttribute("href",l.prefix+t.attrs.href),t.dom.onclick=function(t){if(!(t.ctrlKey||t.metaKey||t.shiftKey||2===t.which)){t.preventDefault(),t.redraw=!1;var e=this.getAttribute("href");0===e.indexOf(l.prefix)&&(e=e.slice(l.prefix.length)),u.set(e,void 0,void 0)}}},u.param=function(t){return void 0!==o&&void 0!==t?o[t]:o},u})(window,m),u.withAttr=function(t,e,n){return function(i){e.call(n||this,t in i.currentTarget?i.currentTarget[t]:i.currentTarget.getAttribute(t))}};var x=d(window);u.render=x.render,u.redraw=m.redraw,u.request=f.request,u.jsonp=f.jsonp,u.parseQueryString=y,u.buildQueryString=h,u.version="1.1.6",u.vnode=i,t.exports=u})()}).call(this,n(96).setImmediate,n(11))},11:function(t,e){var n;n=(function(){return this})();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},14:function(t,e,n){var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};
/*! flatpickr v2.6.3, @license MIT */
function o(t,e){var n=this;function a(t){return t.bind(n)}function s(t){n.config.noCalendar&&!n.selectedDates.length&&(n.selectedDates=[n.now]),(function(t){t.preventDefault();var e="keydown"===t.type,i=(t.type,t.type,t.target);if(n.amPM&&t.target===n.amPM)return t.target.textContent=["AM","PM"]["AM"===t.target.textContent|0];var r=Number(i.min),o=Number(i.max),a=Number(i.step),s=parseInt(i.value,10),l=t.delta||(e?38===t.which?1:-1:Math.max(-1,Math.min(1,t.wheelDelta||-t.deltaY))||0),u=s+a*l;if(void 0!==i.value&&2===i.value.length){var c=i===n.hourElement,h=i===n.minuteElement;u<r?(u=o+u+!c+(c&&!n.amPM),h&&_(null,-1,n.hourElement)):u>o&&(u=i===n.hourElement?u-o-!n.amPM:r,h&&_(null,1,n.hourElement)),n.amPM&&c&&(1===a?u+s===23:Math.abs(u-s)>a)&&(n.amPM.textContent="PM"===n.amPM.textContent?"AM":"PM"),i.value=n.pad(u)}})(t),n.selectedDates.length&&(!n.minDateHasTime||"input"!==t.type||t.target.value.length>=2?(l(),q()):setTimeout((function(){l(),q()}),1e3))}function l(){if(n.config.enableTime){var t=(parseInt(n.hourElement.value,10)||0)%(n.amPM?12:24),e=(parseInt(n.minuteElement.value,10)||0)%60,i=n.config.enableSeconds?(parseInt(n.secondElement.value,10)||0)%60:0;void 0!==n.amPM&&(t=t%12+12*("PM"===n.amPM.textContent)),n.minDateHasTime&&0===X(n.latestSelectedDateObj,n.config.minDate)&&(t=Math.max(t,n.config.minDate.getHours()))===n.config.minDate.getHours()&&(e=Math.max(e,n.config.minDate.getMinutes())),n.maxDateHasTime&&0===X(n.latestSelectedDateObj,n.config.maxDate)&&(t=Math.min(t,n.config.maxDate.getHours()))===n.config.maxDate.getHours()&&(e=Math.min(e,n.config.maxDate.getMinutes())),c(t,e,i)}}function u(t){var e=t||n.latestSelectedDateObj;e&&c(e.getHours(),e.getMinutes(),e.getSeconds())}function c(t,e,i){n.selectedDates.length&&n.latestSelectedDateObj.setHours(t%24,e,i||0,0),n.config.enableTime&&!n.isMobile&&(n.hourElement.value=n.pad(n.config.time_24hr?t:(12+t)%12+12*(t%12==0)),n.minuteElement.value=n.pad(e),n.config.time_24hr||(n.amPM.textContent=t>=12?"PM":"AM"),!0===n.config.enableSeconds&&(n.secondElement.value=n.pad(i)))}function h(t){var e=t.target.value;t.delta&&(e=(parseInt(e)+t.delta).toString()),4!==e.length&&"Enter"!==t.key||(n.currentYearElement.blur(),/[^\d]/.test(e)||I(e))}function p(t,e,i){return e instanceof Array?e.forEach((function(e){return p(t,e,i)})):t instanceof Array?t.forEach((function(t){return p(t,e,i)})):(t.addEventListener(e,i),void n._handlers.push({element:t,event:e,handler:i}))}function f(t){return function(e){return 1===e.which&&t(e)}}function d(){for(var t=n._animationLoop.length;t--;)n._animationLoop[t](),n._animationLoop.splice(t,1)}function m(t){if(n.daysContainer.childNodes.length>1)switch(t.animationName){case"fpSlideLeft":n.daysContainer.lastChild.classList.remove("slideLeftNew"),n.daysContainer.removeChild(n.daysContainer.firstChild),n.days=n.daysContainer.firstChild,d();break;case"fpSlideRight":n.daysContainer.firstChild.classList.remove("slideRightNew"),n.daysContainer.removeChild(n.daysContainer.lastChild),n.days=n.daysContainer.firstChild,d()}}function v(t){switch(t.animationName){case"fpSlideLeftNew":case"fpSlideRightNew":n.navigationCurrentMonth.classList.remove("slideLeftNew"),n.navigationCurrentMonth.classList.remove("slideRightNew");for(var e=n.navigationCurrentMonth;e.nextSibling&&/curr/.test(e.nextSibling.className);)n.monthNav.removeChild(e.nextSibling);for(;e.previousSibling&&/curr/.test(e.previousSibling.className);)n.monthNav.removeChild(e.previousSibling);n.oldCurMonth=null}}function g(t){t=t?n.parseDate(t):n.latestSelectedDateObj||(n.config.minDate>n.now?n.config.minDate:n.config.maxDate&&n.config.maxDate<n.now?n.config.maxDate:n.now);try{n.currentYear=t.getFullYear(),n.currentMonth=t.getMonth()}catch(e){console.error(e.stack),console.warn("Invalid date supplied: "+t)}n.redraw()}function y(t){~t.target.className.indexOf("arrow")&&_(t,t.target.classList.contains("arrowUp")?1:-1)}function _(t,e,n){var i=n||t.target.parentNode.childNodes[0],r=V("increment");r.delta=e,i.dispatchEvent(r)}function x(t){var e=G("div","numInputWrapper"),n=G("input","numInput "+t),i=G("span","arrowUp"),r=G("span","arrowDown");return n.type="text",n.pattern="\\d*",e.appendChild(n),e.appendChild(i),e.appendChild(r),e}function b(t,e,i,r){var o=k(e,!0),a=G("span","flatpickr-day "+t,e.getDate());return a.dateObj=e,a.$i=r,a.setAttribute("aria-label",n.formatDate(e,n.config.ariaDateFormat)),0===X(e,n.now)&&(n.todayDateElem=a,a.classList.add("today")),o?(a.tabIndex=-1,j(e)&&(a.classList.add("selected"),n.selectedDateElem=a,"range"===n.config.mode&&(Y(a,"startRange",0===X(e,n.selectedDates[0])),Y(a,"endRange",0===X(e,n.selectedDates[1]))))):(a.classList.add("disabled"),n.selectedDates[0]&&e>n.minRangeDate&&e<n.selectedDates[0]?n.minRangeDate=e:n.selectedDates[0]&&e<n.maxRangeDate&&e>n.selectedDates[0]&&(n.maxRangeDate=e)),"range"===n.config.mode&&(function(t){return!("range"!==n.config.mode||n.selectedDates.length<2)&&X(t,n.selectedDates[0])>=0&&X(t,n.selectedDates[1])<=0}(e)&&!j(e)&&a.classList.add("inRange"),1===n.selectedDates.length&&(e<n.minRangeDate||e>n.maxRangeDate)&&a.classList.add("notAllowed")),n.config.weekNumbers&&"prevMonthDay"!==t&&i%7==1&&n.weekNumbers.insertAdjacentHTML("beforeend","<span class='disabled flatpickr-day'>"+n.config.getWeek(e)+"</span>"),N("DayCreate",a),a}function w(t,e){var i=t+e||0,r=void 0!==t?n.days.childNodes[i]:n.selectedDateElem||n.todayDateElem||n.days.childNodes[0],o=function(){(r=r||n.days.childNodes[i]).focus(),"range"===n.config.mode&&D(r)};if(void 0===r&&0!==e)return e>0?(n.changeMonth(1),i%=42):e<0&&(n.changeMonth(-1),i+=42),E(o);o()}function E(t){if(!0===n.config.animate)return n._animationLoop.push(t);t()}function S(t){var e=(new Date(n.currentYear,n.currentMonth,1).getDay()-n.l10n.firstDayOfWeek+7)%7,i="range"===n.config.mode;n.prevMonthDays=n.utils.getDaysinMonth((n.currentMonth-1+12)%12),n.selectedDateElem=void 0,n.todayDateElem=void 0;var r=n.utils.getDaysinMonth(),o=window.document.createDocumentFragment(),a=n.prevMonthDays+1-e,s=0;for(n.config.weekNumbers&&n.weekNumbers.firstChild&&(n.weekNumbers.textContent=""),i&&(n.minRangeDate=new Date(n.currentYear,n.currentMonth-1,a),n.maxRangeDate=new Date(n.currentYear,n.currentMonth+1,(42-e)%r));a<=n.prevMonthDays;a++,s++)o.appendChild(b("prevMonthDay",new Date(n.currentYear,n.currentMonth-1,a),a,s));for(a=1;a<=r;a++,s++)o.appendChild(b("",new Date(n.currentYear,n.currentMonth,a),a,s));for(var l=r+1;l<=42-e;l++,s++)o.appendChild(b("nextMonthDay",new Date(n.currentYear,n.currentMonth+1,l%r),l,s));i&&1===n.selectedDates.length&&o.childNodes[0]?(n._hidePrevMonthArrow=n._hidePrevMonthArrow||n.minRangeDate>o.childNodes[0].dateObj,n._hideNextMonthArrow=n._hideNextMonthArrow||n.maxRangeDate<new Date(n.currentYear,n.currentMonth+1,1)):U();var u=G("div","dayContainer");if(u.appendChild(o),n.config.animate&&void 0!==t)for(;n.daysContainer.childNodes.length>1;)n.daysContainer.removeChild(n.daysContainer.firstChild);else!(function(t){for(;t.firstChild;)t.removeChild(t.firstChild)})(n.daysContainer);return t>=0?n.daysContainer.appendChild(u):n.daysContainer.insertBefore(u,n.daysContainer.firstChild),n.days=n.daysContainer.firstChild,n.daysContainer}function C(){n.weekdayContainer||(n.weekdayContainer=G("div","flatpickr-weekdays"));var t=n.l10n.firstDayOfWeek,e=n.l10n.weekdays.shorthand.slice();return t>0&&t<e.length&&(e=[].concat(e.splice(t,e.length),e.splice(0,t))),n.weekdayContainer.innerHTML="\n\t\t<span class=flatpickr-weekday>\n\t\t\t"+e.join("</span><span class=flatpickr-weekday>")+"\n\t\t</span>\n\t\t",n.weekdayContainer}function T(t,e,i){var r=(e=void 0===e||e)?t:t-n.currentMonth,o=!n.config.animate||!1===i;if(!(r<0&&n._hidePrevMonthArrow||r>0&&n._hideNextMonthArrow)){if(n.currentMonth+=r,(n.currentMonth<0||n.currentMonth>11)&&(n.currentYear+=n.currentMonth>11?1:-1,n.currentMonth=(n.currentMonth+12)%12,N("YearChange")),S(o?void 0:r),o)return N("MonthChange"),U();var a=n.navigationCurrentMonth;if(r<0)for(;a.nextSibling&&/curr/.test(a.nextSibling.className);)n.monthNav.removeChild(a.nextSibling);else if(r>0)for(;a.previousSibling&&/curr/.test(a.previousSibling.className);)n.monthNav.removeChild(a.previousSibling);if(n.oldCurMonth=n.navigationCurrentMonth,n.navigationCurrentMonth=n.monthNav.insertBefore(n.oldCurMonth.cloneNode(!0),r>0?n.oldCurMonth.nextSibling:n.oldCurMonth),r>0?(n.daysContainer.firstChild.classList.add("slideLeft"),n.daysContainer.lastChild.classList.add("slideLeftNew"),n.oldCurMonth.classList.add("slideLeft"),n.navigationCurrentMonth.classList.add("slideLeftNew")):r<0&&(n.daysContainer.firstChild.classList.add("slideRightNew"),n.daysContainer.lastChild.classList.add("slideRight"),n.oldCurMonth.classList.add("slideRight"),n.navigationCurrentMonth.classList.add("slideRightNew")),n.currentMonthElement=n.navigationCurrentMonth.firstChild,n.currentYearElement=n.navigationCurrentMonth.lastChild.childNodes[0],U(),n.oldCurMonth.firstChild.textContent=n.utils.monthToStr(n.currentMonth-r),N("MonthChange"),document.activeElement&&document.activeElement.$i){var s=document.activeElement.$i;E((function(){w(s,0)}))}}}function A(t){return!(!n.config.appendTo||!n.config.appendTo.contains(t))||n.calendarContainer.contains(t)}function M(t){if(n.isOpen&&!n.config.inline){var e=A(t.target),i=t.target===n.input||t.target===n.altInput||n.element.contains(t.target)||t.path&&t.path.indexOf&&(~t.path.indexOf(n.input)||~t.path.indexOf(n.altInput));("blur"===t.type?i&&t.relatedTarget&&!A(t.relatedTarget):!i&&!e)&&(t.preventDefault(),n.close(),"range"===n.config.mode&&1===n.selectedDates.length&&(n.clear(!1),n.redraw()))}}function I(t){if(!(!t||n.currentYearElement.min&&t<n.currentYearElement.min||n.currentYearElement.max&&t>n.currentYearElement.max)){var e=parseInt(t,10),i=n.currentYear!==e;n.currentYear=e||n.currentYear,n.config.maxDate&&n.currentYear===n.config.maxDate.getFullYear()?n.currentMonth=Math.min(n.config.maxDate.getMonth(),n.currentMonth):n.config.minDate&&n.currentYear===n.config.minDate.getFullYear()&&(n.currentMonth=Math.max(n.config.minDate.getMonth(),n.currentMonth)),i&&(n.redraw(),N("YearChange"))}}function k(t,e){if(n.config.minDate&&X(t,n.config.minDate,void 0!==e?e:!n.minDateHasTime)<0||n.config.maxDate&&X(t,n.config.maxDate,void 0!==e?e:!n.maxDateHasTime)>0)return!1;if(!n.config.enable.length&&!n.config.disable.length)return!0;for(var i,o=n.parseDate(t,null,!0),a=n.config.enable.length>0,s=a?n.config.enable:n.config.disable,l=0;l<s.length;l++){if((i=s[l])instanceof Function&&i(o))return a;if(i instanceof Date&&i.getTime()===o.getTime())return a;if("string"==typeof i&&n.parseDate(i,null,!0).getTime()===o.getTime())return a;if("object"===(void 0===i?"undefined":r(i))&&i.from&&i.to&&o>=i.from&&o<=i.to)return a}return!a}function z(t){var e=t.target===n._input,i=A(t.target),r=n.config.allowInput,o=n.isOpen&&(!r||!e),a=n.config.inline&&e&&!r;if("Enter"===t.key&&r&&e)return n.setDate(n._input.value,!0,t.target===n.altInput?n.config.altFormat:n.config.dateFormat),t.target.blur();if(i||o||a){var u=n.timeContainer&&n.timeContainer.contains(t.target);switch(t.key){case"Enter":u?q():B(t);break;case"Escape":t.preventDefault(),n.close();break;case"ArrowLeft":case"ArrowRight":if(!u)if(t.preventDefault(),n.daysContainer){var c="ArrowRight"===t.key?1:-1;t.ctrlKey?T(c,!0):w(t.target.$i,c)}else n.config.enableTime&&!u&&n.hourElement.focus();break;case"ArrowUp":case"ArrowDown":t.preventDefault();var h="ArrowDown"===t.key?1:-1;n.daysContainer?t.ctrlKey?(I(n.currentYear-h),w(t.target.$i,0)):u||w(t.target.$i,7*h):n.config.enableTime&&(u||n.hourElement.focus(),s(t));break;case"Tab":t.target===n.hourElement?(t.preventDefault(),n.minuteElement.select()):t.target===n.minuteElement&&(n.secondElement||n.amPM)?(t.preventDefault(),(n.secondElement||n.amPM).focus()):t.target===n.secondElement&&(t.preventDefault(),n.amPM.focus());break;case"a":t.target===n.amPM&&(n.amPM.textContent="AM",l(),q());break;case"p":t.target===n.amPM&&(n.amPM.textContent="PM",l(),q())}N("KeyDown",t)}}function D(t){if(1===n.selectedDates.length&&t.classList.contains("flatpickr-day")){for(var e=t.dateObj,i=n.parseDate(n.selectedDates[0],null,!0),r=Math.min(e.getTime(),n.selectedDates[0].getTime()),o=Math.max(e.getTime(),n.selectedDates[0].getTime()),a=!1,s=r;s<o;s+=n.utils.duration.DAY)if(!k(new Date(s))){a=!0;break}for(var l=function(s,l){var u=s<n.minRangeDate.getTime()||s>n.maxRangeDate.getTime(),c=n.days.childNodes[l];if(u)return n.days.childNodes[l].classList.add("notAllowed"),["inRange","startRange","endRange"].forEach((function(t){c.classList.remove(t)})),"continue";if(a&&!u)return"continue";["startRange","inRange","endRange","notAllowed"].forEach((function(t){c.classList.remove(t)}));var h=Math.max(n.minRangeDate.getTime(),r),p=Math.min(n.maxRangeDate.getTime(),o);t.classList.add(e<n.selectedDates[0]?"startRange":"endRange"),i<e&&s===i.getTime()?c.classList.add("startRange"):i>e&&s===i.getTime()&&c.classList.add("endRange"),s>=h&&s<=p&&c.classList.add("inRange")},u=n.days.childNodes[0].dateObj.getTime(),c=0;c<42;c++,u+=n.utils.duration.DAY)l(u,c)}}function L(){!n.isOpen||n.config.static||n.config.inline||O()}function P(t){return function(e){var i=n.config["_"+t+"Date"]=n.parseDate(e),r=n.config["_"+("min"===t?"max":"min")+"Date"],o=e&&i instanceof Date;o&&(n[t+"DateHasTime"]=i.getHours()||i.getMinutes()||i.getSeconds()),n.selectedDates&&(n.selectedDates=n.selectedDates.filter((function(t){return k(t)})),n.selectedDates.length||"min"!==t||u(i),q()),n.daysContainer&&(R(),o?n.currentYearElement[t]=i.getFullYear():n.currentYearElement.removeAttribute(t),n.currentYearElement.disabled=r&&i&&r.getFullYear()===i.getFullYear())}}function O(){if(void 0!==n.calendarContainer){var t=n.calendarContainer.offsetHeight,e=n.calendarContainer.offsetWidth,i=n.config.position,r=n._positionElement.getBoundingClientRect(),o=window.innerHeight-r.bottom,a="above"===i||"below"!==i&&o<t&&r.top>t,s=window.pageYOffset+r.top+(a?-t-2:n._positionElement.offsetHeight+2);if(Y(n.calendarContainer,"arrowTop",!a),Y(n.calendarContainer,"arrowBottom",a),!n.config.inline){var l=window.pageXOffset+r.left,u=window.document.body.offsetWidth-r.right,c=l+e>window.document.body.offsetWidth;Y(n.calendarContainer,"rightMost",c),n.config.static||(n.calendarContainer.style.top=s+"px",c?(n.calendarContainer.style.left="auto",n.calendarContainer.style.right=u+"px"):(n.calendarContainer.style.left=l+"px",n.calendarContainer.style.right="auto"))}}}function R(){n.config.noCalendar||n.isMobile||(C(),U(),S())}function B(t){if(t.preventDefault(),t.stopPropagation(),t.target.classList.contains("flatpickr-day")&&!t.target.classList.contains("disabled")&&!t.target.classList.contains("notAllowed")){var e=n.latestSelectedDateObj=new Date(t.target.dateObj.getTime()),i=e.getMonth()!==n.currentMonth&&"range"!==n.config.mode;if(n.selectedDateElem=t.target,"single"===n.config.mode)n.selectedDates=[e];else if("multiple"===n.config.mode){var r=j(e);r?n.selectedDates.splice(r,1):n.selectedDates.push(e)}else"range"===n.config.mode&&(2===n.selectedDates.length&&n.clear(),n.selectedDates.push(e),0!==X(e,n.selectedDates[0],!0)&&n.selectedDates.sort((function(t,e){return t.getTime()-e.getTime()})));if(l(),i){var o=n.currentYear!==e.getFullYear();n.currentYear=e.getFullYear(),n.currentMonth=e.getMonth(),o&&N("YearChange"),N("MonthChange")}if(S(),n.minDateHasTime&&n.config.enableTime&&0===X(e,n.config.minDate)&&u(n.config.minDate),q(),n.config.enableTime&&setTimeout((function(){return n.showTimeInput=!0}),50),"range"===n.config.mode&&(1===n.selectedDates.length?(D(t.target),n._hidePrevMonthArrow=n._hidePrevMonthArrow||n.minRangeDate>n.days.childNodes[0].dateObj,n._hideNextMonthArrow=n._hideNextMonthArrow||n.maxRangeDate<new Date(n.currentYear,n.currentMonth+1,1)):U()),N("Change"),i?E((function(){return n.selectedDateElem.focus()})):w(t.target.$i,0),n.config.enableTime&&setTimeout((function(){return n.hourElement.select()}),451),n.config.closeOnSelect){var a="single"===n.config.mode&&!n.config.enableTime,s="range"===n.config.mode&&2===n.selectedDates.length&&!n.config.enableTime;(a||s)&&n.close()}}}function F(t,e){if(t instanceof Array)n.selectedDates=t.map((function(t){return n.parseDate(t,e)}));else if(t instanceof Date||!isNaN(t))n.selectedDates=[n.parseDate(t,e)];else if(t&&t.substring)switch(n.config.mode){case"single":n.selectedDates=[n.parseDate(t,e)];break;case"multiple":n.selectedDates=t.split("; ").map((function(t){return n.parseDate(t,e)}));break;case"range":n.selectedDates=t.split(n.l10n.rangeSeparator).map((function(t){return n.parseDate(t,e)}))}n.selectedDates=n.selectedDates.filter((function(t){return t instanceof Date&&k(t,!1)})),n.selectedDates.sort((function(t,e){return t.getTime()-e.getTime()}))}function N(t,e){var i=n.config["on"+t];if(void 0!==i&&i.length>0)for(var r=0;i[r]&&r<i.length;r++)i[r](n.selectedDates,n.input.value,n,e);"Change"===t&&(n.input.dispatchEvent(V("change")),n.input.dispatchEvent(V("input")))}function V(t){return n._supportsEvents?new Event(t,{bubbles:!0}):(n._[t+"Event"]=document.createEvent("Event"),n._[t+"Event"].initEvent(t,!0,!0),n._[t+"Event"])}function j(t){for(var e=0;e<n.selectedDates.length;e++)if(0===X(n.selectedDates[e],t))return""+e;return!1}function U(){n.config.noCalendar||n.isMobile||!n.monthNav||(n.currentMonthElement.textContent=n.utils.monthToStr(n.currentMonth)+" ",n.currentYearElement.value=n.currentYear,n._hidePrevMonthArrow=n.config.minDate&&(n.currentYear===n.config.minDate.getFullYear()?n.currentMonth<=n.config.minDate.getMonth():n.currentYear<n.config.minDate.getFullYear()),n._hideNextMonthArrow=n.config.maxDate&&(n.currentYear===n.config.maxDate.getFullYear()?n.currentMonth+1>n.config.maxDate.getMonth():n.currentYear>n.config.maxDate.getFullYear()))}function q(t){if(!n.selectedDates.length)return n.clear(t);n.isMobile&&(n.mobileInput.value=n.selectedDates.length?n.formatDate(n.latestSelectedDateObj,n.mobileFormatStr):"");var e="range"!==n.config.mode?"; ":n.l10n.rangeSeparator;n.input.value=n.selectedDates.map((function(t){return n.formatDate(t,n.config.dateFormat)})).join(e),n.config.altInput&&(n.altInput.value=n.selectedDates.map((function(t){return n.formatDate(t,n.config.altFormat)})).join(e)),N("ValueUpdate")}function $(t){t.preventDefault();var e=n.currentYearElement.parentNode.contains(t.target);if(t.target===n.currentMonthElement||e){var i=(function(t){return Math.max(-1,Math.min(1,t.wheelDelta||-t.deltaY))})(t);e?(I(n.currentYear+i),t.target.value=n.currentYear):n.changeMonth(i,!0,!1)}}function Z(t){var e=n.prevMonthNav.contains(t.target),i=n.nextMonthNav.contains(t.target);e||i?T(e?-1:1):t.target===n.currentYearElement?(t.preventDefault(),n.currentYearElement.select()):"arrowUp"===t.target.className?n.changeYear(n.currentYear+1):"arrowDown"===t.target.className&&n.changeYear(n.currentYear-1)}function G(t,e,n){var i=window.document.createElement(t);return e=e||"",n=n||"",i.className=e,void 0!==n&&(i.textContent=n),i}function W(t){return t instanceof Array?t:[t]}function Y(t,e,n){if(n)return t.classList.add(e);t.classList.remove(e)}function H(t,e,n){var i=void 0;return function(){var r=this,o=arguments;clearTimeout(i),i=setTimeout((function(){i=null,n||t.apply(r,o)}),e),n&&!i&&t.apply(r,o)}}function X(t,e,n){return t instanceof Date&&e instanceof Date&&(!1!==n?new Date(t.getTime()).setHours(0,0,0,0)-new Date(e.getTime()).setHours(0,0,0,0):t.getTime()-e.getTime())}return n._={},n._.afterDayAnim=E,n.changeMonth=T,n.changeYear=I,n.clear=function(t){n.input.value="",n.altInput&&(n.altInput.value="");n.mobileInput&&(n.mobileInput.value="");n.selectedDates=[],n.latestSelectedDateObj=void 0,n.showTimeInput=!1,n.redraw(),!1!==t&&N("Change")},n.close=function(){n.isOpen=!1,n.isMobile||(n.calendarContainer.classList.remove("open"),n._input.classList.remove("active"));N("Close")},n._createElement=G,n.destroy=function(){for(var t=n._handlers.length;t--;){var e=n._handlers[t];e.element.removeEventListener(e.event,e.handler)}n._handlers=[],n.mobileInput?(n.mobileInput.parentNode&&n.mobileInput.parentNode.removeChild(n.mobileInput),n.mobileInput=null):n.calendarContainer&&n.calendarContainer.parentNode&&n.calendarContainer.parentNode.removeChild(n.calendarContainer);n.altInput&&(n.input.type="text",n.altInput.parentNode&&n.altInput.parentNode.removeChild(n.altInput),delete n.altInput);n.input&&(n.input.type=n.input._type,n.input.classList.remove("flatpickr-input"),n.input.removeAttribute("readonly"),n.input.value="");["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach((function(t){return delete n[t]}))},n.isEnabled=k,n.jumpToDate=g,n.open=function(t){if(n.isMobile)return t&&(t.preventDefault(),t.target.blur()),setTimeout((function(){n.mobileInput.click()}),0),void N("Open");if(n.isOpen||n._input.disabled||n.config.inline)return;n.isOpen=!0,n.calendarContainer.classList.add("open"),O(),n._input.classList.add("active"),N("Open")},n.redraw=R,n.set=function(t,e){n.config[t]=e,n.redraw(),g()},n.setDate=function(t,e,i){if(!t)return n.clear(e);F(t,i),n.showTimeInput=n.selectedDates.length>0,n.latestSelectedDateObj=n.selectedDates[0],n.redraw(),g(),u(),q(e),e&&N("Change")},n.toggle=function(){if(n.isOpen)return n.close();n.open()},n.element=n.input=t,n.instanceConfig=e||{},n.parseDate=o.prototype.parseDate.bind(n),n.formatDate=o.prototype.formatDate.bind(n),["D","F","J","M","W","l"].forEach((function(t){n.formats[t]=o.prototype.formats[t].bind(n)})),n.revFormat.F=o.prototype.revFormat.F.bind(n),n.revFormat.M=o.prototype.revFormat.M.bind(n),(function(){var t=["utc","wrap","weekNumbers","allowInput","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],e=["onChange","onClose","onDayCreate","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange"];n.config=Object.create(o.defaultConfig);var r=i({},n.instanceConfig,JSON.parse(JSON.stringify(n.element.dataset||{})));n.config.parseDate=r.parseDate,n.config.formatDate=r.formatDate,i(n.config,r),!r.dateFormat&&r.enableTime&&(n.config.dateFormat=n.config.noCalendar?"H:i"+(n.config.enableSeconds?":S":""):o.defaultConfig.dateFormat+" H:i"+(n.config.enableSeconds?":S":"")),r.altInput&&r.enableTime&&!r.altFormat&&(n.config.altFormat=n.config.noCalendar?"h:i"+(n.config.enableSeconds?":S K":" K"):o.defaultConfig.altFormat+" h:i"+(n.config.enableSeconds?":S":"")+" K"),Object.defineProperty(n.config,"minDate",{get:function(){return this._minDate},set:P("min")}),Object.defineProperty(n.config,"maxDate",{get:function(){return this._maxDate},set:P("max")}),n.config.minDate=r.minDate,n.config.maxDate=r.maxDate;for(var s=0;s<t.length;s++)n.config[t[s]]=!0===n.config[t[s]]||"true"===n.config[t[s]];for(var l=e.length;l--;)void 0!==n.config[e[l]]&&(n.config[e[l]]=W(n.config[e[l]]||[]).map(a));for(var u=0;u<n.config.plugins.length;u++){var c=n.config.plugins[u](n)||{};for(var h in c)n.config[h]instanceof Array||~e.indexOf(h)?n.config[h]=W(c[h]).map(a).concat(n.config[h]):void 0===r[h]&&(n.config[h]=c[h])}N("ParseConfig")})(),"object"!==r(n.config.locale)&&void 0===o.l10ns[n.config.locale]&&console.warn("flatpickr: invalid locale "+n.config.locale),n.l10n=i(Object.create(o.l10ns.default),"object"===r(n.config.locale)?n.config.locale:"default"!==n.config.locale&&o.l10ns[n.config.locale]||{}),(function(){if(n.input=n.config.wrap?n.element.querySelector("[data-input]"):n.element,!n.input)return console.warn("Error: invalid input element specified",n.input);n.input._type=n.input.type,n.input.type="text",n.input.classList.add("flatpickr-input"),n._input=n.input,n.config.altInput&&(n.altInput=G(n.input.nodeName,n.input.className+" "+n.config.altInputClass),n._input=n.altInput,n.altInput.placeholder=n.input.placeholder,n.altInput.disabled=n.input.disabled,n.altInput.type="text",n.input.type="hidden",!n.config.static&&n.input.parentNode&&n.input.parentNode.insertBefore(n.altInput,n.input.nextSibling)),n.config.allowInput||n._input.setAttribute("readonly","readonly"),n._positionElement=n.config.positionElement||n._input})(),(function(){function t(t){for(var e=t.length;e--;)"string"==typeof t[e]||+t[e]?t[e]=n.parseDate(t[e],null,!0):t[e]&&t[e].from&&t[e].to&&(t[e].from=n.parseDate(t[e].from),t[e].to=n.parseDate(t[e].to));return t.filter((function(t){return t}))}n.selectedDates=[],n.now=new Date,n.config.disable.length&&(n.config.disable=t(n.config.disable)),n.config.enable.length&&(n.config.enable=t(n.config.enable));var e=n.config.defaultDate||n.input.value;e&&F(e,n.config.dateFormat);var i=n.selectedDates.length?n.selectedDates[0]:n.config.minDate&&n.config.minDate.getTime()>n.now?n.config.minDate:n.config.maxDate&&n.config.maxDate.getTime()<n.now?n.config.maxDate:n.now;n.currentYear=i.getFullYear(),n.currentMonth=i.getMonth(),n.selectedDates.length&&(n.latestSelectedDateObj=n.selectedDates[0]),n.minDateHasTime=n.config.minDate&&(n.config.minDate.getHours()||n.config.minDate.getMinutes()||n.config.minDate.getSeconds()),n.maxDateHasTime=n.config.maxDate&&(n.config.maxDate.getHours()||n.config.maxDate.getMinutes()||n.config.maxDate.getSeconds()),Object.defineProperty(n,"latestSelectedDateObj",{get:function(){return n._selectedDateObj||n.selectedDates[n.selectedDates.length-1]},set:function(t){n._selectedDateObj=t}}),n.isMobile||Object.defineProperty(n,"showTimeInput",{get:function(){return n._showTimeInput},set:function(t){n._showTimeInput=t,n.calendarContainer&&Y(n.calendarContainer,"showTimeInput",t),O()}})})(),n.utils={duration:{DAY:864e5},getDaysinMonth:function(t,e){return t=void 0===t?n.currentMonth:t,e=void 0===e?n.currentYear:e,1===t&&(e%4==0&&e%100!=0||e%400==0)?29:n.l10n.daysInMonth[t]},monthToStr:function(t,e){return e=void 0===e?n.config.shorthandCurrentMonth:e,n.l10n.months[(e?"short":"long")+"hand"][t]}},n.isOpen=!1,n.isMobile=!n.config.disableMobile&&!n.config.inline&&"single"===n.config.mode&&!n.config.disable.length&&!n.config.enable.length&&!n.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),n.isMobile||(function(){var t=window.document.createDocumentFragment();n.calendarContainer=G("div","flatpickr-calendar"),n.calendarContainer.tabIndex=-1,n.config.noCalendar||(t.appendChild(function(){var t=window.document.createDocumentFragment();n.monthNav=G("div","flatpickr-month"),n.prevMonthNav=G("span","flatpickr-prev-month"),n.prevMonthNav.innerHTML=n.config.prevArrow,n.currentMonthElement=G("span","cur-month"),n.currentMonthElement.title=n.l10n.scrollTitle;var e=x("cur-year");return n.currentYearElement=e.childNodes[0],n.currentYearElement.title=n.l10n.scrollTitle,n.config.minDate&&(n.currentYearElement.min=n.config.minDate.getFullYear()),n.config.maxDate&&(n.currentYearElement.max=n.config.maxDate.getFullYear(),n.currentYearElement.disabled=n.config.minDate&&n.config.minDate.getFullYear()===n.config.maxDate.getFullYear()),n.nextMonthNav=G("span","flatpickr-next-month"),n.nextMonthNav.innerHTML=n.config.nextArrow,n.navigationCurrentMonth=G("span","flatpickr-current-month"),n.navigationCurrentMonth.appendChild(n.currentMonthElement),n.navigationCurrentMonth.appendChild(e),t.appendChild(n.prevMonthNav),t.appendChild(n.navigationCurrentMonth),t.appendChild(n.nextMonthNav),n.monthNav.appendChild(t),Object.defineProperty(n,"_hidePrevMonthArrow",{get:function(){return this.__hidePrevMonthArrow},set:function(t){this.__hidePrevMonthArrow!==t&&(n.prevMonthNav.style.display=t?"none":"block"),this.__hidePrevMonthArrow=t}}),Object.defineProperty(n,"_hideNextMonthArrow",{get:function(){return this.__hideNextMonthArrow},set:function(t){this.__hideNextMonthArrow!==t&&(n.nextMonthNav.style.display=t?"none":"block"),this.__hideNextMonthArrow=t}}),U(),n.monthNav}()),n.innerContainer=G("div","flatpickr-innerContainer"),n.config.weekNumbers&&n.innerContainer.appendChild((n.calendarContainer.classList.add("hasWeeks"),n.weekWrapper=G("div","flatpickr-weekwrapper"),n.weekWrapper.appendChild(G("span","flatpickr-weekday",n.l10n.weekAbbreviation)),n.weekNumbers=G("div","flatpickr-weeks"),n.weekWrapper.appendChild(n.weekNumbers),n.weekWrapper)),n.rContainer=G("div","flatpickr-rContainer"),n.rContainer.appendChild(C()),n.daysContainer||(n.daysContainer=G("div","flatpickr-days"),n.daysContainer.tabIndex=-1),S(),n.rContainer.appendChild(n.daysContainer),n.innerContainer.appendChild(n.rContainer),t.appendChild(n.innerContainer)),n.config.enableTime&&t.appendChild(function(){n.calendarContainer.classList.add("hasTime"),n.config.noCalendar&&n.calendarContainer.classList.add("noCalendar"),n.timeContainer=G("div","flatpickr-time"),n.timeContainer.tabIndex=-1;var t=G("span","flatpickr-time-separator",":"),e=x("flatpickr-hour");n.hourElement=e.childNodes[0];var i=x("flatpickr-minute");if(n.minuteElement=i.childNodes[0],n.hourElement.tabIndex=n.minuteElement.tabIndex=-1,n.hourElement.value=n.pad(n.latestSelectedDateObj?n.latestSelectedDateObj.getHours():n.config.defaultHour),n.minuteElement.value=n.pad(n.latestSelectedDateObj?n.latestSelectedDateObj.getMinutes():n.config.defaultMinute),n.hourElement.step=n.config.hourIncrement,n.minuteElement.step=n.config.minuteIncrement,n.hourElement.min=n.config.time_24hr?0:1,n.hourElement.max=n.config.time_24hr?23:12,n.minuteElement.min=0,n.minuteElement.max=59,n.hourElement.title=n.minuteElement.title=n.l10n.scrollTitle,n.timeContainer.appendChild(e),n.timeContainer.appendChild(t),n.timeContainer.appendChild(i),n.config.time_24hr&&n.timeContainer.classList.add("time24hr"),n.config.enableSeconds){n.timeContainer.classList.add("hasSeconds");var r=x("flatpickr-second");n.secondElement=r.childNodes[0],n.secondElement.value=n.latestSelectedDateObj?n.pad(n.latestSelectedDateObj.getSeconds()):"00",n.secondElement.step=n.minuteElement.step,n.secondElement.min=n.minuteElement.min,n.secondElement.max=n.minuteElement.max,n.timeContainer.appendChild(G("span","flatpickr-time-separator",":")),n.timeContainer.appendChild(r)}return n.config.time_24hr||(n.amPM=G("span","flatpickr-am-pm",["AM","PM"][n.hourElement.value>11|0]),n.amPM.title=n.l10n.toggleTitle,n.amPM.tabIndex=-1,n.timeContainer.appendChild(n.amPM)),n.timeContainer}()),Y(n.calendarContainer,"rangeMode","range"===n.config.mode),Y(n.calendarContainer,"animate",n.config.animate),n.calendarContainer.appendChild(t);var e=n.config.appendTo&&n.config.appendTo.nodeType;if(n.config.inline||n.config.static){if(n.calendarContainer.classList.add(n.config.inline?"inline":"static"),n.config.inline&&!e)return n.element.parentNode.insertBefore(n.calendarContainer,n._input.nextSibling);if(n.config.static){var i=G("div","flatpickr-wrapper");return n.element.parentNode.insertBefore(i,n.element),i.appendChild(n.element),n.altInput&&i.appendChild(n.altInput),void i.appendChild(n.calendarContainer)}}(e?n.config.appendTo:window.document.body).appendChild(n.calendarContainer)})(),(function(){if(n._handlers=[],n._animationLoop=[],n.config.wrap&&["open","close","toggle","clear"].forEach((function(t){Array.prototype.forEach.call(n.element.querySelectorAll("[data-"+t+"]"),(function(e){return p(e,"mousedown",f(n[t]))}))})),n.isMobile)return (function(){var t=n.config.enableTime?n.config.noCalendar?"time":"datetime-local":"date";n.mobileInput=G("input",n.input.className+" flatpickr-mobile"),n.mobileInput.step="any",n.mobileInput.tabIndex=1,n.mobileInput.type=t,n.mobileInput.disabled=n.input.disabled,n.mobileInput.placeholder=n.input.placeholder,n.mobileFormatStr="datetime-local"===t?"Y-m-d\\TH:i:S":"date"===t?"Y-m-d":"H:i:S",n.selectedDates.length&&(n.mobileInput.defaultValue=n.mobileInput.value=n.formatDate(n.selectedDates[0],n.mobileFormatStr)),n.config.minDate&&(n.mobileInput.min=n.formatDate(n.config.minDate,"Y-m-d")),n.config.maxDate&&(n.mobileInput.max=n.formatDate(n.config.maxDate,"Y-m-d")),n.input.type="hidden",n.config.altInput&&(n.altInput.type="hidden");try{n.input.parentNode.insertBefore(n.mobileInput,n.input.nextSibling)}catch(t){}n.mobileInput.addEventListener("change",(function(t){n.setDate(t.target.value,!1,n.mobileFormatStr),N("Change"),N("Close")}))})();n.debouncedResize=H(L,50),n.triggerChange=function(){N("Change")},n.debouncedChange=H(n.triggerChange,300),"range"===n.config.mode&&n.daysContainer&&p(n.daysContainer,"mouseover",(function(t){return D(t.target)})),p(window.document.body,"keydown",z),n.config.static||p(n._input,"keydown",z),n.config.inline||n.config.static||p(window,"resize",n.debouncedResize),void 0!==window.ontouchstart&&p(window.document,"touchstart",M),p(window.document,"mousedown",f(M)),p(n._input,"blur",M),!0===n.config.clickOpens&&p(n._input,"focus",n.open),n.config.noCalendar||(n.monthNav.addEventListener("wheel",(function(t){return t.preventDefault()})),p(n.monthNav,"wheel",H($,10)),p(n.monthNav,"mousedown",f(Z)),p(n.monthNav,["keyup","increment"],h),p(n.daysContainer,"mousedown",f(B)),n.config.animate&&(p(n.daysContainer,["webkitAnimationEnd","animationend"],m),p(n.monthNav,["webkitAnimationEnd","animationend"],v))),n.config.enableTime&&(p(n.timeContainer,["wheel","input","increment"],s),p(n.timeContainer,"mousedown",f(y)),p(n.timeContainer,["wheel","increment"],n.debouncedChange),p(n.timeContainer,"input",n.triggerChange),p([n.hourElement,n.minuteElement],"focus",(function(t){return t.target.select()})),void 0!==n.secondElement&&p(n.secondElement,"focus",(function(){return n.secondElement.select()})),void 0!==n.amPM&&p(n.amPM,"mousedown",f((function(t){s(t),n.triggerChange(t)}))))})(),(n.selectedDates.length||n.config.noCalendar)&&(n.config.enableTime&&u(n.config.noCalendar?n.latestSelectedDateObj||n.config.minDate:null),q()),n.config.weekNumbers&&(n.calendarContainer.style.width=n.daysContainer.offsetWidth+n.weekWrapper.offsetWidth+"px"),n.showTimeInput=n.selectedDates.length>0||n.config.noCalendar,n.isMobile||O(),N("Ready"),n}function a(t,e){for(var n=Array.prototype.slice.call(t),i=[],r=0;r<n.length;r++)try{n[r]._flatpickr=new o(n[r],e||{}),i.push(n[r]._flatpickr)}catch(t){console.warn(t,t.stack)}return 1===i.length?i[0]:i}o.defaultConfig={mode:"single",position:"auto",animate:-1===window.navigator.userAgent.indexOf("MSIE"),utc:!1,wrap:!1,weekNumbers:!1,allowInput:!1,clickOpens:!0,closeOnSelect:!0,time_24hr:!1,enableTime:!1,noCalendar:!1,dateFormat:"Y-m-d",ariaDateFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",altFormat:"F j, Y",defaultDate:null,minDate:null,maxDate:null,parseDate:null,formatDate:null,getWeek:function(t){var e=new Date(t.getTime()),n=new Date(e.getFullYear(),0,1);return Math.ceil(((e-n)/864e5+n.getDay()+1)/7)},enable:[],disable:[],shorthandCurrentMonth:!1,inline:!1,static:!1,appendTo:null,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",enableSeconds:!1,hourIncrement:1,minuteIncrement:5,defaultHour:12,defaultMinute:0,disableMobile:!1,locale:"default",plugins:[],onClose:void 0,onChange:void 0,onDayCreate:void 0,onMonthChange:void 0,onOpen:void 0,onParseConfig:void 0,onReady:void 0,onValueUpdate:void 0,onYearChange:void 0,onKeyDown:void 0},o.l10ns={en:{weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(t){var e=t%100;if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle"}},o.l10ns.default=Object.create(o.l10ns.en),o.localize=function(t){return i(o.l10ns.default,t||{})},o.setDefaults=function(t){return i(o.defaultConfig,t||{})},o.prototype={formats:{Z:function(t){return t.toISOString()},D:function(t){return this.l10n.weekdays.shorthand[this.formats.w(t)]},F:function(t){return this.utils.monthToStr(this.formats.n(t)-1,!1)},G:function(t){return o.prototype.pad(o.prototype.formats.h(t))},H:function(t){return o.prototype.pad(t.getHours())},J:function(t){return t.getDate()+this.l10n.ordinal(t.getDate())},K:function(t){return t.getHours()>11?"PM":"AM"},M:function(t){return this.utils.monthToStr(t.getMonth(),!0)},S:function(t){return o.prototype.pad(t.getSeconds())},U:function(t){return t.getTime()/1e3},W:function(t){return this.config.getWeek(t)},Y:function(t){return t.getFullYear()},d:function(t){return o.prototype.pad(t.getDate())},h:function(t){return t.getHours()%12?t.getHours()%12:12},i:function(t){return o.prototype.pad(t.getMinutes())},j:function(t){return t.getDate()},l:function(t){return this.l10n.weekdays.longhand[t.getDay()]},m:function(t){return o.prototype.pad(t.getMonth()+1)},n:function(t){return t.getMonth()+1},s:function(t){return t.getSeconds()},w:function(t){return t.getDay()},y:function(t){return String(t.getFullYear()).substring(2)}},formatDate:function(t,e){var n=this;return void 0!==this.config&&void 0!==this.config.formatDate?this.config.formatDate(t,e):e.split("").map((function(e,i,r){return n.formats[e]&&"\\"!==r[i-1]?n.formats[e](t):"\\"!==e?e:""})).join("")},revFormat:{D:function(){},F:function(t,e){t.setMonth(this.l10n.months.longhand.indexOf(e))},G:function(t,e){t.setHours(parseFloat(e))},H:function(t,e){t.setHours(parseFloat(e))},J:function(t,e){t.setDate(parseFloat(e))},K:function(t,e){var n=t.getHours();12!==n&&t.setHours(n%12+12*/pm/i.test(e))},M:function(t,e){t.setMonth(this.l10n.months.shorthand.indexOf(e))},S:function(t,e){t.setSeconds(e)},U:function(t,e){return new Date(1e3*parseFloat(e))},W:function(t,e){return e=parseInt(e),new Date(t.getFullYear(),0,2+7*(e-1),0,0,0,0,0)},Y:function(t,e){t.setFullYear(e)},Z:function(t,e){return new Date(e)},d:function(t,e){t.setDate(parseFloat(e))},h:function(t,e){t.setHours(parseFloat(e))},i:function(t,e){t.setMinutes(parseFloat(e))},j:function(t,e){t.setDate(parseFloat(e))},l:function(){},m:function(t,e){t.setMonth(parseFloat(e)-1)},n:function(t,e){t.setMonth(parseFloat(e)-1)},s:function(t,e){t.setSeconds(parseFloat(e))},w:function(){},y:function(t,e){t.setFullYear(2e3+parseFloat(e))}},tokenRegex:{D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"(\\w+)",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},pad:function(t){return("0"+t).slice(-2)},parseDate:function(t,e,n){if(!t)return null;var i=t;if(t instanceof Date)(t=new Date(t.getTime())).fp_isUTC=i.fp_isUTC;else if(void 0!==t.toFixed)t=new Date(t);else{var r=e||(this.config||o.defaultConfig).dateFormat;if("today"===(t=String(t).trim()))t=new Date,n=!0;else if(/Z$/.test(t)||/GMT$/.test(t))t=new Date(t);else if(this.config&&this.config.parseDate)t=this.config.parseDate(t,r);else{for(var a=this.config&&this.config.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0),s=void 0,l=0,u=0,c="";l<r.length;l++){var h=r[l],p="\\"===h,f="\\"===r[l-1]||p;if(this.tokenRegex[h]&&!f){c+=this.tokenRegex[h];var d=new RegExp(c).exec(t);d&&(s=!0)&&(a=this.revFormat[h](a,d[++u])||a)}else p||(c+=".")}t=s?a:null}}return t instanceof Date?(this.config&&this.config.utc&&!t.fp_isUTC&&(t=t.fp_toUTC()),!0===n&&t.setHours(0,0,0,0),t):(console.warn("flatpickr: invalid date "+i),console.info(this.element),null)}},"undefined"!=typeof HTMLElement&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(t){return a(this,t)},HTMLElement.prototype.flatpickr=function(t){return a([this],t)}),"undefined"!=typeof jQuery&&(jQuery.fn.flatpickr=function(t){return a(this,t)}),Date.prototype.fp_incr=function(t){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+parseInt(t,10))},Date.prototype.fp_isUTC=!1,Date.prototype.fp_toUTC=function(){var t=new Date(this.getUTCFullYear(),this.getUTCMonth(),this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds());return t.fp_isUTC=!0,t},t.exports=o},16:function(t,e,n){var i,r;
/**
 * mainloop.js 1.0.3-20170529
 *
 * @author Isaac Sukin (http://www.isaacsukin.com/)
 * @license MIT
 */!(function(o){function a(t){if(s=w(a),!(t<c+g)){for(u+=t-c,c=t,C(t,u),t>d+f&&(h=p*m*1e3/(t-d)+(1-p)*h,d=t,m=0),m++,v=0;u>=l;)if(T(l),u-=l,++v>=240){x=!0;break}A(u/l),M(h,x),x=!1}}var s,l=1e3/60,u=0,c=0,h=60,p=.9,f=1e3,d=0,m=0,v=0,g=0,y=!1,_=!1,x=!1,b="object"==typeof window?window:o,w=b.requestAnimationFrame||(function(){var t,e,n=Date.now();return function(i){return t=Date.now(),e=Math.max(0,l-(t-n)),n=t+e,setTimeout((function(){i(t+e)}),e)}})(),E=b.cancelAnimationFrame||clearTimeout,S=function(){},C=S,T=S,A=S,M=S;o.MainLoop={getSimulationTimestep:function(){return l},setSimulationTimestep:function(t){return l=t,this},getFPS:function(){return h},getMaxAllowedFPS:function(){return 1e3/g},setMaxAllowedFPS:function(t){return void 0===t&&(t=1/0),0===t?this.stop():g=1e3/t,this},resetFrameDelta:function(){var t=u;return u=0,t},setBegin:function(t){return C=t||C,this},setUpdate:function(t){return T=t||T,this},setDraw:function(t){return A=t||A,this},setEnd:function(t){return M=t||M,this},start:function(){return _||(_=!0,s=w((function(t){A(1),y=!0,c=t,d=t,m=0,s=w(a)}))),this},stop:function(){return y=!1,_=!1,E(s),this},isRunning:function(){return y}},i=o.MainLoop,void 0===(r="function"==typeof i?i.call(e,n,e,t):i)||(t.exports=r)})(this)},38:function(t,e,n){
/* flatpickr v4.5.0, @license MIT */
!(function(t){"use strict";var e="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],longhand:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"]},months:{shorthand:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],longhand:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"]},firstDayOfWeek:1,ordinal:function(){return"°"},rangeSeparator:" al ",weekAbbreviation:"Se",scrollTitle:"Scrolla per aumentare",toggleTitle:"Clicca per cambiare"};e.l10ns.it=n;var i=e.l10ns;t.Italian=n,t.default=i,Object.defineProperty(t,"__esModule",{value:!0})})(e)},57:function(t,e,n){(function(){var e;e=function(t){"use strict";var e={defaultSelected:!0,width:"auto",disabled:!1,searchable:!0,clearable:!1,sortSelected:!1,allowDeselect:!1,closeOnScroll:!1,nativeDropdown:!1,placeholder:"Select an option...",taggable:!1,tagPlaceholder:"Enter a tag..."},n=function(){};n.prototype={on:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},off:function(t,e){this._events=this._events||{},t in this._events!=0&&this._events[t].splice(this._events[t].indexOf(e),1)},emit:function(t){if(this._events=this._events||{},t in this._events!=0)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},n.mixin=function(t){for(var e=["on","off","emit"],i=0;i<e.length;i++)"function"==typeof t?t.prototype[e[i]]=n.prototype[e[i]]:t[e[i]]=n.prototype[e[i]];return t};var i={extend:function(t,e){var n;for(n in e=e||{},t)t.hasOwnProperty(n)&&(e.hasOwnProperty(n)||(e[n]=t[n]));return e},each:function(t,e,n){if("[object Object]"===Object.prototype.toString.call(t))for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(n,i,t[i],t);else for(var r=0,o=t.length;r<o;r++)e.call(n,r,t[r],t)},createElement:function(t,e){var n,i=document,r=i.createElement(t);if(e&&"[object Object]"===Object.prototype.toString.call(e))for(n in e)if(n in r)r[n]=e[n];else if("html"===n)r.innerHTML=e[n];else if("text"===n){var o=i.createTextNode(e[n]);r.appendChild(o)}else r.setAttribute(n,e[n]);return r},hasClass:function(t,e){if(t)return t.classList?t.classList.contains(e):!!t.className&&!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},addClass:function(t,e){i.hasClass(t,e)||(t.classList?t.classList.add(e):t.className=t.className.trim()+" "+e)},removeClass:function(t,e){i.hasClass(t,e)&&(t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\s)"+e.split(" ").join("|")+"(\\s|$)","gi")," "))},closest:function(t,e){return t&&t!==document.body&&(e(t)?t:i.closest(t.parentNode,e))},isInt:function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},debounce:function(t,e,n){var i;return function(){var r=this,o=arguments,a=n&&!i;clearTimeout(i),i=setTimeout((function(){i=null,n||t.apply(r,o)}),e),a&&t.apply(r,o)}},rect:function(t,e){var n=window,i=t.getBoundingClientRect(),r=e?n.pageXOffset:0,o=e?n.pageYOffset:0;return{bottom:i.bottom+o,height:i.height,left:i.left+r,right:i.right+r,top:i.top+o,width:i.width}},includes:function(t,e){return t.indexOf(e)>-1},truncate:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}};function r(t,e){return t.hasOwnProperty(e)&&(!0===t[e]||t[e].length)}function o(t,e,n){t.parentNode?t.parentNode.parentNode||e.appendChild(t.parentNode):e.appendChild(t),i.removeClass(t,"excluded"),n||(t.innerHTML=t.textContent)}var a=function(){if(this.items.length){var t=document.createDocumentFragment();if(this.config.pagination){var e=this.pages.slice(0,this.pageIndex);i.each(e,(function(e,n){i.each(n,(function(e,n){o(n,t,this.customOption)}),this)}),this)}else i.each(this.items,(function(e,n){o(n,t,this.customOption)}),this);t.childElementCount&&(i.removeClass(this.items[this.navIndex],"active"),this.navIndex=t.querySelector(".selectr-option").idx,i.addClass(this.items[this.navIndex],"active")),this.tree.appendChild(t)}},s=function(t,e){e=e||t;var n=this.customOption?this.config.renderOption(e):t.textContent,r=i.createElement("li",{class:"selectr-option",html:n,role:"treeitem","aria-selected":!1});return r.idx=t.idx,this.items.push(r),t.defaultSelected&&this.defaultSelected.push(t.idx),t.disabled&&(r.disabled=!0,i.addClass(r,"disabled")),r},l=function(){var t=this.tree;if(t.scrollTop>=t.scrollHeight-t.offsetHeight&&this.pageIndex<this.pages.length){var e=document.createDocumentFragment();i.each(this.pages[this.pageIndex],(function(t,n){o(n,e,this.customOption)}),this),t.appendChild(e),this.pageIndex++,this.emit("selectr.paginate",{items:this.items.length,total:this.data.length,page:this.pageIndex,pages:this.pages.length})}},u=function(){(this.config.searchable||this.config.taggable)&&(this.input.value=null,this.searching=!1,this.config.searchable&&i.removeClass(this.inputContainer,"active"),i.hasClass(this.container,"notice")&&(i.removeClass(this.container,"notice"),i.addClass(this.container,"open"),this.input.focus()),i.each(this.items,(function(t,e){i.removeClass(e,"excluded"),this.customOption||(e.innerHTML=e.textContent)}),this))},c=function(t,e){if(e=e||{},!t)throw new Error("You must supply either a HTMLSelectElement or a CSS3 selector string.");if(this.el=t,"string"==typeof t&&(this.el=document.querySelector(t)),null===this.el)throw new Error("The element you passed to Selectr can not be found.");if("select"!==this.el.nodeName.toLowerCase())throw new Error("The element you passed to Selectr is not a HTMLSelectElement.");this.render(e)};return c.prototype.render=function(t){if(!this.rendered){this.config=i.extend(e,t),this.originalType=this.el.type,this.originalIndex=this.el.tabIndex,this.defaultSelected=[],this.originalOptionCount=this.el.options.length,(this.config.multiple||this.config.taggable)&&(this.el.multiple=!0),this.disabled=r(this.config,"disabled"),this.opened=!1,this.config.taggable&&(this.config.searchable=!1),this.navigating=!1,this.mobileDevice=!1,/Android|webOS|iPhone|iPad|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile/i.test(navigator.userAgent)&&(this.mobileDevice=!0),this.customOption=this.config.hasOwnProperty("renderOption")&&"function"==typeof this.config.renderOption,this.customSelected=this.config.hasOwnProperty("renderSelection")&&"function"==typeof this.config.renderSelection,n.mixin(this),function(){this.requiresPagination=this.config.pagination&&this.config.pagination>0,r(this.config,"width")&&(i.isInt(this.config.width)?this.width=this.config.width+"px":"auto"===this.config.width?this.width="100%":i.includes(this.config.width,"%")&&(this.width=this.config.width)),this.container=i.createElement("div",{class:"selectr-container"}),this.config.customClass&&i.addClass(this.container,this.config.customClass),this.mobileDevice?i.addClass(this.container,"selectr-mobile"):i.addClass(this.container,"selectr-desktop"),this.el.tabIndex=-1,this.config.nativeDropdown||this.mobileDevice?i.addClass(this.el,"selectr-visible"):i.addClass(this.el,"selectr-hidden"),this.selected=i.createElement("div",{class:"selectr-selected",disabled:this.disabled,tabIndex:1,"aria-expanded":!1}),this.label=i.createElement(this.el.multiple?"ul":"span",{class:"selectr-label"});var t=i.createElement("div",{class:"selectr-options-container"});if(this.tree=i.createElement("ul",{class:"selectr-options",role:"tree","aria-hidden":!0,"aria-expanded":!1}),this.notice=i.createElement("div",{class:"selectr-notice"}),this.el.setAttribute("aria-hidden",!0),this.disabled&&(this.el.disabled=!0),this.el.multiple&&(i.addClass(this.label,"selectr-tags"),i.addClass(this.container,"multiple"),this.tags=[],this.selectedValues=this.getSelectedProperties("value"),this.selectedIndexes=this.getSelectedProperties("idx")),this.selected.appendChild(this.label),this.config.clearable&&(this.selectClear=i.createElement("button",{class:"selectr-clear",type:"button"}),this.container.appendChild(this.selectClear),i.addClass(this.container,"clearable")),this.config.taggable){var e=i.createElement("li",{class:"input-tag"});this.input=i.createElement("input",{class:"selectr-tag-input",placeholder:this.config.tagPlaceholder,tagIndex:0,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",role:"textbox",type:"search"}),e.appendChild(this.input),this.label.appendChild(e),i.addClass(this.container,"taggable"),this.tagSeperators=[","],this.config.tagSeperators&&(this.tagSeperators=this.tagSeperators.concat(this.config.tagSeperators))}this.config.searchable&&(this.input=i.createElement("input",{class:"selectr-input",tagIndex:-1,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",role:"textbox",type:"search"}),this.inputClear=i.createElement("button",{class:"selectr-input-clear",type:"button"}),this.inputContainer=i.createElement("div",{class:"selectr-input-container"}),this.inputContainer.appendChild(this.input),this.inputContainer.appendChild(this.inputClear),t.appendChild(this.inputContainer)),t.appendChild(this.notice),t.appendChild(this.tree),this.items=[],this.options=[],this.el.options.length&&(this.options=[].slice.call(this.el.options));var n,o=!1,a=0;if(this.el.children.length&&i.each(this.el.children,(function(t,e){"OPTGROUP"===e.nodeName?(o=i.createElement("ul",{class:"selectr-optgroup",role:"group",html:"<li class='selectr-optgroup--label'>"+e.label+"</li>"}),i.each(e.children,(function(t,e){e.idx=a,o.appendChild(s.call(this,e,o)),a++}),this)):(e.idx=a,s.call(this,e),a++)}),this),this.config.data&&Array.isArray(this.config.data)){this.data=[];var l,u=!1;o=!1,a=0,i.each(this.config.data,(function(t,e){r(e,"children")?(u=i.createElement("optgroup",{label:e.text}),o=i.createElement("ul",{class:"selectr-optgroup",role:"group",html:"<li class='selectr-optgroup--label'>"+e.text+"</li>"}),i.each(e.children,(function(t,e){(l=new Option(e.text,e.value,!1,e.hasOwnProperty("selected")&&!0===e.selected)).disabled=r(e,"disabled"),this.options.push(l),u.appendChild(l),l.idx=a,o.appendChild(s.call(this,l,e)),this.data[a]=e,a++}),this)):((l=new Option(e.text,e.value,!1,e.hasOwnProperty("selected")&&!0===e.selected)).disabled=r(e,"disabled"),this.options.push(l),l.idx=a,s.call(this,l,e),this.data[a]=e,a++)}),this)}this.setSelected(!0),this.navIndex=0;for(var c=0;c<this.items.length;c++)if(n=this.items[c],!i.hasClass(n,"disabled")){i.addClass(n,"active"),this.navIndex=c;break}this.requiresPagination&&(this.pageIndex=1,this.paginate()),this.container.appendChild(this.selected),this.container.appendChild(t),this.placeEl=i.createElement("div",{class:"selectr-placeholder"}),this.setPlaceholder(),this.selected.appendChild(this.placeEl),this.disabled&&this.disable(),this.el.parentNode.insertBefore(this.container,this.el),this.container.appendChild(this.el)}.call(this),this.bindEvents(),this.update(),this.optsRect=i.rect(this.tree),this.rendered=!0,this.el.multiple||(this.el.selectedIndex=this.selectedIndex);var o=this;setTimeout((function(){o.emit("selectr.init")}),20)}},c.prototype.getSelected=function(){return this.el.querySelectorAll("option:checked")},c.prototype.getSelectedProperties=function(t){var e=this.getSelected();return[].slice.call(e).map((function(e){return e[t]})).filter((function(t){return null!=t}))},c.prototype.bindEvents=function(){var t=this;this.events={},this.events.dismiss=function(t){var e=t.target;this.container.contains(e)||!this.opened&&!i.hasClass(this.container,"notice")||this.close()}.bind(this),this.events.navigate=function(t){if(t=t||window.event,this.items.length&&this.opened&&i.includes([13,38,40],t.which)){if(t.preventDefault(),13===t.which)return!(this.config.taggable&&this.input.value.length>0)&&this.change(this.navIndex);var e,n=this.items[this.navIndex];switch(t.which){case 38:e=0,this.navIndex>0&&this.navIndex--;break;case 40:e=1,this.navIndex<this.items.length-1&&this.navIndex++}for(this.navigating=!0;i.hasClass(this.items[this.navIndex],"disabled")||i.hasClass(this.items[this.navIndex],"excluded");)if(e?this.navIndex++:this.navIndex--,this.searching){if(this.navIndex>this.tree.lastElementChild.idx){this.navIndex=this.tree.lastElementChild.idx;break}if(this.navIndex<this.tree.firstElementChild.idx){this.navIndex=this.tree.firstElementChild.idx;break}}var r=i.rect(this.items[this.navIndex]);e?(0===this.navIndex?this.tree.scrollTop=0:r.top+r.height>this.optsRect.top+this.optsRect.height&&(this.tree.scrollTop=this.tree.scrollTop+(r.top+r.height-(this.optsRect.top+this.optsRect.height))),this.navIndex===this.tree.childElementCount-1&&this.requiresPagination&&l.call(this)):0===this.navIndex?this.tree.scrollTop=0:r.top-this.optsRect.top<0&&(this.tree.scrollTop=this.tree.scrollTop+(r.top-this.optsRect.top)),n&&i.removeClass(n,"active"),i.addClass(this.items[this.navIndex],"active")}else this.navigating=!1}.bind(this),this.events.reset=this.reset.bind(this),(this.config.nativeDropdown||this.mobileDevice)&&(this.container.addEventListener("touchstart",(function(e){e.changedTouches[0].target===t.el&&t.toggle()})),(this.config.nativeDropdown||this.mobileDevice)&&this.container.addEventListener("click",(function(e){e.target===t.el&&t.toggle()})),this.el.addEventListener("change",(function(e){if(t.el.multiple){var n=t.getSelectedProperties("idx"),r=(function(t,e){for(var n,i=[],r=t.slice(0),o=0;o<e.length;o++)(n=r.indexOf(e[o]))>-1?r.splice(n,1):i.push(e[o]);return[i,r]})(t.selectedIndexes,n);i.each(r[0],(function(e,n){t.select(n)}),t),i.each(r[1],(function(e,n){t.deselect(n)}),t)}else t.el.selectedIndex>-1&&t.select(t.el.selectedIndex)}))),this.config.nativeDropdown&&this.container.addEventListener("keydown",(function(e){"Enter"===e.key&&t.selected===document.activeElement&&(t.toggle(),setTimeout((function(){t.el.focus()}),200))})),this.selected.addEventListener("click",(function(e){t.disabled||t.toggle(),e.preventDefault()})),this.label.addEventListener("click",(function(e){i.hasClass(e.target,"selectr-tag-remove")&&t.deselect(e.target.parentNode.idx)})),this.selectClear&&this.selectClear.addEventListener("click",this.clear.bind(this)),this.tree.addEventListener("mousedown",(function(t){t.preventDefault()})),this.tree.addEventListener("click",(function(e){var n=i.closest(e.target,(function(t){return t&&i.hasClass(t,"selectr-option")}));n&&(i.hasClass(n,"disabled")||(i.hasClass(n,"selected")?(t.el.multiple||!t.el.multiple&&t.config.allowDeselect)&&t.deselect(n.idx):t.select(n.idx),t.opened&&!t.el.multiple&&t.close()))})),this.tree.addEventListener("mouseover",(function(e){i.hasClass(e.target,"selectr-option")&&(i.hasClass(e.target,"disabled")||(i.removeClass(t.items[t.navIndex],"active"),i.addClass(e.target,"active"),t.navIndex=[].slice.call(t.items).indexOf(e.target)))})),this.config.searchable&&(this.input.addEventListener("focus",(function(e){t.searching=!0})),this.input.addEventListener("blur",(function(e){t.searching=!1})),this.input.addEventListener("keyup",(function(e){t.search(),t.config.taggable||(this.value.length?i.addClass(this.parentNode,"active"):i.removeClass(this.parentNode,"active"))})),this.inputClear.addEventListener("click",(function(e){t.input.value=null,u.call(t),t.tree.childElementCount||a.call(t)}))),this.config.taggable&&this.input.addEventListener("keyup",(function(e){if(t.search(),t.config.taggable&&this.value.length){var n=this.value.trim();(13===e.which||i.includes(t.tagSeperators,e.key))&&(i.each(t.tagSeperators,(function(t,e){n=n.replace(e,"")})),t.add({value:n,text:n,selected:!0},!0)?(t.close(),u.call(t)):(this.value="",t.setMessage("That tag is already in use.")))}})),this.update=i.debounce((function(){t.opened&&t.config.closeOnScroll&&t.close(),t.width&&(t.container.style.width=t.width),t.invert()}),50),this.requiresPagination&&(this.paginateItems=i.debounce((function(){l.call(this)}),50),this.tree.addEventListener("scroll",this.paginateItems.bind(this))),document.addEventListener("click",this.events.dismiss),window.addEventListener("keydown",this.events.navigate),window.addEventListener("resize",this.update),window.addEventListener("scroll",this.update),this.el.form&&this.el.form.addEventListener("reset",this.events.reset)},c.prototype.setSelected=function(t){if(this.config.data||this.el.multiple||!this.el.options.length||(0===this.el.selectedIndex&&(this.el.options[0].defaultSelected||this.config.defaultSelected||(this.el.selectedIndex=-1)),this.selectedIndex=this.el.selectedIndex,this.selectedIndex>-1&&this.select(this.selectedIndex)),this.config.multiple&&"select-one"===this.originalType&&!this.config.data&&this.el.options[0].selected&&!this.el.options[0].defaultSelected&&(this.el.options[0].selected=!1),i.each(this.options,(function(t,e){e.selected&&e.defaultSelected&&this.select(e.idx)}),this),this.config.selectedValue&&this.setValue(this.config.selectedValue),this.config.data){!this.el.multiple&&this.config.defaultSelected&&this.el.selectedIndex<0&&this.select(0);var e=0;i.each(this.config.data,(function(t,n){r(n,"children")?i.each(n.children,(function(t,n){n.hasOwnProperty("selected")&&!0===n.selected&&this.select(e),e++}),this):(n.hasOwnProperty("selected")&&!0===n.selected&&this.select(e),e++)}),this)}},c.prototype.destroy=function(){this.rendered&&(this.emit("selectr.destroy"),"select-one"===this.originalType&&(this.el.multiple=!1),this.config.data&&(this.el.innerHTML=""),i.removeClass(this.el,"selectr-hidden"),this.el.form&&i.off(this.el.form,"reset",this.events.reset),i.off(document,"click",this.events.dismiss),i.off(document,"keydown",this.events.navigate),i.off(window,"resize",this.update),i.off(window,"scroll",this.update),this.container.parentNode.replaceChild(this.el,this.container),this.rendered=!1)},c.prototype.change=function(t){var e=this.items[t],n=this.options[t];n.disabled||(n.selected&&i.hasClass(e,"selected")?this.deselect(t):this.select(t),this.opened&&!this.el.multiple&&this.close())},c.prototype.select=function(t){var e=this.items[t],n=[].slice.call(this.el.options),r=this.options[t];if(this.el.multiple){if(i.includes(this.selectedIndexes,t))return!1;if(this.config.maxSelections&&this.tags.length===this.config.maxSelections)return this.setMessage("A maximum of "+this.config.maxSelections+" items can be selected.",!0),!1;this.selectedValues.push(r.value),this.selectedIndexes.push(t),function(t){var e,n=this,r=document.createDocumentFragment(),o=this.options[t.idx],a=this.data?this.data[t.idx]:o,s=this.customSelected?this.config.renderSelection(a):o.textContent,l=i.createElement("li",{class:"selectr-tag",html:s}),u=i.createElement("button",{class:"selectr-tag-remove",type:"button"});if(l.appendChild(u),l.idx=t.idx,l.tag=o.value,this.tags.push(l),this.config.sortSelected){var c=this.tags.slice();e=function(t,e){t.replace(/(\d+)|(\D+)/g,(function(t,n,i){e.push([n||1/0,i||""])}))},c.sort((function(t,i){var r,o,a=[],s=[];for(!0===n.config.sortSelected?(r=t.tag,o=i.tag):"text"===n.config.sortSelected&&(r=t.textContent,o=i.textContent),e(r,a),e(o,s);a.length&&s.length;){var l=a.shift(),u=s.shift(),c=l[0]-u[0]||l[1].localeCompare(u[1]);if(c)return c}return a.length-s.length})),i.each(c,(function(t,e){r.appendChild(e)})),this.label.innerHTML=""}else r.appendChild(l);this.config.taggable?this.label.insertBefore(r,this.input.parentNode):this.label.appendChild(r)}.call(this,e)}else{var o=this.data?this.data[t]:r;this.label.innerHTML=this.customSelected?this.config.renderSelection(o):r.textContent,this.selectedValue=r.value,this.selectedIndex=t,i.each(this.options,(function(e,n){var r=this.items[e];e!==t&&(r&&i.removeClass(r,"selected"),n.selected=!1,n.removeAttribute("selected"))}),this)}i.includes(n,r)||this.el.add(r),e.setAttribute("aria-selected",!0),i.addClass(e,"selected"),i.addClass(this.container,"has-selected"),r.selected=!0,r.setAttribute("selected",""),this.emit("selectr.change",r),this.emit("selectr.select",r)},c.prototype.deselect=function(t,e){var n=this.items[t],r=this.options[t];if(this.el.multiple){var o=this.selectedIndexes.indexOf(t);this.selectedIndexes.splice(o,1);var a=this.selectedValues.indexOf(r.value);this.selectedValues.splice(a,1),function(t){var e=!1;i.each(this.tags,(function(n,i){i.idx===t.idx&&(e=i)}),this),e&&(this.label.removeChild(e),this.tags.splice(this.tags.indexOf(e),1))}.call(this,n),this.tags.length||i.removeClass(this.container,"has-selected")}else{if(!e&&!this.config.clearable&&!this.config.allowDeselect)return!1;this.label.innerHTML="",this.selectedValue=null,this.el.selectedIndex=this.selectedIndex=-1,i.removeClass(this.container,"has-selected")}this.items[t].setAttribute("aria-selected",!1),i.removeClass(this.items[t],"selected"),r.selected=!1,r.removeAttribute("selected"),this.emit("selectr.change",null),this.emit("selectr.deselect",r)},c.prototype.setValue=function(t){var e=Array.isArray(t);if(e||(t=t.toString().trim()),!this.el.multiple&&e)return!1;i.each(this.options,(function(n,r){(e&&i.includes(t.toString(),r.value)||r.value===t)&&this.change(r.idx)}),this)},c.prototype.getValue=function(t,e){var n;if(this.el.multiple)t?this.selectedIndexes.length&&((n={}).values=[],i.each(this.selectedIndexes,(function(t,e){var i=this.options[e];n.values[t]={value:i.value,text:i.textContent}}),this)):n=this.selectedValues.slice();else if(t){var r=this.options[this.selectedIndex];n={value:r.value,text:r.textContent}}else n=this.selectedValue;return t&&e&&(n=JSON.stringify(n)),n},c.prototype.add=function(t,e){if(t){if(this.data=this.data||[],this.items=this.items||[],this.options=this.options||[],Array.isArray(t))i.each(t,(function(t,n){this.add(n,e)}),this);else if("[object Object]"===Object.prototype.toString.call(t)){if(e){var n=!1;if(i.each(this.options,(function(e,i){i.value.toLowerCase()===t.value.toLowerCase()&&(n=!0)})),n)return!1}var r=i.createElement("option",t);return this.data.push(t),this.options.push(r),r.idx=this.options.length>0?this.options.length-1:0,s.call(this,r),t.selected&&this.select(r.idx),r}return this.setPlaceholder(),this.config.pagination&&this.paginate(),!0}},c.prototype.remove=function(t){var e,n=[];Array.isArray(t)?i.each(t,(function(e,r){i.isInt(r)?n.push(this.getOptionByIndex(r)):"string"==typeof t&&n.push(this.getOptionByValue(r))}),this):i.isInt(t)?n.push(this.getOptionByIndex(t)):"string"==typeof t&&n.push(this.getOptionByValue(t)),n.length&&(i.each(n,(function(t,n){e=n.idx,this.el.remove(n),this.options.splice(e,1);var r=this.items[e].parentNode;r&&r.removeChild(this.items[e]),this.items.splice(e,1),i.each(this.options,(function(t,e){e.idx=t,this.items[t].idx=t}),this)}),this),this.setPlaceholder(),this.config.pagination&&this.paginate())},c.prototype.removeAll=function(){this.clear(!0),i.each(this.el.options,(function(t,e){this.el.remove(e)}),this),i.truncate(this.tree),this.items=[],this.options=[],this.data=[],this.navIndex=0,this.requiresPagination&&(this.requiresPagination=!1,this.pageIndex=1,this.pages=[]),this.setPlaceholder()},c.prototype.removeAllOption=function(){i.each(this.el.options,(function(t,e){this.el.remove(e)}),this),i.truncate(this.tree),this.items=[],this.options=[],this.data=[],this.navIndex=0},c.prototype.search=function(t){if(!this.navigating){t=t||this.input.value;var e=document.createDocumentFragment();if(this.removeMessage(),i.truncate(this.tree),t.length>1)if(i.each(this.options,(function(n,r){var a,s,l=this.items[r.idx];i.includes(r.textContent.toLowerCase(),t.toLowerCase())&&!r.disabled?(o(l,e,this.customOption),i.removeClass(l,"excluded"),this.customOption||(l.innerHTML=(a=r,!!(s=new RegExp(t,"i").exec(a.textContent))&&a.textContent.replace(s[0],"<span class='selectr-match'>"+s[0]+"</span>")))):i.addClass(l,"excluded")}),this),e.childElementCount){var n=this.items[this.navIndex],r=e.firstElementChild;i.removeClass(n,"active"),this.navIndex=r.idx,i.addClass(r,"active")}else this.config.taggable||this.setMessage("no results.");else a.call(this);this.tree.appendChild(e)}},c.prototype.toggle=function(){this.disabled||(this.opened?this.close():this.open())},c.prototype.open=function(){var t=this;return!!this.options.length&&(this.opened||this.emit("selectr.open"),this.opened=!0,this.mobileDevice||this.config.nativeDropdown?(i.addClass(this.container,"native-open"),void(this.config.data&&i.each(this.options,(function(t,e){this.el.add(e)}),this))):(i.addClass(this.container,"open"),a.call(this),this.invert(),this.tree.scrollTop=0,i.removeClass(this.container,"notice"),this.selected.setAttribute("aria-expanded",!0),this.tree.setAttribute("aria-hidden",!1),this.tree.setAttribute("aria-expanded",!0),void(this.config.searchable&&!this.config.taggable&&setTimeout((function(){t.input.focus(),t.input.tabIndex=0}),10))))},c.prototype.close=function(){if(this.opened&&this.emit("selectr.close"),this.opened=!1,this.mobileDevice||this.config.nativeDropdown)i.removeClass(this.container,"native-open");else{var t=i.hasClass(this.container,"notice");this.config.searchable&&!t&&(this.input.blur(),this.input.tabIndex=-1,this.searching=!1),t&&(i.removeClass(this.container,"notice"),this.notice.textContent=""),i.removeClass(this.container,"open"),i.removeClass(this.container,"native-open"),this.selected.setAttribute("aria-expanded",!1),this.tree.setAttribute("aria-hidden",!0),this.tree.setAttribute("aria-expanded",!1),i.truncate(this.tree),u.call(this)}},c.prototype.enable=function(){this.disabled=!1,this.el.disabled=!1,this.selected.tabIndex=this.originalIndex,this.el.multiple&&i.each(this.tags,(function(t,e){e.lastElementChild.tabIndex=0})),i.removeClass(this.container,"selectr-disabled")},c.prototype.disable=function(t){t||(this.el.disabled=!0),this.selected.tabIndex=-1,this.el.multiple&&i.each(this.tags,(function(t,e){e.lastElementChild.tabIndex=-1})),this.disabled=!0,i.addClass(this.container,"selectr-disabled")},c.prototype.reset=function(){this.disabled||(this.clear(),this.setSelected(!0),i.each(this.defaultSelected,(function(t,e){this.select(e)}),this),this.emit("selectr.reset"))},c.prototype.clear=function(t){if(this.el.multiple){if(this.selectedIndexes.length){var e=this.selectedIndexes.slice();i.each(e,(function(t,e){this.deselect(e)}),this)}}else this.selectedIndex>-1&&this.deselect(this.selectedIndex,t);this.emit("selectr.clear")},c.prototype.serialise=function(t){var e=[];return i.each(this.options,(function(t,n){var i={value:n.value,text:n.textContent};n.selected&&(i.selected=!0),n.disabled&&(i.disabled=!0),e[t]=i})),t?JSON.stringify(e):e},c.prototype.serialize=function(t){return this.serialise(t)},c.prototype.setPlaceholder=function(t){t=t||this.config.placeholder||this.el.getAttribute("placeholder"),this.options.length||(t="No options available"),this.placeEl.innerHTML=t},c.prototype.paginate=function(){if(this.items.length){var t=this;return this.pages=this.items.map((function(e,n){return n%t.config.pagination==0?t.items.slice(n,n+t.config.pagination):null})).filter((function(t){return t})),this.pages}},c.prototype.setMessage=function(t,e){e&&this.close(),i.addClass(this.container,"notice"),this.notice.textContent=t},c.prototype.removeMessage=function(){i.removeClass(this.container,"notice"),this.notice.innerHTML=""},c.prototype.invert=function(){var t=i.rect(this.selected),e=this.tree.parentNode.offsetHeight,n=window.innerHeight;t.top+t.height+e>n?(i.addClass(this.container,"inverted"),this.isInverted=!0):(i.removeClass(this.container,"inverted"),this.isInverted=!1),this.optsRect=i.rect(this.tree)},c.prototype.getOptionByIndex=function(t){return this.options[t]},c.prototype.getOptionByValue=function(t){for(var e=!1,n=0,i=this.options.length;n<i;n++)if(this.options[n].value.trim()===t.toString().trim()){e=this.options[n];break}return e},c},t.exports=e()}).call(window)},6:function(t,e){!(function(n,i){"object"==typeof e&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):n.mapboxgl=i()})(this,(function(){"use strict";var t,e,n;function i(i,r){if(t)if(e){var o="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",a={};t(a),(n=r(a)).workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"}))}else e=r;else t=r}return i(0,(function(t){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function i(t,e){return t(e={exports:{}},e.exports),e.exports}var r=o;function o(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=n,this.p2y=i}o.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},o.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},o.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},o.prototype.solveCurveX=function(t,e){var n,i,r,o,a;for(void 0===e&&(e=1e-6),r=t,a=0;a<8;a++){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;var s=this.sampleCurveDerivativeX(r);if(Math.abs(s)<1e-6)break;r-=o/s}if((r=t)<(n=0))return n;if(r>(i=1))return i;for(;n<i;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?n=r:i=r,r=.5*(i-n)+n}return r},o.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var a=function(t,e,n){this.column=t,this.row=e,this.zoom=n};a.prototype.clone=function(){return new a(this.column,this.row,this.zoom)},a.prototype.zoomTo=function(t){return this.clone()._zoomTo(t)},a.prototype.sub=function(t){return this.clone()._sub(t)},a.prototype._zoomTo=function(t){var e=Math.pow(2,t-this.zoom);return this.column*=e,this.row*=e,this.zoom=t,this},a.prototype._sub=function(t){return t=t.zoomTo(this.zoom),this.column-=t.column,this.row-=t.row,this};var s=l;function l(t,e){this.x=t,this.y=e}function u(t,e,n,i){var o=new r(t,e,n,i);return function(t){return o.solve(t)}}l.prototype={clone:function(){return new l(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,r=n*this.x+e*this.y;return this.x=i,this.y=r,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),r=e.x+n*(this.x-e.x)-i*(this.y-e.y),o=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=r,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},l.convert=function(t){return t instanceof l?t:Array.isArray(t)?new l(t[0],t[1]):t};var c=u(.25,.1,.25,1);function h(t,e,n){return Math.min(n,Math.max(e,t))}function p(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var i=0,r=e;i<r.length;i+=1){var o=r[i];for(var a in o)t[a]=o[a]}return t}var f=1;function d(t,e){t.forEach((function(t){e[t]&&(e[t]=e[t].bind(e))}))}function m(t,e){return-1!==t.indexOf(e,t.length-e.length)}function v(t,e,n){var i={};for(var r in t)i[r]=e.call(n||this,t[r],r,t);return i}function g(t,e,n){var i={};for(var r in t)e.call(n||this,t[r],r,t)&&(i[r]=t[r]);return i}function y(t){return Array.isArray(t)?t.map(y):"object"==typeof t&&t?v(t,y):t}var _={};function x(t){_[t]||("undefined"!=typeof console&&console.warn(t),_[t]=!0)}function b(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function w(t){for(var e=0,n=0,i=t.length,r=i-1,o=void 0,a=void 0;n<i;r=n++)o=t[n],e+=((a=t[r]).x-o.x)*(o.y+a.y);return e}var E={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(E);var S=(function(t){function e(e,n,i){t.call(this,e),this.status=n,this.url=i,this.name=this.constructor.name,this.message=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e})(Error);function C(t){var e=new self.XMLHttpRequest;for(var n in e.open("GET",t.url,!0),t.headers)e.setRequestHeader(n,t.headers[n]);return e.withCredentials="include"===t.credentials,e}var T=function(t,e){var n=C(t);return n.responseType="arraybuffer",n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){var i=n.response;if(0===i.byteLength&&200===n.status)return e(new Error("http status 200 returned without content."));n.status>=200&&n.status<300&&n.response?e(null,{data:i,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")}):e(new S(n.statusText,n.status,t.url))},n.send(),n};function A(t,e,n){n[t]=n[t]||[],n[t].push(e)}function M(t,e,n){if(n&&n[t]){var i=n[t].indexOf(e);-1!==i&&n[t].splice(i,1)}}var I=function(t,e){void 0===e&&(e={}),p(this,e),this.type=t},k=(function(t){function e(e,n){void 0===n&&(n={}),t.call(this,"error",p({error:e},n))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e})(I),z=function(){};z.prototype.on=function(t,e){return this._listeners=this._listeners||{},A(t,e,this._listeners),this},z.prototype.off=function(t,e){return M(t,e,this._listeners),M(t,e,this._oneTimeListeners),this},z.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},A(t,e,this._oneTimeListeners),this},z.prototype.fire=function(t){"string"==typeof t&&(t=new I(t,arguments[1]||{}));var e=t.type;if(this.listens(e)){t.target=this;for(var n=0,i=this._listeners&&this._listeners[e]?this._listeners[e].slice():[];n<i.length;n+=1)i[n].call(this,t);for(var r=0,o=this._oneTimeListeners&&this._oneTimeListeners[e]?this._oneTimeListeners[e].slice():[];r<o.length;r+=1){var a=o[r];M(e,a,this._oneTimeListeners),a.call(this,t)}var s=this._eventedParent;s&&(p(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),s.fire(t))}else m(e,"error")?console.error(t&&t.error||t||"Empty error event"):m(e,"warning")&&console.warn(t&&t.warning||t||"Empty warning event");return this},z.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},z.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var D={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},lineMetrics:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{butt:{},round:{},square:{}},default:"butt"},"line-join":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{bevel:{},round:{},miter:{}},default:"miter"},"line-miter-limit":{type:"number",default:2,function:"interpolated","zoom-function":!0,requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated","zoom-function":!0,requires:[{"line-join":"round"}]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{point:{},line:{}},default:"point"},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated","zoom-function":!0,units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,units:"factor of the original icon size",requires:["icon-image"]},"icon-text-fit":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"]},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",function:"interpolated","zoom-function":!0,requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}]},"icon-image":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,"property-function":!0,units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated","zoom-function":!0,units:"pixels",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,"property-function":!0,requires:["icon-image"]},"icon-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"]},"icon-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"text-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,default:"",tokens:!0},"text-font":{type:"array",value:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"ems",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{left:{},center:{},right:{}},default:"center",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated","zoom-function":!0,requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field","icon-image"]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Heatmap"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},transition:!1,"zoom-function":!0,"property-function":!1,function:"piecewise-constant"},position:{type:"array",default:[1.15,210,30],length:3,value:"number",transition:!0,function:"interpolated","zoom-function":!0,"property-function":!1},color:{type:"color",default:"#ffffff",function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0},intensity:{type:"number",default:.5,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0},"fill-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0}},paint_line:{"line-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-gap-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant","zoom-function":!0,minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"line-gradient":{type:"color",function:"interpolated","zoom-function":!1,"property-function":!1,transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}]}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-blur":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["circle-translate"]},"circle-pitch-scale":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map"},"circle-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"viewport"},"circle-stroke-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-stroke-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"heatmap-weight":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!1},"heatmap-intensity":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],function:"interpolated","zoom-function":!1,"property-function":!1,transition:!1},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,transition:!0,units:"degrees"},"raster-brightness-min":{type:"number",function:"interpolated","zoom-function":!0,default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated","zoom-function":!0,default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated","zoom-function":!0,transition:!1,units:"milliseconds"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,function:"interpolated","zoom-function":!0,transition:!1},"hillshade-illumination-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"viewport"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"hillshade-shadow-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",function:"interpolated","zoom-function":!0,transition:!0},"hillshade-accent-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0}},paint_background:{"background-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!1,default:1,minimum:0,maximum:1,transition:!0},"fill-extrusion-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-extrusion-pattern"}]},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-extrusion-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"]},"fill-extrusion-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"fill-extrusion-height":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,units:"meters",transition:!0},"fill-extrusion-base":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"]}}},L=function(t,e,n,i){this.message=(t?t+": ":"")+n,i&&(this.identifier=i),null!=e&&e.__line__&&(this.line=e.__line__)};function P(t){var e=t.key,n=t.value;return n?[new L(e,n,"constants have been deprecated as of v8")]:[]}function O(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var i=0,r=e;i<r.length;i+=1){var o=r[i];for(var a in o)t[a]=o[a]}return t}function R(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function B(t){return Array.isArray(t)?t.map(B):R(t)}var F=(function(t){function e(e,n){t.call(this,n),this.message=n,this.key=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e})(Error),N=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var n=0,i=e;n<i.length;n+=1){var r=i[n],o=r[0],a=r[1];this.bindings[o]=a}};N.prototype.concat=function(t){return new N(this,t)},N.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},N.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var V={kind:"null"},j={kind:"number"},U={kind:"string"},q={kind:"boolean"},$={kind:"color"},Z={kind:"object"},G={kind:"value"},W={kind:"collator"};function Y(t,e){return{kind:"array",itemType:t,N:e}}function H(t){if("array"===t.kind){var e=H(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var X=[V,j,U,q,$,Z,Y(G)];function K(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&!K(t.itemType,e.itemType)&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var n=0,i=X;n<i.length;n+=1)if(!K(i[n],e))return null}return"Expected "+H(t)+" but found "+H(e)+" instead."}var J=i((function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(t){return(t=Math.round(t))<0?0:t>255?255:t}function r(t){return t<0?0:t>1?1:t}function o(t){return"%"===t[t.length-1]?i(parseFloat(t)/100*255):i(parseInt(t))}function a(t){return"%"===t[t.length-1]?r(parseFloat(t)/100):r(parseFloat(t))}function s(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{e.parseCSSColor=function(t){var e,r=t.replace(/ /g,"").toLowerCase();if(r in n)return n[r].slice();if("#"===r[0])return 4===r.length?(e=parseInt(r.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===r.length&&(e=parseInt(r.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=r.indexOf("("),u=r.indexOf(")");if(-1!==l&&u+1===r.length){var c=r.substr(0,l),h=r.substr(l+1,u-(l+1)).split(","),p=1;switch(c){case"rgba":if(4!==h.length)return null;p=a(h.pop());case"rgb":return 3!==h.length?null:[o(h[0]),o(h[1]),o(h[2]),p];case"hsla":if(4!==h.length)return null;p=a(h.pop());case"hsl":if(3!==h.length)return null;var f=(parseFloat(h[0])%360+360)%360/360,d=a(h[1]),m=a(h[2]),v=m<=.5?m*(d+1):m+d-m*d,g=2*m-v;return[i(255*s(g,v,f+1/3)),i(255*s(g,v,f)),i(255*s(g,v,f-1/3)),p];default:return null}}return null}}catch(t){}})).parseCSSColor,Q=function(t,e,n,i){void 0===i&&(i=1),this.r=t,this.g=e,this.b=n,this.a=i};Q.parse=function(t){if(t){if(t instanceof Q)return t;if("string"==typeof t){var e=J(t);if(e)return new Q(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},Q.prototype.toString=function(){var t=this.toArray(),e=t[0],n=t[1],i=t[2],r=t[3];return"rgba("+Math.round(e)+","+Math.round(n)+","+Math.round(i)+","+r+")"},Q.prototype.toArray=function(){var t=this.r,e=this.g,n=this.b,i=this.a;return 0===i?[0,0,0,0]:[255*t/i,255*e/i,255*n/i,i]},Q.black=new Q(0,0,0,1),Q.white=new Q(1,1,1,1),Q.transparent=new Q(0,0,0,0);var tt=function(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};tt.prototype.compare=function(t,e){return this.collator.compare(t,e)},tt.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var et=function(t,e,n){this.type=W,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e};function nt(t,e,n,i){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:"Invalid rgba value ["+[t,e,n,i].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function it(t){if(null===t)return V;if("string"==typeof t)return U;if("boolean"==typeof t)return q;if("number"==typeof t)return j;if(t instanceof Q)return $;if(t instanceof tt)return W;if(Array.isArray(t)){for(var e,n=t.length,i=0,r=t;i<r.length;i+=1){var o=it(r[i]);if(e){if(e===o)continue;e=G;break}e=o}return Y(e||G,n)}return Z}et.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");var i=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,q);if(!i)return null;var r=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,q);if(!r)return null;var o=null;return n.locale&&!(o=e.parse(n.locale,1,U))?null:new et(i,r,o)},et.prototype.evaluate=function(t){return new tt(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},et.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},et.prototype.possibleOutputs=function(){return[void 0]},et.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var rt=function(t,e){this.type=t,this.value=e};rt.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!(function t(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Q)return!0;if(e instanceof tt)return!0;if(Array.isArray(e)){for(var n=0,i=e;n<i.length;n+=1)if(!t(i[n]))return!1;return!0}if("object"==typeof e){for(var r in e)if(!t(e[r]))return!1;return!0}return!1})(t[1]))return e.error("invalid value");var n=t[1],i=it(n),r=e.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new rt(i,n)},rt.prototype.evaluate=function(){return this.value},rt.prototype.eachChild=function(){},rt.prototype.possibleOutputs=function(){return[this.value]},rt.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Q?["rgba"].concat(this.value.toArray()):this.value};var ot=function(t){this.name="ExpressionEvaluationError",this.message=t};ot.prototype.toJSON=function(){return this.message};var at={string:U,number:j,boolean:q,object:Z},st=function(t,e){this.type=t,this.args=e};st.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");for(var n=t[0],i=at[n],r=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,G);if(!a)return null;r.push(a)}return new st(i,r)},st.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var n=this.args[e].evaluate(t);if(!K(this.type,it(n)))return n;if(e===this.args.length-1)throw new ot("Expected value to be of type "+H(this.type)+", but found "+H(it(n))+" instead.")}return null},st.prototype.eachChild=function(t){this.args.forEach(t)},st.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map((function(t){return t.possibleOutputs()})));var t},st.prototype.serialize=function(){return[this.type.kind].concat(this.args.map((function(t){return t.serialize()})))};var lt={string:U,number:j,boolean:q},ut=function(t,e){this.type=t,this.input=e};ut.parse=function(t,e){if(t.length<2||t.length>4)return e.error("Expected 1, 2, or 3 arguments, but found "+(t.length-1)+" instead.");var n,i;if(t.length>2){var r=t[1];if("string"!=typeof r||!(r in lt))return e.error('The item type argument of "array" must be one of string, number, boolean',1);n=lt[r]}else n=G;if(t.length>3){if("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2]))return e.error('The length argument to "array" must be a positive integer literal',2);i=t[2]}var o=Y(n,i),a=e.parse(t[t.length-1],t.length-1,G);return a?new ut(o,a):null},ut.prototype.evaluate=function(t){var e=this.input.evaluate(t);if(K(this.type,it(e)))throw new ot("Expected value to be of type "+H(this.type)+", but found "+H(it(e))+" instead.");return e},ut.prototype.eachChild=function(t){t(this.input)},ut.prototype.possibleOutputs=function(){return this.input.possibleOutputs()},ut.prototype.serialize=function(){var t=["array"],e=this.type.itemType;if("string"===e.kind||"number"===e.kind||"boolean"===e.kind){t.push(e.kind);var n=this.type.N;"number"==typeof n&&t.push(n)}return t.push(this.input.serialize()),t};var ct={"to-number":j,"to-color":$},ht=function(t,e){this.type=t,this.args=e};ht.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");for(var n=t[0],i=ct[n],r=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,G);if(!a)return null;r.push(a)}return new ht(i,r)},ht.prototype.evaluate=function(t){if("color"===this.type.kind){for(var e,n,i=0,r=this.args;i<r.length;i+=1)if(n=null,"string"==typeof(e=r[i].evaluate(t))){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(n=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":nt(e[0],e[1],e[2],e[3])))return new Q(e[0]/255,e[1]/255,e[2]/255,e[3]);throw new ot(n||"Could not parse color from value '"+("string"==typeof e?e:JSON.stringify(e))+"'")}for(var a=null,s=0,l=this.args;s<l.length;s+=1)if(null!==(a=l[s].evaluate(t))){var u=Number(a);if(!isNaN(u))return u}throw new ot("Could not convert "+JSON.stringify(a)+" to number.")},ht.prototype.eachChild=function(t){this.args.forEach(t)},ht.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map((function(t){return t.possibleOutputs()})));var t},ht.prototype.serialize=function(){var t=["to-"+this.type.kind];return this.eachChild((function(e){t.push(e.serialize())})),t};var pt=["Unknown","Point","LineString","Polygon"],ft=function(){this._parseColorCache={}};ft.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ft.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?pt[this.feature.type]:this.feature.type:null},ft.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ft.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Q.parse(t)),e};var dt=function(t,e,n,i){this.name=t,this.type=e,this._evaluate=n,this.args=i};function mt(t){if(t instanceof dt){if("get"===t.name&&1===t.args.length)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}var e=!0;return t.eachChild((function(t){e&&!mt(t)&&(e=!1)})),e}function vt(t,e){if(t instanceof dt&&e.indexOf(t.name)>=0)return!1;var n=!0;return t.eachChild((function(t){n&&!vt(t,e)&&(n=!1)})),n}dt.prototype.evaluate=function(t){return this._evaluate(t,this.args)},dt.prototype.eachChild=function(t){this.args.forEach(t)},dt.prototype.possibleOutputs=function(){return[void 0]},dt.prototype.serialize=function(){return[this.name].concat(this.args.map((function(t){return t.serialize()})))},dt.parse=function(t,e){var n=t[0],i=dt.definitions[n];if(!i)return e.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0);for(var r=Array.isArray(i)?i[0]:i.type,o=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,a=o.filter((function(e){var n=e[0];return!Array.isArray(n)||n.length===t.length-1})),s=[],l=1;l<t.length;l++){var u=t[l],c=void 0;if(1===a.length){var h=a[0][0];c=Array.isArray(h)?h[l-1]:h.type}var p=e.parse(u,1+s.length,c);if(!p)return null;s.push(p)}for(var f=null,d=0,m=a;d<m.length;d+=1){var v=m[d],g=v[0],y=v[1];if(f=new yt(e.registry,e.path,null,e.scope),Array.isArray(g)&&g.length!==s.length)f.error("Expected "+g.length+" arguments, but found "+s.length+" instead.");else{for(var _=0;_<s.length;_++){var x=Array.isArray(g)?g[_]:g.type,b=s[_];f.concat(_+1).checkSubtype(x,b.type)}if(0===f.errors.length)return new dt(n,r,y,s)}}if(1===a.length)e.errors.push.apply(e.errors,f.errors);else{var w=(a.length?a:o).map((function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(H).join(", ")+")":"("+H(e.type)+"...)"})).join(" | "),E=s.map((function(t){return H(t.type)})).join(", ");e.error("Expected arguments of type "+w+", but found ("+E+") instead.")}return null},dt.register=function(t,e){for(var n in dt.definitions=e,e)t[n]=dt};var gt=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};gt.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var n=t[1];return e.scope.has(n)?new gt(n,e.scope.get(n)):e.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)},gt.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},gt.prototype.eachChild=function(){},gt.prototype.possibleOutputs=function(){return[void 0]},gt.prototype.serialize=function(){return["var",this.name]};var yt=function(t,e,n,i,r){void 0===e&&(e=[]),void 0===i&&(i=new N),void 0===r&&(r=[]),this.registry=t,this.path=e,this.key=e.map((function(t){return"["+t+"]"})).join(""),this.scope=i,this.errors=r,this.expectedType=n};function _t(t,e){for(var n,i,r=0,o=t.length-1,a=0;r<=o;){if(n=t[a=Math.floor((r+o)/2)],i=t[a+1],e===n||e>n&&e<i)return a;if(n<e)r=a+1;else{if(!(n>e))throw new ot("Input is not a number.");o=a-1}}return Math.max(a-1,0)}yt.prototype.parse=function(t,e,n,i,r){return void 0===r&&(r={}),e?this.concat(e,n,i)._parse(t,r):this._parse(t,r)},yt.prototype._parse=function(t,e){if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var n=t[0];if("string"!=typeof n)return this.error("Expression name must be a string, but found "+typeof n+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var i=this.registry[n];if(i){var r=i.parse(t,this);if(!r)return null;if(this.expectedType){var o=this.expectedType,a=r.type;if("string"!==o.kind&&"number"!==o.kind&&"boolean"!==o.kind&&"object"!==o.kind||"value"!==a.kind)if("array"===o.kind&&"value"===a.kind)e.omitTypeAnnotations||(r=new ut(o,r));else if("color"!==o.kind||"value"!==a.kind&&"string"!==a.kind){if(this.checkSubtype(this.expectedType,r.type))return null}else e.omitTypeAnnotations||(r=new ht(o,[r]));else e.omitTypeAnnotations||(r=new st(o,[r]))}if(!(r instanceof rt)&&(function t(e){if(e instanceof gt)return t(e.boundExpression);if(e instanceof dt&&"error"===e.name)return!1;if(e instanceof et)return!1;var n=e instanceof ht||e instanceof st||e instanceof ut,i=!0;return e.eachChild((function(e){i=n?i&&t(e):i&&e instanceof rt})),!!i&&(mt(e)&&vt(e,["zoom","heatmap-density","line-progress","is-supported-script"]))})(r)){var s=new ft;try{r=new rt(r.type,r.evaluate(s))}catch(t){return this.error(t.message),null}}return r}return this.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof t+" instead.")},yt.prototype.concat=function(t,e,n){var i="number"==typeof t?this.path.concat(t):this.path,r=n?this.scope.concat(n):this.scope;return new yt(this.registry,i,e||null,r,this.errors)},yt.prototype.error=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var i=""+this.key+e.map((function(t){return"["+t+"]"})).join("");this.errors.push(new F(i,t))},yt.prototype.checkSubtype=function(t,e){var n=K(t,e);return n&&this.error(n),n};var xt=function(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var i=0,r=n;i<r.length;i+=1){var o=r[i],a=o[0],s=o[1];this.labels.push(a),this.outputs.push(s)}};function bt(t,e,n){return t*(1-n)+e*n}xt.parse=function(t,e){var n=t[1],i=t.slice(2);if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(n=e.parse(n,1,j)))return null;var r=[],o=null;e.expectedType&&"value"!==e.expectedType.kind&&(o=e.expectedType),i.unshift(-1/0);for(var a=0;a<i.length;a+=2){var s=i[a],l=i[a+1],u=a+1,c=a+2;if("number"!=typeof s)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(r.length&&r[r.length-1][0]>=s)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var h=e.parse(l,c,o);if(!h)return null;o=o||h.type,r.push([s,h])}return new xt(o,n,r)},xt.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);var r=e.length;return i>=e[r-1]?n[r-1].evaluate(t):n[_t(e,i)].evaluate(t)},xt.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},xt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map((function(t){return t.possibleOutputs()})));var t},xt.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var wt=Object.freeze({number:bt,color:function(t,e,n){return new Q(bt(t.r,e.r,n),bt(t.g,e.g,n),bt(t.b,e.b,n),bt(t.a,e.a,n))},array:function(t,e,n){return t.map((function(t,i){return bt(t,e[i],n)}))}}),Et=function(t,e,n,i){this.type=t,this.interpolation=e,this.input=n,this.labels=[],this.outputs=[];for(var r=0,o=i;r<o.length;r+=1){var a=o[r],s=a[0],l=a[1];this.labels.push(s),this.outputs.push(l)}};function St(t,e,n,i){var r=i-n,o=t-n;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}Et.interpolationFactor=function(t,e,n,i){var o=0;if("exponential"===t.name)o=St(e,t.base,n,i);else if("linear"===t.name)o=St(e,1,n,i);else if("cubic-bezier"===t.name){var a=t.controlPoints;o=new r(a[0],a[1],a[2],a[3]).solve(St(e,1,n,i))}return o},Et.parse=function(t,e){var n=t[1],i=t[2],r=t.slice(3);if(!Array.isArray(n)||0===n.length)return e.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){var o=n[1];if("number"!=typeof o)return e.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:o}}else{if("cubic-bezier"!==n[0])return e.error("Unknown interpolation type "+String(n[0]),1,0);var a=n.slice(1);if(4!==a.length||a.some((function(t){return"number"!=typeof t||t<0||t>1})))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:a}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(i=e.parse(i,2,j)))return null;var s=[],l=null;e.expectedType&&"value"!==e.expectedType.kind&&(l=e.expectedType);for(var u=0;u<r.length;u+=2){var c=r[u],h=r[u+1],p=u+3,f=u+4;if("number"!=typeof c)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(s.length&&s[s.length-1][0]>=c)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);var d=e.parse(h,f,l);if(!d)return null;l=l||d.type,s.push([c,d])}return"number"===l.kind||"color"===l.kind||"array"===l.kind&&"number"===l.itemType.kind&&"number"==typeof l.N?new Et(l,n,i,s):e.error("Type "+H(l)+" is not interpolatable.")},Et.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);var r=e.length;if(i>=e[r-1])return n[r-1].evaluate(t);var o=_t(e,i),a=e[o],s=e[o+1],l=Et.interpolationFactor(this.interpolation,i,a,s),u=n[o].evaluate(t),c=n[o+1].evaluate(t);return wt[this.type.kind.toLowerCase()](u,c,l)},Et.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},Et.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map((function(t){return t.possibleOutputs()})));var t},Et.prototype.serialize=function(){for(var t=["interpolate","linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints),this.input.serialize()],e=0;e<this.labels.length;e++)t.push(this.labels[e],this.outputs[e].serialize());return t};var Ct=function(t,e){this.type=t,this.args=e};Ct.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var n=null,i=e.expectedType;i&&"value"!==i.kind&&(n=i);for(var r=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=a[o],l=e.parse(s,1+r.length,n,void 0,{omitTypeAnnotations:!0});if(!l)return null;n=n||l.type,r.push(l)}var u=i&&r.some((function(t){return K(i,t.type)}));return new Ct(u?G:n,r)},Ct.prototype.evaluate=function(t){for(var e=null,n=0,i=this.args;n<i.length&&null===(e=i[n].evaluate(t));n+=1);return e},Ct.prototype.eachChild=function(t){this.args.forEach(t)},Ct.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map((function(t){return t.possibleOutputs()})));var t},Ct.prototype.serialize=function(){var t=["coalesce"];return this.eachChild((function(e){t.push(e.serialize())})),t};var Tt=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};Tt.prototype.evaluate=function(t){return this.result.evaluate(t)},Tt.prototype.eachChild=function(t){for(var e=0,n=this.bindings;e<n.length;e+=1)t(n[e][1]);t(this.result)},Tt.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var n=[],i=1;i<t.length-1;i+=2){var r=t[i];if("string"!=typeof r)return e.error("Expected string, but found "+typeof r+" instead.",i);if(/[^a-zA-Z0-9_]/.test(r))return e.error("Variable names must contain only alphanumeric characters or '_'.",i);var o=e.parse(t[i+1],i+1);if(!o)return null;n.push([r,o])}var a=e.parse(t[t.length-1],t.length-1,void 0,n);return a?new Tt(n,a):null},Tt.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},Tt.prototype.serialize=function(){for(var t=["let"],e=0,n=this.bindings;e<n.length;e+=1){var i=n[e],r=i[0],o=i[1];t.push(r,o.serialize())}return t.push(this.result.serialize()),t};var At=function(t,e,n){this.type=t,this.index=e,this.input=n};At.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,j),i=e.parse(t[2],2,Y(e.expectedType||G));if(!n||!i)return null;var r=i.type;return new At(r.itemType,n,i)},At.prototype.evaluate=function(t){var e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new ot("Array index out of bounds: "+e+" < 0.");if(e>=n.length)throw new ot("Array index out of bounds: "+e+" > "+(n.length-1)+".");if(e!==Math.floor(e))throw new ot("Array index must be an integer, but found "+e+" instead.");return n[e]},At.prototype.eachChild=function(t){t(this.index),t(this.input)},At.prototype.possibleOutputs=function(){return[void 0]},At.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Mt=function(t,e,n,i,r,o){this.inputType=t,this.type=e,this.input=n,this.cases=i,this.outputs=r,this.otherwise=o};Mt.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var n,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var r={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],l=t[a+1];Array.isArray(s)||(s=[s]);var u=e.concat(a);if(0===s.length)return u.error("Expected at least one branch label.");for(var c=0,h=s;c<h.length;c+=1){var p=h[c];if("number"!=typeof p&&"string"!=typeof p)return u.error("Branch labels must be numbers or strings.");if("number"==typeof p&&Math.abs(p)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof p&&Math.floor(p)!==p)return u.error("Numeric branch labels must be integer values.");if(n){if(u.checkSubtype(n,it(p)))return null}else n=it(p);if(void 0!==r[String(p)])return u.error("Branch labels must be unique.");r[String(p)]=o.length}var f=e.parse(l,a,i);if(!f)return null;i=i||f.type,o.push(f)}var d=e.parse(t[1],1,n);if(!d)return null;var m=e.parse(t[t.length-1],t.length-1,i);return m?new Mt(n,i,d,r,o,m):null},Mt.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},Mt.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},Mt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map((function(t){return t.possibleOutputs()}))).concat(this.otherwise.possibleOutputs());var t},Mt.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],n=[],i={},r=0,o=Object.keys(this.cases).sort();r<o.length;r+=1){var a=o[r],s=i[t.cases[a]];void 0===s?(i[t.cases[a]]=n.length,n.push([t.cases[a],[a]])):n[s][1].push(a)}for(var l=function(e){return"number"===t.input.type.kind?Number(e):e},u=0,c=n;u<c.length;u+=1){var h=c[u],p=h[0],f=h[1];1===f.length?e.push(l(f[0])):e.push(f.map(l)),e.push(t.outputs[p].serialize())}return e.push(this.otherwise.serialize()),e};var It=function(t,e,n){this.type=t,this.branches=e,this.otherwise=n};function kt(t){return"string"===t.kind||"number"===t.kind||"boolean"===t.kind||"null"===t.kind}function zt(t,e){return (function(){function n(t,e,n){this.type=q,this.lhs=t,this.rhs=e,this.collator=n}return n.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var i=e.parse(t[1],1,G);if(!i)return null;var r=e.parse(t[2],2,G);if(!r)return null;if(!kt(i.type)&&!kt(r.type))return e.error("Expected at least one argument to be a string, number, boolean, or null, but found ("+H(i.type)+", "+H(r.type)+") instead.");if(i.type.kind!==r.type.kind&&"value"!==i.type.kind&&"value"!==r.type.kind)return e.error("Cannot compare "+H(i.type)+" and "+H(r.type)+".");var o=null;if(4===t.length){if("string"!==i.type.kind&&"string"!==r.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(o=e.parse(t[3],3,W)))return null}return new n(i,r,o)},n.prototype.evaluate=function(t){var n=this.collator?0===this.collator.evaluate(t).compare(this.lhs.evaluate(t),this.rhs.evaluate(t)):this.lhs.evaluate(t)===this.rhs.evaluate(t);return e?!n:n},n.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},n.prototype.possibleOutputs=function(){return[!0,!1]},n.prototype.serialize=function(){var e=[t];return this.eachChild((function(t){e.push(t.serialize())})),e},n})()}It.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var i=[],r=1;r<t.length-1;r+=2){var o=e.parse(t[r],r,q);if(!o)return null;var a=e.parse(t[r+1],r+1,n);if(!a)return null;i.push([o,a]),n=n||a.type}var s=e.parse(t[t.length-1],t.length-1,n);return s?new It(n,i,s):null},It.prototype.evaluate=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var i=n[e],r=i[0],o=i[1];if(r.evaluate(t))return o.evaluate(t)}return this.otherwise.evaluate(t)},It.prototype.eachChild=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var i=n[e],r=i[0],o=i[1];t(r),t(o)}t(this.otherwise)},It.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.branches.map((function(t){return t[0],t[1].possibleOutputs()}))).concat(this.otherwise.possibleOutputs());var t},It.prototype.serialize=function(){var t=["case"];return this.eachChild((function(e){t.push(e.serialize())})),t};var Dt=zt("==",!1),Lt=zt("!=",!0),Pt=function(t){this.type=j,this.input=t};Pt.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found "+H(n.type)+" instead."):new Pt(n):null},Pt.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ot("Expected value to be of type string or array, but found "+H(it(e))+" instead.")},Pt.prototype.eachChild=function(t){t(this.input)},Pt.prototype.possibleOutputs=function(){return[void 0]},Pt.prototype.serialize=function(){var t=["length"];return this.eachChild((function(e){t.push(e.serialize())})),t};var Ot={"==":Dt,"!=":Lt,array:ut,at:At,boolean:st,case:It,coalesce:Ct,collator:et,interpolate:Et,length:Pt,let:Tt,literal:rt,match:Mt,number:st,object:st,step:xt,string:st,"to-color":ht,"to-number":ht,var:gt};function Rt(t,e){var n=e[0],i=e[1],r=e[2],o=e[3];n=n.evaluate(t),i=i.evaluate(t),r=r.evaluate(t);var a=o?o.evaluate(t):1,s=nt(n,i,r,a);if(s)throw new ot(s);return new Q(n/255*a,i/255*a,r/255*a,a)}function Bt(t,e){return t in e}function Ft(t,e){var n=e[t];return void 0===n?null:n}function Nt(t,e){var n=e[0],i=e[1];return n.evaluate(t)<i.evaluate(t)}function Vt(t,e){var n=e[0],i=e[1];return n.evaluate(t)>i.evaluate(t)}function jt(t,e){var n=e[0],i=e[1];return n.evaluate(t)<=i.evaluate(t)}function Ut(t,e){var n=e[0],i=e[1];return n.evaluate(t)>=i.evaluate(t)}function qt(t){return{type:t}}function $t(t){return{result:"success",value:t}}function Zt(t){return{result:"error",value:t}}dt.register(Ot,{error:[{kind:"error"},[U],function(t,e){var n=e[0];throw new ot(n.evaluate(t))}],typeof:[U,[G],function(t,e){return H(it(e[0].evaluate(t)))}],"to-string":[U,[G],function(t,e){var n=e[0],i=typeof(n=n.evaluate(t));return null===n?"":"string"===i||"number"===i||"boolean"===i?String(n):n instanceof Q?n.toString():JSON.stringify(n)}],"to-boolean":[q,[G],function(t,e){var n=e[0];return Boolean(n.evaluate(t))}],"to-rgba":[Y(j,4),[$],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[$,[j,j,j],Rt],rgba:[$,[j,j,j,j],Rt],has:{type:q,overloads:[[[U],function(t,e){return Bt(e[0].evaluate(t),t.properties())}],[[U,Z],function(t,e){var n=e[0],i=e[1];return Bt(n.evaluate(t),i.evaluate(t))}]]},get:{type:G,overloads:[[[U],function(t,e){return Ft(e[0].evaluate(t),t.properties())}],[[U,Z],function(t,e){var n=e[0],i=e[1];return Ft(n.evaluate(t),i.evaluate(t))}]]},properties:[Z,[],function(t){return t.properties()}],"geometry-type":[U,[],function(t){return t.geometryType()}],id:[G,[],function(t){return t.id()}],zoom:[j,[],function(t){return t.globals.zoom}],"heatmap-density":[j,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[j,[],function(t){return t.globals.lineProgress||0}],"+":[j,qt(j),function(t,e){for(var n=0,i=0,r=e;i<r.length;i+=1)n+=r[i].evaluate(t);return n}],"*":[j,qt(j),function(t,e){for(var n=1,i=0,r=e;i<r.length;i+=1)n*=r[i].evaluate(t);return n}],"-":{type:j,overloads:[[[j,j],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)-i.evaluate(t)}],[[j],function(t,e){return-e[0].evaluate(t)}]]},"/":[j,[j,j],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)/i.evaluate(t)}],"%":[j,[j,j],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)%i.evaluate(t)}],ln2:[j,[],function(){return Math.LN2}],pi:[j,[],function(){return Math.PI}],e:[j,[],function(){return Math.E}],"^":[j,[j,j],function(t,e){var n=e[0],i=e[1];return Math.pow(n.evaluate(t),i.evaluate(t))}],sqrt:[j,[j],function(t,e){var n=e[0];return Math.sqrt(n.evaluate(t))}],log10:[j,[j],function(t,e){var n=e[0];return Math.log10(n.evaluate(t))}],ln:[j,[j],function(t,e){var n=e[0];return Math.log(n.evaluate(t))}],log2:[j,[j],function(t,e){var n=e[0];return Math.log2(n.evaluate(t))}],sin:[j,[j],function(t,e){var n=e[0];return Math.sin(n.evaluate(t))}],cos:[j,[j],function(t,e){var n=e[0];return Math.cos(n.evaluate(t))}],tan:[j,[j],function(t,e){var n=e[0];return Math.tan(n.evaluate(t))}],asin:[j,[j],function(t,e){var n=e[0];return Math.asin(n.evaluate(t))}],acos:[j,[j],function(t,e){var n=e[0];return Math.acos(n.evaluate(t))}],atan:[j,[j],function(t,e){var n=e[0];return Math.atan(n.evaluate(t))}],min:[j,qt(j),function(t,e){return Math.min.apply(Math,e.map((function(e){return e.evaluate(t)})))}],max:[j,qt(j),function(t,e){return Math.max.apply(Math,e.map((function(e){return e.evaluate(t)})))}],abs:[j,[j],function(t,e){var n=e[0];return Math.abs(n.evaluate(t))}],round:[j,[j],function(t,e){var n=e[0].evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[j,[j],function(t,e){var n=e[0];return Math.floor(n.evaluate(t))}],ceil:[j,[j],function(t,e){var n=e[0];return Math.ceil(n.evaluate(t))}],"filter-==":[q,[U,G],function(t,e){var n=e[0],i=e[1];return t.properties()[n.value]===i.value}],"filter-id-==":[q,[G],function(t,e){var n=e[0];return t.id()===n.value}],"filter-type-==":[q,[U],function(t,e){var n=e[0];return t.geometryType()===n.value}],"filter-<":[q,[U,G],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r<o}],"filter-id-<":[q,[G],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i<r}],"filter->":[q,[U,G],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r>o}],"filter-id->":[q,[G],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i>r}],"filter-<=":[q,[U,G],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r<=o}],"filter-id-<=":[q,[G],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i<=r}],"filter->=":[q,[U,G],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r>=o}],"filter-id->=":[q,[G],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i>=r}],"filter-has":[q,[G],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[q,[],function(t){return null!==t.id()}],"filter-type-in":[q,[Y(U)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[q,[Y(G)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[q,[U,Y(G)],function(t,e){var n=e[0];return e[1].value.indexOf(t.properties()[n.value])>=0}],"filter-in-large":[q,[U,Y(G)],function(t,e){var n=e[0],i=e[1];return (function(t,e,n,i){for(;n<=i;){var r=n+i>>1;if(e[r]===t)return!0;e[r]>t?i=r-1:n=r+1}return!1})(t.properties()[n.value],i.value,0,i.value.length-1)}],">":{type:q,overloads:[[[j,j],Vt],[[U,U],Vt],[[U,U,W],function(t,e){var n=e[0],i=e[1];return e[2].evaluate(t).compare(n.evaluate(t),i.evaluate(t))>0}]]},"<":{type:q,overloads:[[[j,j],Nt],[[U,U],Nt],[[U,U,W],function(t,e){var n=e[0],i=e[1];return e[2].evaluate(t).compare(n.evaluate(t),i.evaluate(t))<0}]]},">=":{type:q,overloads:[[[j,j],Ut],[[U,U],Ut],[[U,U,W],function(t,e){var n=e[0],i=e[1];return e[2].evaluate(t).compare(n.evaluate(t),i.evaluate(t))>=0}]]},"<=":{type:q,overloads:[[[j,j],jt],[[U,U],jt],[[U,U,W],function(t,e){var n=e[0],i=e[1];return e[2].evaluate(t).compare(n.evaluate(t),i.evaluate(t))<=0}]]},all:{type:q,overloads:[[[q,q],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)&&i.evaluate(t)}],[qt(q),function(t,e){for(var n=0,i=e;n<i.length;n+=1)if(!i[n].evaluate(t))return!1;return!0}]]},any:{type:q,overloads:[[[q,q],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)||i.evaluate(t)}],[qt(q),function(t,e){for(var n=0,i=e;n<i.length;n+=1)if(i[n].evaluate(t))return!0;return!1}]]},"!":[q,[q],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[q,[U],function(t,e){var n=e[0],i=t.globals&&t.globals.isSupportedScript;return!i||i(n.evaluate(t))}],upcase:[U,[U],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[U,[U],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[U,qt(U),function(t,e){return e.map((function(e){return e.evaluate(t)})).join("")}],"resolved-locale":[U,[W],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var Gt=.95047,Wt=1,Yt=1.08883,Ht=4/29,Xt=6/29,Kt=3*Xt*Xt,Jt=Xt*Xt*Xt,Qt=Math.PI/180,te=180/Math.PI;function ee(t){return t>Jt?Math.pow(t,1/3):t/Kt+Ht}function ne(t){return t>Xt?t*t*t:Kt*(t-Ht)}function ie(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function re(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function oe(t){var e=re(t.r),n=re(t.g),i=re(t.b),r=ee((.4124564*e+.3575761*n+.1804375*i)/Gt),o=ee((.2126729*e+.7151522*n+.072175*i)/Wt);return{l:116*o-16,a:500*(r-o),b:200*(o-ee((.0193339*e+.119192*n+.9503041*i)/Yt)),alpha:t.a}}function ae(t){var e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=Wt*ne(e),n=Gt*ne(n),i=Yt*ne(i),new Q(ie(3.2404542*n-1.5371385*e-.4985314*i),ie(-.969266*n+1.8760108*e+.041556*i),ie(.0556434*n-.2040259*e+1.0572252*i),t.alpha)}var se={forward:oe,reverse:ae,interpolate:function(t,e,n){return{l:bt(t.l,e.l,n),a:bt(t.a,e.a,n),b:bt(t.b,e.b,n),alpha:bt(t.alpha,e.alpha,n)}}},le={forward:function(t){var e=oe(t),n=e.l,i=e.a,r=e.b,o=Math.atan2(r,i)*te;return{h:o<0?o+360:o,c:Math.sqrt(i*i+r*r),l:n,alpha:t.a}},reverse:function(t){var e=t.h*Qt,n=t.c;return ae({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:(function(t,e,n){var i=e-t;return t+n*(i>180||i<-180?i-360*Math.round(i/360):i)})(t.h,e.h,n),c:bt(t.c,e.c,n),l:bt(t.l,e.l,n),alpha:bt(t.alpha,e.alpha,n)}}},ue=Object.freeze({lab:se,hcl:le});function ce(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function he(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function pe(t){return t}function fe(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function de(t,e,n,i,r){return fe(typeof n===r?i[n]:void 0,t.default,e.default)}function me(t,e,n){if("number"!==ce(n))return fe(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];var r=ye(t.stops,n);return t.stops[r][1]}function ve(t,e,n){var i=void 0!==t.base?t.base:1;if("number"!==ce(n))return fe(t.default,e.default);var r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];var o=ye(t.stops,n),a=(function(t,e,n,i){var r=i-n,o=t-n;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)})(n,i,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],l=t.stops[o+1][1],u=wt[e.type]||pe;if(t.colorSpace&&"rgb"!==t.colorSpace){var c=ue[t.colorSpace];u=function(t,e){return c.reverse(c.interpolate(c.forward(t),c.forward(e),a))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=s.evaluate.apply(void 0,t),i=l.evaluate.apply(void 0,t);if(void 0!==n&&void 0!==i)return u(n,i,a)}}:u(s,l,a)}function ge(t,e,n){return"color"===e.type?n=Q.parse(n):ce(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),fe(n,t.default,e.default)}function ye(t,e){for(var n,i,r=0,o=t.length-1,a=0;r<=o;){if(n=t[a=Math.floor((r+o)/2)][0],i=t[a+1][0],e===n||e>n&&e<i)return a;n<e?r=a+1:n>e&&(o=a-1)}return Math.max(a-1,0)}var _e=function(t,e){var n;this.expression=t,this._warningHistory={},this._defaultValue="color"===(n=e).type&&he(n.default)?new Q(0,0,0,0):"color"===n.type?Q.parse(n.default)||null:void 0===n.default?null:n.default,"enum"===e.type&&(this._enumValues=e.values)};function xe(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Ot}function be(t,e){var n=new yt(Ot,[],(function(t){var e={color:$,string:U,number:j,enum:U,boolean:q};return"array"===t.type?Y(e[t.value]||G,t.length):e[t.type]||null})(e)),i=n.parse(t);return i?$t(new _e(i,e)):Zt(n.errors)}_e.prototype.evaluateWithoutErrorHandling=function(t,e){return this._evaluator||(this._evaluator=new ft),this._evaluator.globals=t,this._evaluator.feature=e,this.expression.evaluate(this._evaluator)},_e.prototype.evaluate=function(t,e){this._evaluator||(this._evaluator=new ft),this._evaluator.globals=t,this._evaluator.feature=e;try{var n=this.expression.evaluate(this._evaluator);if(null==n)return this._defaultValue;if(this._enumValues&&!(n in this._enumValues))throw new ot("Expected value to be one of "+Object.keys(this._enumValues).map((function(t){return JSON.stringify(t)})).join(", ")+", but found "+JSON.stringify(n)+" instead.");return n}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var we=function(t,e){this.kind=t,this._styleExpression=e};we.prototype.evaluateWithoutErrorHandling=function(t,e){return this._styleExpression.evaluateWithoutErrorHandling(t,e)},we.prototype.evaluate=function(t,e){return this._styleExpression.evaluate(t,e)};var Ee=function(t,e,n){this.kind=t,this.zoomStops=n.labels,this._styleExpression=e,n instanceof Et&&(this._interpolationType=n.interpolation)};function Se(t,e){if("error"===(t=be(t,e)).result)return t;var n=t.value.expression,i=mt(n);if(!i&&!e["property-function"])return Zt([new F("","property expressions not supported")]);var r=vt(n,["zoom"]);if(!r&&!1===e["zoom-function"])return Zt([new F("","zoom expressions not supported")]);var o=(function t(e){var n=null;if(e instanceof Tt)n=t(e.result);else if(e instanceof Ct)for(var i=0,r=e.args;i<r.length;i+=1){var o=r[i];if(n=t(o))break}else(e instanceof xt||e instanceof Et)&&e.input instanceof dt&&"zoom"===e.input.name&&(n=e);return n instanceof F?n:(e.eachChild((function(e){var i=t(e);i instanceof F?n=i:!n&&i?n=new F("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&i&&n!==i&&(n=new F("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n)})(n);return o||r?o instanceof F?Zt([o]):o instanceof Et&&"piecewise-constant"===e.function?Zt([new F("",'"interpolate" expressions cannot be used with this property')]):$t(o?new Ee(i?"camera":"composite",t.value,o):new we(i?"constant":"source",t.value)):Zt([new F("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Ee.prototype.evaluateWithoutErrorHandling=function(t,e){return this._styleExpression.evaluateWithoutErrorHandling(t,e)},Ee.prototype.evaluate=function(t,e){return this._styleExpression.evaluate(t,e)},Ee.prototype.interpolationFactor=function(t,e,n){return this._interpolationType?Et.interpolationFactor(this._interpolationType,t,e,n):0};var Ce=function(t,e){this._parameters=t,this._specification=e,O(this,(function t(e,n){var i,r,o,a="color"===n.type,s=e.stops&&"object"==typeof e.stops[0][0],l=s||void 0!==e.property,u=s||!l,c=e.type||("interpolated"===n.function?"exponential":"interval");if(a&&((e=O({},e)).stops&&(e.stops=e.stops.map((function(t){return[t[0],Q.parse(t[1])]}))),e.default?e.default=Q.parse(e.default):e.default=Q.parse(n.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!ue[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===c)i=ve;else if("interval"===c)i=me;else if("categorical"===c){i=de,r=Object.create(null);for(var h=0,p=e.stops;h<p.length;h+=1){var f=p[h];r[f[0]]=f[1]}o=typeof e.stops[0][0]}else{if("identity"!==c)throw new Error('Unknown function type "'+c+'"');i=ge}if(s){for(var d={},m=[],v=0;v<e.stops.length;v++){var g=e.stops[v],y=g[0].zoom;void 0===d[y]&&(d[y]={zoom:y,type:e.type,property:e.property,default:e.default,stops:[]},m.push(y)),d[y].stops.push([g[0].value,g[1]])}for(var _=[],x=0,b=m;x<b.length;x+=1){var w=b[x];_.push([d[w].zoom,t(d[w],n)])}return{kind:"composite",interpolationFactor:Et.interpolationFactor.bind(void 0,{name:"linear"}),zoomStops:_.map((function(t){return t[0]})),evaluate:function(t,i){var r=t.zoom;return ve({stops:_,base:e.base},n,r).evaluate(r,i)}}}return u?{kind:"camera",interpolationFactor:"exponential"===c?Et.interpolationFactor.bind(void 0,{name:"exponential",base:void 0!==e.base?e.base:1}):function(){return 0},zoomStops:e.stops.map((function(t){return t[0]})),evaluate:function(t){var a=t.zoom;return i(e,n,a,r,o)}}:{kind:"source",evaluate:function(t,a){var s=a&&a.properties?a.properties[e.property]:void 0;return void 0===s?fe(e.default,n.default):i(e,n,s,r,o)}}})(this._parameters,this._specification))};function Te(t,e){if(he(t))return new Ce(t,e);if(xe(t)){var n=Se(t,e);if("error"===n.result)throw new Error(n.value.map((function(t){return t.key+": "+t.message})).join(", "));return n.value}var i=t;return"string"==typeof t&&"color"===e.type&&(i=Q.parse(t)),{kind:"constant",evaluate:function(){return i}}}function Ae(t){var e=t.key,n=t.value,i=t.valueSpec||{},r=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=[],l=ce(n);if("object"!==l)return[new L(e,n,"object expected, "+l+" found")];for(var u in n){var c=u.split(".")[0],h=i[c]||i["*"],p=void 0;if(r[c])p=r[c];else if(i[c])p=Ke;else if(r["*"])p=r["*"];else{if(!i["*"]){s.push(new L(e,n[u],'unknown property "'+u+'"'));continue}p=Ke}s=s.concat(p({key:(e?e+".":e)+u,value:n[u],valueSpec:h,style:o,styleSpec:a,object:n,objectKey:u},n))}for(var f in i)r[f]||i[f].required&&void 0===i[f].default&&void 0===n[f]&&s.push(new L(e,n,'missing required property "'+f+'"'));return s}function Me(t){var e=t.value,n=t.valueSpec,i=t.style,r=t.styleSpec,o=t.key,a=t.arrayElementValidator||Ke;if("array"!==ce(e))return[new L(o,e,"array expected, "+ce(e)+" found")];if(n.length&&e.length!==n.length)return[new L(o,e,"array length "+n.length+" expected, length "+e.length+" found")];if(n["min-length"]&&e.length<n["min-length"])return[new L(o,e,"array length at least "+n["min-length"]+" expected, length "+e.length+" found")];var s={type:n.value};r.$version<7&&(s.function=n.function),"object"===ce(n.value)&&(s=n.value);for(var l=[],u=0;u<e.length;u++)l=l.concat(a({array:e,arrayIndex:u,value:e[u],valueSpec:s,style:i,styleSpec:r,key:o+"["+u+"]"}));return l}function Ie(t){var e=t.key,n=t.value,i=t.valueSpec,r=ce(n);return"number"!==r?[new L(e,n,"number expected, "+r+" found")]:"minimum"in i&&n<i.minimum?[new L(e,n,n+" is less than the minimum value "+i.minimum)]:"maximum"in i&&n>i.maximum?[new L(e,n,n+" is greater than the maximum value "+i.maximum)]:[]}function ke(t){var e,n,i,r=t.valueSpec,o=R(t.value.type),a={},s="categorical"!==o&&void 0===t.value.property,l=!s,u="array"===ce(t.value.stops)&&"array"===ce(t.value.stops[0])&&"object"===ce(t.value.stops[0][0]),c=Ae({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===o)return[new L(t.key,t.value,'identity function may not have a "stops" property')];var e=[],n=t.value;return e=e.concat(Me({key:t.key,value:n,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===ce(n)&&0===n.length&&e.push(new L(t.key,n,"array must have at least one stop")),e},default:function(t){return Ke({key:t.key,value:t.value,valueSpec:r,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===o&&s&&c.push(new L(t.key,t.value,'missing required property "property"')),"identity"===o||t.value.stops||c.push(new L(t.key,t.value,'missing required property "stops"')),"exponential"===o&&"piecewise-constant"===t.valueSpec.function&&c.push(new L(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!t.valueSpec["property-function"]?c.push(new L(t.key,t.value,"property functions not supported")):s&&!t.valueSpec["zoom-function"]&&"heatmap-color"!==t.objectKey&&"line-gradient"!==t.objectKey&&c.push(new L(t.key,t.value,"zoom functions not supported"))),"categorical"!==o&&!u||void 0!==t.value.property||c.push(new L(t.key,t.value,'"property" property is required')),c;function h(t){var e=[],o=t.value,s=t.key;if("array"!==ce(o))return[new L(s,o,"array expected, "+ce(o)+" found")];if(2!==o.length)return[new L(s,o,"array length 2 expected, length "+o.length+" found")];if(u){if("object"!==ce(o[0]))return[new L(s,o,"object expected, "+ce(o[0])+" found")];if(void 0===o[0].zoom)return[new L(s,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new L(s,o,"object stop key must have value")];if(i&&i>R(o[0].zoom))return[new L(s,o[0].zoom,"stop zoom values must appear in ascending order")];R(o[0].zoom)!==i&&(i=R(o[0].zoom),n=void 0,a={}),e=e.concat(Ae({key:s+"[0]",value:o[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Ie,value:p}}))}else e=e.concat(p({key:s+"[0]",value:o[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},o));return e.concat(Ke({key:s+"[1]",value:o[1],valueSpec:r,style:t.style,styleSpec:t.styleSpec}))}function p(t,i){var s=ce(t.value),l=R(t.value),u=null!==t.value?t.value:i;if(e){if(s!==e)return[new L(t.key,u,s+" stop domain type must match previous stop domain type "+e)]}else e=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new L(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==o){var c="number expected, "+s+" found";return r["property-function"]&&void 0===o&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new L(t.key,u,c)]}return"categorical"!==o||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==o&&"number"===s&&void 0!==n&&l<n?[new L(t.key,u,"stop domain values must appear in ascending order")]:(n=l,"categorical"===o&&l in a?[new L(t.key,u,"stop domain values must be unique")]:(a[l]=!0,[])):[new L(t.key,u,"integer expected, found "+l)]}}function ze(t){var e=("property"===t.expressionContext?Se:be)(B(t.value),t.valueSpec);return"error"===e.result?e.value.map((function(e){return new L(""+t.key+e.key,t.value,e.message)})):"property"===t.expressionContext&&"text-font"===t.propertyKey&&-1!==e.value._styleExpression.expression.possibleOutputs().indexOf(void 0)?[new L(t.key,t.value,'Invalid data expression for "text-font". Output values must be contained as literals within the expression.')]:[]}function De(t){var e=t.key,n=t.value,i=t.valueSpec,r=[];return Array.isArray(i.values)?-1===i.values.indexOf(R(n))&&r.push(new L(e,n,"expected one of ["+i.values.join(", ")+"], "+JSON.stringify(n)+" found")):-1===Object.keys(i.values).indexOf(R(n))&&r.push(new L(e,n,"expected one of ["+Object.keys(i.values).join(", ")+"], "+JSON.stringify(n)+" found")),r}function Le(t){if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3===t.length&&(Array.isArray(t[1])||Array.isArray(t[2]));case"any":case"all":for(var e=0,n=t.slice(1);e<n.length;e+=1){var i=n[e];if(!Le(i)&&"boolean"!=typeof i)return!1}return!0;default:return!0}}Ce.deserialize=function(t){return new Ce(t._parameters,t._specification)},Ce.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var Pe={type:"boolean",default:!1,function:!0,"property-function":!0,"zoom-function":!0};function Oe(t){if(!t)return function(){return!0};Le(t)||(t=Be(t));var e=be(t,Pe);if("error"===e.result)throw new Error(e.value.map((function(t){return t.key+": "+t.message})).join(", "));return function(t,n){return e.value.evaluate(t,n)}}function Re(t,e){return t<e?-1:t>e?1:0}function Be(t){if(!t)return!0;var e,n=t[0];return t.length<=1?"any"!==n:"=="===n?Fe(t[1],t[2],"=="):"!="===n?je(Fe(t[1],t[2],"==")):"<"===n||">"===n||"<="===n||">="===n?Fe(t[1],t[2],n):"any"===n?(e=t.slice(1),["any"].concat(e.map(Be))):"all"===n?["all"].concat(t.slice(1).map(Be)):"none"===n?["all"].concat(t.slice(1).map(Be).map(je)):"in"===n?Ne(t[1],t.slice(2)):"!in"===n?je(Ne(t[1],t.slice(2))):"has"===n?Ve(t[1]):"!has"!==n||je(Ve(t[1]))}function Fe(t,e,n){switch(t){case"$type":return["filter-type-"+n,e];case"$id":return["filter-id-"+n,e];default:return["filter-"+n,t,e]}}function Ne(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((function(t){return typeof t!=typeof e[0]}))?["filter-in-large",t,["literal",e.sort(Re)]]:["filter-in-small",t,["literal",e]]}}function Ve(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function je(t){return["!",t]}function Ue(t){return Le(B(t.value))?ze(O({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):(function t(e){var n=e.value,i=e.key;if("array"!==ce(n))return[new L(i,n,"array expected, "+ce(n)+" found")];var r,o=e.styleSpec,a=[];if(n.length<1)return[new L(i,n,"filter array must have at least 1 element")];switch(a=a.concat(De({key:i+"[0]",value:n[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),R(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===R(n[1])&&a.push(new L(i,n,'"$type" cannot be use with operator "'+n[0]+'"'));case"==":case"!=":3!==n.length&&a.push(new L(i,n,'filter array for operator "'+n[0]+'" must have 3 elements'));case"in":case"!in":n.length>=2&&"string"!==(r=ce(n[1]))&&a.push(new L(i+"[1]",n[1],"string expected, "+r+" found"));for(var s=2;s<n.length;s++)r=ce(n[s]),"$type"===R(n[1])?a=a.concat(De({key:i+"["+s+"]",value:n[s],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&a.push(new L(i+"["+s+"]",n[s],"string, number, or boolean expected, "+r+" found"));break;case"any":case"all":case"none":for(var l=1;l<n.length;l++)a=a.concat(t({key:i+"["+l+"]",value:n[l],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":r=ce(n[1]),2!==n.length?a.push(new L(i,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"string"!==r&&a.push(new L(i+"[1]",n[1],"string expected, "+r+" found"))}return a})(t)}function qe(t,e){var n=t.key,i=t.style,r=t.styleSpec,o=t.value,a=t.objectKey,s=r[e+"_"+t.layerType];if(!s)return[];var l=a.match(/^(.*)-transition$/);if("paint"===e&&l&&s[l[1]]&&s[l[1]].transition)return Ke({key:n,value:o,valueSpec:r.transition,style:i,styleSpec:r});var u,c=t.valueSpec||s[a];if(!c)return[new L(n,o,'unknown property "'+a+'"')];if("string"===ce(o)&&c["property-function"]&&!c.tokens&&(u=/^{([^}]+)}$/.exec(o)))return[new L(n,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(u[1])+" }`.")];var h=[];return"symbol"===t.layerType&&("text-field"===a&&i&&!i.glyphs&&h.push(new L(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&he(B(o))&&"identity"===R(o.type)&&h.push(new L(n,o,'"text-font" does not support identity functions'))),h.concat(Ke({key:t.key,value:o,valueSpec:c,style:i,styleSpec:r,expressionContext:"property",propertyKey:a}))}function $e(t){return qe(t,"paint")}function Ze(t){return qe(t,"layout")}function Ge(t){var e=[],n=t.value,i=t.key,r=t.style,o=t.styleSpec;n.type||n.ref||e.push(new L(i,n,'either "type" or "ref" is required'));var a,s=R(n.type),l=R(n.ref);if(n.id)for(var u=R(n.id),c=0;c<t.arrayIndex;c++){var h=r.layers[c];R(h.id)===u&&e.push(new L(i,n.id,'duplicate layer id "'+n.id+'", previously used at line '+h.id.__line__))}if("ref"in n)["type","source","source-layer","filter","layout"].forEach((function(t){t in n&&e.push(new L(i,n[t],'"'+t+'" is prohibited for ref layers'))})),r.layers.forEach((function(t){R(t.id)===l&&(a=t)})),a?a.ref?e.push(new L(i,n.ref,"ref cannot reference another ref layer")):s=R(a.type):e.push(new L(i,n.ref,'ref layer "'+l+'" not found'));else if("background"!==s)if(n.source){var p=r.sources&&r.sources[n.source],f=p&&R(p.type);p?"vector"===f&&"raster"===s?e.push(new L(i,n.source,'layer "'+n.id+'" requires a raster source')):"raster"===f&&"raster"!==s?e.push(new L(i,n.source,'layer "'+n.id+'" requires a vector source')):"vector"!==f||n["source-layer"]?"raster-dem"===f&&"hillshade"!==s?e.push(new L(i,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]||"geojson"===f&&p.lineMetrics||e.push(new L(i,n,'layer "'+n.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new L(i,n,'layer "'+n.id+'" must specify a "source-layer"')):e.push(new L(i,n.source,'source "'+n.source+'" not found'))}else e.push(new L(i,n,'missing required property "source"'));return e=e.concat(Ae({key:i,value:n,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ke({key:i+".type",value:n.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"})},filter:Ue,layout:function(t){return Ae({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return Ze(O({layerType:s},t))}}})},paint:function(t){return Ae({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return $e(O({layerType:s},t))}}})}}}))}function We(t){var e=t.value,n=t.key,i=t.styleSpec,r=t.style;if(!e.type)return[new L(n,e,'"type" is required')];var o=R(e.type),a=[];switch(o){case"vector":case"raster":case"raster-dem":if(a=a.concat(Ae({key:n,value:e,valueSpec:i["source_"+o.replace("-","_")],style:t.style,styleSpec:i})),"url"in e)for(var s in e)["type","url","tileSize"].indexOf(s)<0&&a.push(new L(n+"."+s,e[s],'a source with a "url" property may not include a "'+s+'" property'));return a;case"geojson":return Ae({key:n,value:e,valueSpec:i.source_geojson,style:r,styleSpec:i});case"video":return Ae({key:n,value:e,valueSpec:i.source_video,style:r,styleSpec:i});case"image":return Ae({key:n,value:e,valueSpec:i.source_image,style:r,styleSpec:i});case"canvas":return a.push(new L(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")),a;default:return De({key:n+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:r,styleSpec:i})}}function Ye(t){var e=t.value,n=t.styleSpec,i=n.light,r=t.style,o=[],a=ce(e);if(void 0===e)return o;if("object"!==a)return o.concat([new L("light",e,"object expected, "+a+" found")]);for(var s in e){var l=s.match(/^(.*)-transition$/);o=l&&i[l[1]]&&i[l[1]].transition?o.concat(Ke({key:s,value:e[s],valueSpec:n.transition,style:r,styleSpec:n})):i[s]?o.concat(Ke({key:s,value:e[s],valueSpec:i[s],style:r,styleSpec:n})):o.concat([new L(s,e[s],'unknown property "'+s+'"')])}return o}function He(t){var e=t.value,n=t.key,i=ce(e);return"string"!==i?[new L(n,e,"string expected, "+i+" found")]:[]}var Xe={"*":function(){return[]},array:Me,boolean:function(t){var e=t.value,n=t.key,i=ce(e);return"boolean"!==i?[new L(n,e,"boolean expected, "+i+" found")]:[]},number:Ie,color:function(t){var e=t.key,n=t.value,i=ce(n);return"string"!==i?[new L(e,n,"color expected, "+i+" found")]:null===J(n)?[new L(e,n,'color expected, "'+n+'" found')]:[]},constants:P,enum:De,filter:Ue,function:ke,layer:Ge,object:Ae,source:We,light:Ye,string:He};function Ke(t){var e=t.value,n=t.valueSpec,i=t.styleSpec;return n.function&&he(R(e))?ke(t):n.function&&xe(B(e))?ze(t):n.type&&Xe[n.type]?Xe[n.type](t):Ae(O({},t,{valueSpec:n.type?i[n.type]:n}))}function Je(t){var e=t.value,n=t.key,i=He(t);return i.length?i:(-1===e.indexOf("{fontstack}")&&i.push(new L(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&i.push(new L(n,e,'"glyphs" url must include a "{range}" token')),i)}function Qe(t,e){e=e||D;var n=[];return n=n.concat(Ke({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Je,"*":function(){return[]}}})),t.constants&&(n=n.concat(P({key:"constants",value:t.constants,style:t,styleSpec:e}))),tn(n)}function tn(t){return[].concat(t).sort((function(t,e){return t.line-e.line}))}function en(t){return function(){return tn(t.apply(this,arguments))}}Qe.source=en(We),Qe.light=en(Ye),Qe.layer=en(Ge),Qe.filter=en(Ue),Qe.paintProperty=en($e),Qe.layoutProperty=en(Ze);var nn=Qe,rn=Qe.light,on=Qe.paintProperty,an=Qe.layoutProperty;function sn(t,e){var n=!1;if(e&&e.length)for(var i=0,r=e;i<r.length;i+=1){var o=r[i];t.fire(new k(new Error(o.message))),n=!0}return n}var ln=cn,un=3;function cn(t,e,n){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var r=new Int32Array(this.arrayBuffer);t=r[0],e=r[1],n=r[2],this.d=e+2*n;for(var o=0;o<this.d*this.d;o++){var a=r[un+o],s=r[un+o+1];i.push(a===s?null:r.subarray(a,s))}var l=r[un+i.length],u=r[un+i.length+1];this.keys=r.subarray(l,u),this.bboxes=r.subarray(u),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var c=0;c<this.d*this.d;c++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var h=n/e*t;this.min=-h,this.max=t+h}cn.prototype.insert=function(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)},cn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},cn.prototype._insertCell=function(t,e,n,i,r,o){this.cells[r].push(o)},cn.prototype.query=function(t,e,n,i){var r=this.min,o=this.max;if(t<=r&&e<=r&&o<=n&&o<=i)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(t,e,n,i,this._queryCell,a,{}),a},cn.prototype._queryCell=function(t,e,n,i,r,o,a){var s=this.cells[r];if(null!==s)for(var l=this.keys,u=this.bboxes,c=0;c<s.length;c++){var h=s[c];if(void 0===a[h]){var p=4*h;t<=u[p+2]&&e<=u[p+3]&&n>=u[p+0]&&i>=u[p+1]?(a[h]=!0,o.push(l[h])):a[h]=!1}}},cn.prototype._forEachCell=function(t,e,n,i,r,o,a){for(var s=this._convertToCellCoord(t),l=this._convertToCellCoord(e),u=this._convertToCellCoord(n),c=this._convertToCellCoord(i),h=s;h<=u;h++)for(var p=l;p<=c;p++){var f=this.d*p+h;if(r.call(this,t,e,n,i,f,o,a))return}},cn.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},cn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=un+this.cells.length+1+1,n=0,i=0;i<this.cells.length;i++)n+=this.cells[i].length;var r=new Int32Array(e+n+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];r[un+a]=o,r.set(s,o),o+=s.length}return r[un+t.length]=o,r.set(this.keys,o),o+=this.keys.length,r[un+t.length+1]=o,r.set(this.bboxes,o),o+=this.bboxes.length,r.buffer};var hn=self.ImageData,pn={};function fn(t,e,n){void 0===n&&(n={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),pn[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}for(var dn in fn("Object",Object),ln.serialize=function(t,e){var n=t.toArrayBuffer();return e&&e.push(n),n},ln.deserialize=function(t){return new ln(t)},fn("Grid",ln),fn("Color",Q),fn("Error",Error),fn("StylePropertyFunction",Ce),fn("StyleExpression",_e,{omit:["_evaluator"]}),fn("ZoomDependentExpression",Ee),fn("ZoomConstantExpression",we),fn("CompoundExpression",dt,{omit:["_evaluate"]}),Ot)Ot[dn]._classRegistryKey||fn("Expression_"+dn,Ot[dn]);function mn(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(t instanceof ArrayBuffer)return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var n=t;return e&&e.push(n.buffer),n}if(t instanceof hn)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var i=[],r=0,o=t;r<o.length;r+=1){var a=o[r];i.push(mn(a,e))}return i}if("object"==typeof t){var s=t.constructor,l=s._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");var u={};if(s.serialize)u._serialized=s.serialize(t,e);else{for(var c in t)if(t.hasOwnProperty(c)&&!(pn[l].omit.indexOf(c)>=0)){var h=t[c];u[c]=pn[l].shallow.indexOf(c)>=0?h:mn(h,e)}t instanceof Error&&(u.message=t.message)}return{name:l,properties:u}}throw new Error("can't serialize object of type "+typeof t)}function vn(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof ArrayBuffer||ArrayBuffer.isView(t)||t instanceof hn)return t;if(Array.isArray(t))return t.map((function(t){return vn(t)}));if("object"==typeof t){var e=t,n=e.name,i=e.properties;if(!n)throw new Error("can't deserialize object of anonymous class");var r=pn[n].klass;if(!r)throw new Error("can't deserialize unregistered class "+n);if(r.deserialize)return r.deserialize(i._serialized);for(var o=Object.create(r.prototype),a=0,s=Object.keys(i);a<s.length;a+=1){var l=s[a];o[l]=pn[n].shallow.indexOf(l)>=0?i[l]:vn(i[l])}return o}throw new Error("can't deserialize object of type "+typeof t)}var gn=function(){this.first=!0};gn.prototype.update=function(t,e){var n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))};var yn={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function _n(t){for(var e=0,n=t;e<n.length;e+=1)if(bn(n[e].charCodeAt(0)))return!0;return!1}function xn(t){return!(yn.Arabic(t)||yn["Arabic Supplement"](t)||yn["Arabic Extended-A"](t)||yn["Arabic Presentation Forms-A"](t)||yn["Arabic Presentation Forms-B"](t))}function bn(t){return!!(746===t||747===t||!(t<4352)&&(yn["Bopomofo Extended"](t)||yn.Bopomofo(t)||yn["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||yn["CJK Compatibility Ideographs"](t)||yn["CJK Compatibility"](t)||yn["CJK Radicals Supplement"](t)||yn["CJK Strokes"](t)||!(!yn["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||yn["CJK Unified Ideographs Extension A"](t)||yn["CJK Unified Ideographs"](t)||yn["Enclosed CJK Letters and Months"](t)||yn["Hangul Compatibility Jamo"](t)||yn["Hangul Jamo Extended-A"](t)||yn["Hangul Jamo Extended-B"](t)||yn["Hangul Jamo"](t)||yn["Hangul Syllables"](t)||yn.Hiragana(t)||yn["Ideographic Description Characters"](t)||yn.Kanbun(t)||yn["Kangxi Radicals"](t)||yn["Katakana Phonetic Extensions"](t)||yn.Katakana(t)&&12540!==t||!(!yn["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!yn["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||yn["Unified Canadian Aboriginal Syllabics"](t)||yn["Unified Canadian Aboriginal Syllabics Extended"](t)||yn["Vertical Forms"](t)||yn["Yijing Hexagram Symbols"](t)||yn["Yi Syllables"](t)||yn["Yi Radicals"](t)))}function wn(t){return!(bn(t)||(function(t){return!!(yn["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||yn["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||yn["Letterlike Symbols"](t)||yn["Number Forms"](t)||yn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||yn["Control Pictures"](t)&&9251!==t||yn["Optical Character Recognition"](t)||yn["Enclosed Alphanumerics"](t)||yn["Geometric Shapes"](t)||yn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||yn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||yn["CJK Symbols and Punctuation"](t)||yn.Katakana(t)||yn["Private Use Area"](t)||yn["CJK Compatibility Forms"](t)||yn["Small Form Variants"](t)||yn["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)})(t))}function En(t,e){return!(!e&&(t>=1424&&t<=2303||yn["Arabic Presentation Forms-A"](t)||yn["Arabic Presentation Forms-B"](t))||t>=2304&&t<=3583||t>=3840&&t<=4255||yn.Khmer(t))}var Sn,Cn=!1,Tn=null,An=!1,Mn=new z,In={applyArabicShaping:null,processBidirectionalText:null,isLoaded:function(){return An||null!=In.applyArabicShaping}},kn=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new gn,this.transition={})};kn.prototype.isSupportedScript=function(t){return (function(t,e){for(var n=0,i=t;n<i.length;n+=1)if(!En(i[n].charCodeAt(0),e))return!1;return!0})(t,In.isLoaded())},kn.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)};var zn=function(t,e){this.property=t,this.value=e,this.expression=Te(void 0===e?t.specification.default:e,t.specification)};zn.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},zn.prototype.possiblyEvaluate=function(t){return this.property.possiblyEvaluate(this,t)};var Dn=function(t){this.property=t,this.value=new zn(t,void 0)};Dn.prototype.transitioned=function(t,e){return new Pn(this.property,this.value,e,p({},t.transition,this.transition),t.now)},Dn.prototype.untransitioned=function(){return new Pn(this.property,this.value,null,{},0)};var Ln=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Ln.prototype.getValue=function(t){return y(this._values[t].value.value)},Ln.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Dn(this._values[t].property)),this._values[t].value=new zn(this._values[t].property,null===e?void 0:y(e))},Ln.prototype.getTransition=function(t){return y(this._values[t].transition)},Ln.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Dn(this._values[t].property)),this._values[t].transition=y(e)||void 0},Ln.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var i=n[e],r=this.getValue(i);void 0!==r&&(t[i]=r);var o=this.getTransition(i);void 0!==o&&(t[i+"-transition"]=o)}return t},Ln.prototype.transitioned=function(t,e){for(var n=new On(this._properties),i=0,r=Object.keys(this._values);i<r.length;i+=1){var o=r[i];n._values[o]=this._values[o].transitioned(t,e._values[o])}return n},Ln.prototype.untransitioned=function(){for(var t=new On(this._properties),e=0,n=Object.keys(this._values);e<n.length;e+=1){var i=n[e];t._values[i]=this._values[i].untransitioned()}return t};var Pn=function(t,e,n,i,r){this.property=t,this.value=e,this.begin=r+i.delay||0,this.end=this.begin+i.duration||0,t.specification.transition&&(i.delay||i.duration)&&(this.prior=n)};Pn.prototype.possiblyEvaluate=function(t){var e=t.now||0,n=this.value.possiblyEvaluate(t),i=this.prior;if(i){if(e>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(e<this.begin)return i.possiblyEvaluate(t);var r=(e-this.begin)/(this.end-this.begin);return this.property.interpolate(i.possiblyEvaluate(t),n,(function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)})(r))}return n};var On=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};On.prototype.possiblyEvaluate=function(t){for(var e=new Fn(this._properties),n=0,i=Object.keys(this._values);n<i.length;n+=1){var r=i[n];e._values[r]=this._values[r].possiblyEvaluate(t)}return e},On.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1){var n=e[t];if(this._values[n].prior)return!0}return!1};var Rn=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};Rn.prototype.getValue=function(t){return y(this._values[t].value)},Rn.prototype.setValue=function(t,e){this._values[t]=new zn(this._values[t].property,null===e?void 0:y(e))},Rn.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var i=n[e],r=this.getValue(i);void 0!==r&&(t[i]=r)}return t},Rn.prototype.possiblyEvaluate=function(t){for(var e=new Fn(this._properties),n=0,i=Object.keys(this._values);n<i.length;n+=1){var r=i[n];e._values[r]=this._values[r].possiblyEvaluate(t)}return e};var Bn=function(t,e,n){this.property=t,this.value=e,this.globals=n};Bn.prototype.isConstant=function(){return"constant"===this.value.kind},Bn.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},Bn.prototype.evaluate=function(t){return this.property.evaluate(this.value,this.globals,t)};var Fn=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Fn.prototype.get=function(t){return this._values[t]};var Nn=function(t){this.specification=t};Nn.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},Nn.prototype.interpolate=function(t,e,n){var i=wt[this.specification.type];return i?i(t,e,n):t};var Vn=function(t){this.specification=t};Vn.prototype.possiblyEvaluate=function(t,e){return"constant"===t.expression.kind||"camera"===t.expression.kind?new Bn(this,{kind:"constant",value:t.expression.evaluate(e)},e):new Bn(this,t.expression,e)},Vn.prototype.interpolate=function(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new Bn(this,{kind:"constant",value:void 0},t.globals);var i=wt[this.specification.type];return i?new Bn(this,{kind:"constant",value:i(t.value.value,e.value.value,n)},t.globals):t},Vn.prototype.evaluate=function(t,e,n){return"constant"===t.kind?t.value:t.evaluate(e,n)};var jn=function(t){this.specification=t};jn.prototype.possiblyEvaluate=function(t,e){if(void 0!==t.value){if("constant"===t.expression.kind){var n=t.expression.evaluate(e);return this._calculate(n,n,n,e)}return this._calculate(t.expression.evaluate(new kn(Math.floor(e.zoom-1),e)),t.expression.evaluate(new kn(Math.floor(e.zoom),e)),t.expression.evaluate(new kn(Math.floor(e.zoom+1),e)),e)}},jn.prototype._calculate=function(t,e,n,i){var r=i.zoom,o=r-Math.floor(r),a=i.crossFadingFactor();return r>i.zoomHistory.lastIntegerZoom?{from:t,to:e,fromScale:2,toScale:1,t:o+(1-o)*a}:{from:n,to:e,fromScale:.5,toScale:1,t:1-(1-a)*o}},jn.prototype.interpolate=function(t){return t};var Un=function(t){this.specification=t};Un.prototype.possiblyEvaluate=function(t,e){return!!t.expression.evaluate(e)},Un.prototype.interpolate=function(){return!1};var qn=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},t){var n=t[e],i=this.defaultPropertyValues[e]=new zn(n,void 0),r=this.defaultTransitionablePropertyValues[e]=new Dn(n);this.defaultTransitioningPropertyValues[e]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=i.possiblyEvaluate({})}};fn("DataDrivenProperty",Vn),fn("DataConstantProperty",Nn),fn("CrossFadedProperty",jn),fn("ColorRampProperty",Un);var $n=(function(t){function e(e,n){for(var i in t.call(this),this.id=e.id,this.metadata=e.metadata,this.type=e.type,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,this.visibility="visible","background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),this._featureFilter=function(){return!0},n.layout&&(this._unevaluatedLayout=new Rn(n.layout)),this._transitionablePaint=new Ln(n.paint),e.paint)this.setPaintProperty(i,e.paint[i],{validate:!1});for(var r in e.layout)this.setLayoutProperty(r,e.layout[r],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,n){if(null!=e){var i="layers."+this.id+".layout."+t;if(this._validate(an,i,t,e,n))return}"visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility="none"===e?e:"visible"},e.prototype.getPaintProperty=function(t){return m(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,n){if(null!=e){var i="layers."+this.id+".paint."+t;if(this._validate(on,i,t,e,n))return}m(t,"-transition")?this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0):this._transitionablePaint.setValue(t,e)},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t)),this.paint=this._transitioningPaint.possiblyEvaluate(t)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return"none"===this.visibility&&(t.layout=t.layout||{},t.layout.visibility="none"),g(t,(function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)}))},e.prototype._validate=function(t,e,n,i,r){return(!r||!1!==r.validate)&&sn(this,t.call(nn,{key:e,layerType:this.type,objectKey:n,value:i,styleSpec:D,style:{glyphs:!0,sprite:!0}}))},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e})(z),Zn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Gn=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Wn=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Yn(t,e){void 0===e&&(e=1);var n=0,i=0;return{members:t.map((function(t){var r,o=(r=t.type,Zn[r].BYTES_PER_ELEMENT),a=n=Hn(n,Math.max(e,o)),s=t.components||1;return i=Math.max(i,o),n+=o*s,{name:t.name,type:t.type,components:s,offset:a}})),size:Hn(n,Math.max(i,e)),alignment:e}}function Hn(t,e){return Math.ceil(t/e)*e}Wn.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Wn.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},Wn.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Wn.prototype.clear=function(){this.length=0},Wn.prototype.resize=function(t){this.reserve(t),this.length=t},Wn.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},Wn.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Xn=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;this.resize(n+1);var i=2*n;return this.int16[i+0]=t,this.int16[i+1]=e,n},e})(Wn);Xn.prototype.bytesPerElement=4,fn("StructArrayLayout2i4",Xn);var Kn=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i){var r=this.length;this.resize(r+1);var o=4*r;return this.int16[o+0]=t,this.int16[o+1]=e,this.int16[o+2]=n,this.int16[o+3]=i,r},e})(Wn);Kn.prototype.bytesPerElement=8,fn("StructArrayLayout4i8",Kn);var Jn=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o){var a=this.length;this.resize(a+1);var s=6*a;return this.int16[s+0]=t,this.int16[s+1]=e,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=r,this.int16[s+5]=o,a},e})(Wn);Jn.prototype.bytesPerElement=12,fn("StructArrayLayout2i4i12",Jn);var Qn=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,s){var l=this.length;this.resize(l+1);var u=6*l,c=12*l;return this.int16[u+0]=t,this.int16[u+1]=e,this.int16[u+2]=n,this.int16[u+3]=i,this.uint8[c+8]=r,this.uint8[c+9]=o,this.uint8[c+10]=a,this.uint8[c+11]=s,l},e})(Wn);Qn.prototype.bytesPerElement=12,fn("StructArrayLayout4i4ub12",Qn);var ti=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,s){var l=this.length;this.resize(l+1);var u=8*l;return this.int16[u+0]=t,this.int16[u+1]=e,this.int16[u+2]=n,this.int16[u+3]=i,this.uint16[u+4]=r,this.uint16[u+5]=o,this.uint16[u+6]=a,this.uint16[u+7]=s,l},e})(Wn);ti.prototype.bytesPerElement=16,fn("StructArrayLayout4i4ui16",ti);var ei=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;this.resize(i+1);var r=3*i;return this.float32[r+0]=t,this.float32[r+1]=e,this.float32[r+2]=n,i},e})(Wn);ei.prototype.bytesPerElement=12,fn("StructArrayLayout3f12",ei);var ni=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var n=1*e;return this.uint32[n+0]=t,e},e})(Wn);ni.prototype.bytesPerElement=4,fn("StructArrayLayout1ul4",ni);var ii=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,s,l,u,c){var h=this.length;this.resize(h+1);var p=12*h,f=6*h;return this.int16[p+0]=t,this.int16[p+1]=e,this.int16[p+2]=n,this.int16[p+3]=i,this.int16[p+4]=r,this.int16[p+5]=o,this.uint32[f+3]=a,this.uint16[p+8]=s,this.uint16[p+9]=l,this.int16[p+10]=u,this.int16[p+11]=c,h},e})(Wn);ii.prototype.bytesPerElement=24,fn("StructArrayLayout6i1ul2ui2i24",ii);var ri=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o){var a=this.length;this.resize(a+1);var s=6*a;return this.int16[s+0]=t,this.int16[s+1]=e,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=r,this.int16[s+5]=o,a},e})(Wn);ri.prototype.bytesPerElement=12,fn("StructArrayLayout2i2i2i12",ri);var oi=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;this.resize(n+1);var i=4*n;return this.uint8[i+0]=t,this.uint8[i+1]=e,n},e})(Wn);oi.prototype.bytesPerElement=4,fn("StructArrayLayout2ub4",oi);var ai=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,s,l,u,c,h,p,f){var d=this.length;this.resize(d+1);var m=20*d,v=10*d,g=40*d;return this.int16[m+0]=t,this.int16[m+1]=e,this.uint16[m+2]=n,this.uint16[m+3]=i,this.uint32[v+2]=r,this.uint32[v+3]=o,this.uint32[v+4]=a,this.uint16[m+10]=s,this.uint16[m+11]=l,this.uint16[m+12]=u,this.float32[v+7]=c,this.float32[v+8]=h,this.uint8[g+36]=p,this.uint8[g+37]=f,d},e})(Wn);ai.prototype.bytesPerElement=40,fn("StructArrayLayout2i2ui3ul3ui2f2ub40",ai);var si=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var n=1*e;return this.float32[n+0]=t,e},e})(Wn);si.prototype.bytesPerElement=4,fn("StructArrayLayout1f4",si);var li=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;this.resize(i+1);var r=3*i;return this.int16[r+0]=t,this.int16[r+1]=e,this.int16[r+2]=n,i},e})(Wn);li.prototype.bytesPerElement=6,fn("StructArrayLayout3i6",li);var ui=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;this.resize(i+1);var r=2*i,o=4*i;return this.uint32[r+0]=t,this.uint16[o+2]=e,this.uint16[o+3]=n,i},e})(Wn);ui.prototype.bytesPerElement=8,fn("StructArrayLayout1ul2ui8",ui);var ci=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;this.resize(i+1);var r=3*i;return this.uint16[r+0]=t,this.uint16[r+1]=e,this.uint16[r+2]=n,i},e})(Wn);ci.prototype.bytesPerElement=6,fn("StructArrayLayout3ui6",ci);var hi=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;this.resize(n+1);var i=2*n;return this.uint16[i+0]=t,this.uint16[i+1]=e,n},e})(Wn);hi.prototype.bytesPerElement=4,fn("StructArrayLayout2ui4",hi);var pi=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;this.resize(n+1);var i=2*n;return this.float32[i+0]=t,this.float32[i+1]=e,n},e})(Wn);pi.prototype.bytesPerElement=8,fn("StructArrayLayout2f8",pi);var fi=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i){var r=this.length;this.resize(r+1);var o=4*r;return this.float32[o+0]=t,this.float32[o+1]=e,this.float32[o+2]=n,this.float32[o+3]=i,r},e})(Wn);fi.prototype.bytesPerElement=16,fn("StructArrayLayout4f16",fi);var di=(function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return n.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorPointX.set=function(t){this._structArray.int16[this._pos2+0]=t},n.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},n.anchorPointY.set=function(t){this._structArray.int16[this._pos2+1]=t},n.x1.get=function(){return this._structArray.int16[this._pos2+2]},n.x1.set=function(t){this._structArray.int16[this._pos2+2]=t},n.y1.get=function(){return this._structArray.int16[this._pos2+3]},n.y1.set=function(t){this._structArray.int16[this._pos2+3]=t},n.x2.get=function(){return this._structArray.int16[this._pos2+4]},n.x2.set=function(t){this._structArray.int16[this._pos2+4]=t},n.y2.get=function(){return this._structArray.int16[this._pos2+5]},n.y2.set=function(t){this._structArray.int16[this._pos2+5]=t},n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.featureIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},n.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},n.radius.get=function(){return this._structArray.int16[this._pos2+10]},n.radius.set=function(t){this._structArray.int16[this._pos2+10]=t},n.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},n.signedDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+11]=t},n.anchorPoint.get=function(){return new s(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,n),e})(Gn);di.prototype.size=24;var mi=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new di(this,t)},e})(ii);fn("CollisionBoxArray",mi);var vi=(function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},hidden:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},n.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.glyphStartIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},n.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},n.numGlyphs.set=function(t){this._structArray.uint16[this._pos2+3]=t},n.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},n.vertexStartIndex.set=function(t){this._structArray.uint32[this._pos4+2]=t},n.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.lineStartIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},n.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},n.lineLength.set=function(t){this._structArray.uint32[this._pos4+4]=t},n.segment.get=function(){return this._structArray.uint16[this._pos2+10]},n.segment.set=function(t){this._structArray.uint16[this._pos2+10]=t},n.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},n.lowerSize.set=function(t){this._structArray.uint16[this._pos2+11]=t},n.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},n.upperSize.set=function(t){this._structArray.uint16[this._pos2+12]=t},n.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},n.lineOffsetX.set=function(t){this._structArray.float32[this._pos4+7]=t},n.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},n.lineOffsetY.set=function(t){this._structArray.float32[this._pos4+8]=t},n.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},n.writingMode.set=function(t){this._structArray.uint8[this._pos1+36]=t},n.hidden.get=function(){return this._structArray.uint8[this._pos1+37]},n.hidden.set=function(t){this._structArray.uint8[this._pos1+37]=t},Object.defineProperties(e.prototype,n),e})(Gn);vi.prototype.size=40;var gi=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new vi(this,t)},e})(ai);fn("PlacedSymbolArray",gi);var yi=(function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={offsetX:{configurable:!0}};return n.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},n.offsetX.set=function(t){this._structArray.float32[this._pos4+0]=t},Object.defineProperties(e.prototype,n),e})(Gn);yi.prototype.size=4;var _i=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getoffsetX=function(t){return this.float32[1*t+0]},e.prototype.get=function(t){return new yi(this,t)},e})(si);fn("GlyphOffsetArray",_i);var xi=(function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return n.x.get=function(){return this._structArray.int16[this._pos2+0]},n.x.set=function(t){this._structArray.int16[this._pos2+0]=t},n.y.get=function(){return this._structArray.int16[this._pos2+1]},n.y.set=function(t){this._structArray.int16[this._pos2+1]=t},n.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},n.tileUnitDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+2]=t},Object.defineProperties(e.prototype,n),e})(Gn);xi.prototype.size=6;var bi=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getx=function(t){return this.int16[3*t+0]},e.prototype.gety=function(t){return this.int16[3*t+1]},e.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},e.prototype.get=function(t){return new xi(this,t)},e})(li);fn("SymbolLineVertexArray",bi);var wi=(function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},n.featureIndex.set=function(t){this._structArray.uint32[this._pos4+0]=t},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},n.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+3]=t},Object.defineProperties(e.prototype,n),e})(Gn);wi.prototype.size=8;var Ei=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new wi(this,t)},e})(ui);fn("FeatureIndexArray",Ei);var Si=Yn([{name:"a_pos",components:2,type:"Int16"}],4).members,Ci=function(t){void 0===t&&(t=[]),this.segments=t};Ci.prototype.prepareSegment=function(t,e,n){var i=this.segments[this.segments.length-1];return t>Ci.MAX_VERTEX_ARRAY_LENGTH&&x("Max vertices per segment is "+Ci.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!i||i.vertexLength+t>Ci.MAX_VERTEX_ARRAY_LENGTH)&&(i={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},this.segments.push(i)),i},Ci.prototype.get=function(){return this.segments},Ci.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var n=e[t];for(var i in n.vaos)n.vaos[i].destroy()}},Ci.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,fn("SegmentVector",Ci);var Ti=function(t,e){return 256*(t=h(Math.floor(t),0,255))+h(Math.floor(e),0,255)};function Ai(t){return[Ti(255*t.r,255*t.g),Ti(255*t.b,255*t.a)]}var Mi=function(t,e,n){this.value=t,this.name=e,this.type=n,this.statistics={max:-1/0}};Mi.prototype.defines=function(){return["#define HAS_UNIFORM_u_"+this.name]},Mi.prototype.populatePaintArray=function(){},Mi.prototype.upload=function(){},Mi.prototype.destroy=function(){},Mi.prototype.setUniforms=function(t,e,n,i){var r=i.constantOr(this.value),o=t.gl;"color"===this.type?o.uniform4f(e.uniforms["u_"+this.name],r.r,r.g,r.b,r.a):o.uniform1f(e.uniforms["u_"+this.name],r)};var Ii=function(t,e,n){this.expression=t,this.name=e,this.type=n,this.statistics={max:-1/0};var i="color"===n?pi:si;this.paintVertexAttributes=[{name:"a_"+e,type:"Float32",components:"color"===n?2:1,offset:0}],this.paintVertexArray=new i};Ii.prototype.defines=function(){return[]},Ii.prototype.populatePaintArray=function(t,e){var n=this.paintVertexArray,i=n.length;n.reserve(t);var r=this.expression.evaluate(new kn(0),e);if("color"===this.type)for(var o=Ai(r),a=i;a<t;a++)n.emplaceBack(o[0],o[1]);else{for(var s=i;s<t;s++)n.emplaceBack(r);this.statistics.max=Math.max(this.statistics.max,r)}},Ii.prototype.upload=function(t){this.paintVertexArray&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes))},Ii.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ii.prototype.setUniforms=function(t,e){t.gl.uniform1f(e.uniforms["a_"+this.name+"_t"],0)};var ki=function(t,e,n,i,r){this.expression=t,this.name=e,this.type=n,this.useIntegerZoom=i,this.zoom=r,this.statistics={max:-1/0};var o="color"===n?fi:pi;this.paintVertexAttributes=[{name:"a_"+e,type:"Float32",components:"color"===n?4:2,offset:0}],this.paintVertexArray=new o};ki.prototype.defines=function(){return[]},ki.prototype.populatePaintArray=function(t,e){var n=this.paintVertexArray,i=n.length;n.reserve(t);var r=this.expression.evaluate(new kn(this.zoom),e),o=this.expression.evaluate(new kn(this.zoom+1),e);if("color"===this.type)for(var a=Ai(r),s=Ai(o),l=i;l<t;l++)n.emplaceBack(a[0],a[1],s[0],s[1]);else{for(var u=i;u<t;u++)n.emplaceBack(r,o);this.statistics.max=Math.max(this.statistics.max,r,o)}},ki.prototype.upload=function(t){this.paintVertexArray&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes))},ki.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ki.prototype.interpolationFactor=function(t){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(t),this.zoom,this.zoom+1):this.expression.interpolationFactor(t,this.zoom,this.zoom+1)},ki.prototype.setUniforms=function(t,e,n){t.gl.uniform1f(e.uniforms["a_"+this.name+"_t"],this.interpolationFactor(n.zoom))};var zi=function(){this.binders={},this.cacheKey="",this._buffers=[]};zi.createDynamic=function(t,e,n){var i=new zi,r=[];for(var o in t.paint._values)if(n(o)){var a=t.paint.get(o);if(a instanceof Bn&&a.property.specification["property-function"]){var s=Li(o,t.type),l=a.property.specification.type,u=a.property.useIntegerZoom;"constant"===a.value.kind?(i.binders[o]=new Mi(a.value,s,l),r.push("/u_"+s)):"source"===a.value.kind?(i.binders[o]=new Ii(a.value,s,l),r.push("/a_"+s)):(i.binders[o]=new ki(a.value,s,l,u,e),r.push("/z_"+s))}}return i.cacheKey=r.sort().join(""),i},zi.prototype.populatePaintArrays=function(t,e){for(var n in this.binders)this.binders[n].populatePaintArray(t,e)},zi.prototype.defines=function(){var t=[];for(var e in this.binders)t.push.apply(t,this.binders[e].defines());return t},zi.prototype.setUniforms=function(t,e,n,i){for(var r in this.binders)this.binders[r].setUniforms(t,e,i,n.get(r))},zi.prototype.getPaintVertexBuffers=function(){return this._buffers},zi.prototype.upload=function(t){for(var e in this.binders)this.binders[e].upload(t);var n=[];for(var i in this.binders){var r=this.binders[i];(r instanceof Ii||r instanceof ki)&&r.paintVertexBuffer&&n.push(r.paintVertexBuffer)}this._buffers=n},zi.prototype.destroy=function(){for(var t in this.binders)this.binders[t].destroy()};var Di=function(t,e,n,i){void 0===i&&(i=function(){return!0}),this.programConfigurations={};for(var r=0,o=e;r<o.length;r+=1){var a=o[r];this.programConfigurations[a.id]=zi.createDynamic(a,n,i),this.programConfigurations[a.id].layoutAttributes=t}};function Li(t,e){return{"text-opacity":"opacity","icon-opacity":"opacity","text-color":"fill_color","icon-color":"fill_color","text-halo-color":"halo_color","icon-halo-color":"halo_color","text-halo-blur":"halo_blur","icon-halo-blur":"halo_blur","text-halo-width":"halo_width","icon-halo-width":"halo_width","line-gap-width":"gapwidth"}[t]||t.replace(e+"-","").replace(/-/g,"_")}Di.prototype.populatePaintArrays=function(t,e){for(var n in this.programConfigurations)this.programConfigurations[n].populatePaintArrays(t,e)},Di.prototype.get=function(t){return this.programConfigurations[t]},Di.prototype.upload=function(t){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t)},Di.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},fn("ConstantBinder",Mi),fn("SourceExpressionBinder",Ii),fn("CompositeExpressionBinder",ki),fn("ProgramConfiguration",zi,{omit:["_buffers"]}),fn("ProgramConfigurationSet",Di);var Pi=8192,Oi=(16,{min:-1*Math.pow(2,15),max:Math.pow(2,15)-1});function Ri(t){for(var e=Pi/t.extent,n=t.loadGeometry(),i=0;i<n.length;i++)for(var r=n[i],o=0;o<r.length;o++){var a=r[o];a.x=Math.round(a.x*e),a.y=Math.round(a.y*e),(a.x<Oi.min||a.x>Oi.max||a.y<Oi.min||a.y>Oi.max)&&x("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return n}function Bi(t,e,n,i,r){t.emplaceBack(2*e+(i+1)/2,2*n+(r+1)/2)}var Fi=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.layoutVertexArray=new Xn,this.indexArray=new ci,this.segments=new Ci,this.programConfigurations=new Di(Si,t.layers,t.zoom)};function Ni(t,e,n){for(var i=0;i<t.length;i++){var r=t[i];if(Yi(r,e))return!0;if(Zi(e,r,n))return!0}return!1}function Vi(t,e){if(1===t.length&&1===t[0].length)return Wi(e,t[0][0]);for(var n=0;n<e.length;n++)for(var i=e[n],r=0;r<i.length;r++)if(Wi(t,i[r]))return!0;for(var o=0;o<t.length;o++){for(var a=t[o],s=0;s<a.length;s++)if(Wi(e,a[s]))return!0;for(var l=0;l<e.length;l++)if(qi(a,e[l]))return!0}return!1}function ji(t,e,n){for(var i=0;i<e.length;i++)for(var r=e[i],o=0;o<t.length;o++){var a=t[o];if(a.length>=3)for(var s=0;s<r.length;s++)if(Yi(a,r[s]))return!0;if(Ui(a,r,n))return!0}return!1}function Ui(t,e,n){if(t.length>1){if(qi(t,e))return!0;for(var i=0;i<e.length;i++)if(Zi(e[i],t,n))return!0}for(var r=0;r<t.length;r++)if(Zi(t[r],e,n))return!0;return!1}function qi(t,e){if(0===t.length||0===e.length)return!1;for(var n=0;n<t.length-1;n++)for(var i=t[n],r=t[n+1],o=0;o<e.length-1;o++)if($i(i,r,e[o],e[o+1]))return!0;return!1}function $i(t,e,n,i){return b(t,n,i)!==b(e,n,i)&&b(t,e,n)!==b(t,e,i)}function Zi(t,e,n){var i=n*n;if(1===e.length)return t.distSqr(e[0])<i;for(var r=1;r<e.length;r++)if(Gi(t,e[r-1],e[r])<i)return!0;return!1}function Gi(t,e,n){var i=e.distSqr(n);if(0===i)return t.distSqr(e);var r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return r<0?t.distSqr(e):r>1?t.distSqr(n):t.distSqr(n.sub(e)._mult(r)._add(e))}function Wi(t,e){for(var n,i,r,o=!1,a=0;a<t.length;a++)for(var s=0,l=(n=t[a]).length-1;s<n.length;l=s++)i=n[s],r=n[l],i.y>e.y!=r.y>e.y&&e.x<(r.x-i.x)*(e.y-i.y)/(r.y-i.y)+i.x&&(o=!o);return o}function Yi(t,e){for(var n=!1,i=0,r=t.length-1;i<t.length;r=i++){var o=t[i],a=t[r];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(n=!n)}return n}function Hi(t,e,n){var i=e.paint.get(t).value;return"constant"===i.kind?i.value:n.programConfigurations.get(e.id).binders[t].statistics.max}function Xi(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Ki(t,e,n,i,r){if(!e[0]&&!e[1])return t;var o=s.convert(e);"viewport"===n&&o._rotate(-i);for(var a=[],l=0;l<t.length;l++){for(var u=t[l],c=[],h=0;h<u.length;h++)c.push(u[h].sub(o._mult(r)));a.push(c)}return a}Fi.prototype.populate=function(t,e){for(var n=0,i=t;n<i.length;n+=1){var r=i[n],o=r.feature,a=r.index,s=r.sourceLayerIndex;if(this.layers[0]._featureFilter(new kn(this.zoom),o)){var l=Ri(o);this.addFeature(o,l),e.featureIndex.insert(o,l,a,s,this.index)}}},Fi.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Fi.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Si),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.programConfigurations.upload(t)},Fi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Fi.prototype.addFeature=function(t,e){for(var n=0,i=e;n<i.length;n+=1)for(var r=0,o=i[n];r<o.length;r+=1){var a=o[r],s=a.x,l=a.y;if(!(s<0||s>=Pi||l<0||l>=Pi)){var u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),c=u.vertexLength;Bi(this.layoutVertexArray,s,l,-1,-1),Bi(this.layoutVertexArray,s,l,1,-1),Bi(this.layoutVertexArray,s,l,1,1),Bi(this.layoutVertexArray,s,l,-1,1),this.indexArray.emplaceBack(c,c+1,c+2),this.indexArray.emplaceBack(c,c+3,c+2),u.vertexLength+=4,u.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t)},fn("CircleBucket",Fi,{omit:["layers"]});var Ji={paint:new qn({"circle-radius":new Vn(D.paint_circle["circle-radius"]),"circle-color":new Vn(D.paint_circle["circle-color"]),"circle-blur":new Vn(D.paint_circle["circle-blur"]),"circle-opacity":new Vn(D.paint_circle["circle-opacity"]),"circle-translate":new Nn(D.paint_circle["circle-translate"]),"circle-translate-anchor":new Nn(D.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Nn(D.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Nn(D.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Vn(D.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Vn(D.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Vn(D.paint_circle["circle-stroke-opacity"])})},Qi=i((function(t,e){var n;t.exports=((n=new Float32Array(3))[0]=0,n[1]=0,n[2]=0,(function(){var t=new Float32Array(4);t[0]=0,t[1]=0,t[2]=0,t[3]=0})(),{vec3:{transformMat3:function(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t}},vec4:{transformMat4:function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,t}},mat2:{create:function(){var t=new Float32Array(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},rotate:function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=i*l+o*s,t[1]=r*l+a*s,t[2]=i*-s+o*l,t[3]=r*-s+a*l,t},scale:function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=n[0],l=n[1];return t[0]=i*s,t[1]=r*s,t[2]=o*l,t[3]=a*l,t}},mat3:{create:function(){var t=new Float32Array(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromRotation:function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}},mat4:{create:function(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},translate:function(t,e,n){var i,r,o,a,s,l,u,c,h,p,f,d,m=n[0],v=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*g+e[12],t[13]=e[1]*m+e[5]*v+e[9]*g+e[13],t[14]=e[2]*m+e[6]*v+e[10]*g+e[14],t[15]=e[3]*m+e[7]*v+e[11]*g+e[15]):(i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=p,t[10]=f,t[11]=d,t[12]=i*m+s*v+h*g+e[12],t[13]=r*m+l*v+p*g+e[13],t[14]=o*m+u*v+f*g+e[14],t[15]=a*m+c*v+d*g+e[15]),t},scale:function(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},multiply:function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],m=e[12],v=e[13],g=e[14],y=e[15],_=n[0],x=n[1],b=n[2],w=n[3];return t[0]=_*i+x*s+b*h+w*m,t[1]=_*r+x*l+b*p+w*v,t[2]=_*o+x*u+b*f+w*g,t[3]=_*a+x*c+b*d+w*y,_=n[4],x=n[5],b=n[6],w=n[7],t[4]=_*i+x*s+b*h+w*m,t[5]=_*r+x*l+b*p+w*v,t[6]=_*o+x*u+b*f+w*g,t[7]=_*a+x*c+b*d+w*y,_=n[8],x=n[9],b=n[10],w=n[11],t[8]=_*i+x*s+b*h+w*m,t[9]=_*r+x*l+b*p+w*v,t[10]=_*o+x*u+b*f+w*g,t[11]=_*a+x*c+b*d+w*y,_=n[12],x=n[13],b=n[14],w=n[15],t[12]=_*i+x*s+b*h+w*m,t[13]=_*r+x*l+b*p+w*v,t[14]=_*o+x*u+b*f+w*g,t[15]=_*a+x*c+b*d+w*y,t},perspective:function(t,e,n,i,r){var o=1/Math.tan(e/2),a=1/(i-r);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+i)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*i*a,t[15]=0,t},rotateX:function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+u*i,t[5]=a*r+c*i,t[6]=s*r+h*i,t[7]=l*r+p*i,t[8]=u*r-o*i,t[9]=c*r-a*i,t[10]=h*r-s*i,t[11]=p*r-l*i,t},rotateZ:function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+u*i,t[1]=a*r+c*i,t[2]=s*r+h*i,t[3]=l*r+p*i,t[4]=u*r-o*i,t[5]=c*r-a*i,t[6]=h*r-s*i,t[7]=p*r-l*i,t},invert:function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],f=e[11],d=e[12],m=e[13],v=e[14],g=e[15],y=n*s-i*a,_=n*l-r*a,x=n*u-o*a,b=i*l-r*s,w=i*u-o*s,E=r*u-o*l,S=c*m-h*d,C=c*v-p*d,T=c*g-f*d,A=h*v-p*m,M=h*g-f*m,I=p*g-f*v,k=y*I-_*M+x*A+b*T-w*C+E*S;return k?(k=1/k,t[0]=(s*I-l*M+u*A)*k,t[1]=(r*M-i*I-o*A)*k,t[2]=(m*E-v*w+g*b)*k,t[3]=(p*w-h*E-f*b)*k,t[4]=(l*T-a*I-u*C)*k,t[5]=(n*I-r*T+o*C)*k,t[6]=(v*x-d*E-g*_)*k,t[7]=(c*E-p*x+f*_)*k,t[8]=(a*M-s*T+u*S)*k,t[9]=(i*T-n*M-o*S)*k,t[10]=(d*w-m*x+g*y)*k,t[11]=(h*x-c*w-f*y)*k,t[12]=(s*C-a*A-l*S)*k,t[13]=(n*A-i*C+r*S)*k,t[14]=(m*_-d*b-v*y)*k,t[15]=(c*b-h*_+p*y)*k,t):null},ortho:function(t,e,n,i,r,o,a){var s=1/(e-n),l=1/(i-r),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*l,t[14]=(a+o)*u,t[15]=1,t}}})})),tr=(Qi.vec3,Qi.vec4),er=(Qi.mat2,Qi.mat3,Qi.mat4),nr=(function(t){function e(e){t.call(this,e,Ji)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new Fi(t)},e.prototype.queryRadius=function(t){var e=t;return Hi("circle-radius",this,e)+Hi("circle-stroke-width",this,e)+Xi(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o,a){for(var s=Ki(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),r.angle,o),l=this.paint.get("circle-radius").evaluate(e)+this.paint.get("circle-stroke-width").evaluate(e),u="map"===this.paint.get("circle-pitch-alignment"),c=u?s:(function(t,e,n){return s.map((function(t){return t.map((function(t){return ir(t,e,n)}))}))})(0,a,r),h=u?l*o:l,p=0,f=n;p<f.length;p+=1)for(var d=0,m=f[p];d<m.length;d+=1){var v=m[d],g=u?v:ir(v,a,r),y=h,_=tr.transformMat4([],[v.x,v.y,0,1],a);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?y*=_[3]/r.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(y*=r.cameraToCenterDistance/_[3]),Ni(c,g,y))return!0}return!1},e})($n);function ir(t,e,n){var i=tr.transformMat4([],[t.x,t.y,0,1],e);return new s((i[0]/i[3]+1)*n.width*.5,(i[1]/i[3]+1)*n.height*.5)}var rr=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e})(Fi);function or(t,e,n,i){var r=e.width,o=e.height;if(i){if(i.length!==r*o*n)throw new RangeError("mismatched image size")}else i=new Uint8Array(r*o*n);return t.width=r,t.height=o,t.data=i,t}function ar(t,e,n){var i=e.width,r=e.height;if(i!==t.width||r!==t.height){var o=or({},{width:i,height:r},n);sr(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,i),height:Math.min(t.height,r)},n),t.width=i,t.height=r,t.data=o.data}}function sr(t,e,n,i,r,o){if(0===r.width||0===r.height)return e;if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>e.width||r.height>e.height||i.x>e.width-r.width||i.y>e.height-r.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,l=0;l<r.height;l++)for(var u=((n.y+l)*t.width+n.x)*o,c=((i.y+l)*e.width+i.x)*o,h=0;h<r.width*o;h++)s[c+h]=a[u+h];return e}fn("HeatmapBucket",rr,{omit:["layers"]});var lr=function(t,e){or(this,t,1,e)};lr.prototype.resize=function(t){ar(this,t,1)},lr.prototype.clone=function(){return new lr({width:this.width,height:this.height},new Uint8Array(this.data))},lr.copy=function(t,e,n,i,r){sr(t,e,n,i,r,1)};var ur=function(t,e){or(this,t,4,e)};ur.prototype.resize=function(t){ar(this,t,4)},ur.prototype.clone=function(){return new ur({width:this.width,height:this.height},new Uint8Array(this.data))},ur.copy=function(t,e,n,i,r){sr(t,e,n,i,r,4)},fn("AlphaImage",lr),fn("RGBAImage",ur);var cr={paint:new qn({"heatmap-radius":new Vn(D.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Vn(D.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Nn(D.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Un(D.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Nn(D.paint_heatmap["heatmap-opacity"])})};function hr(t,e){for(var n=new Uint8Array(1024),i={},r=0,o=0;r<256;r++,o+=4){i[e]=r/255;var a=t.evaluate(i);n[o+0]=Math.floor(255*a.r/a.a),n[o+1]=Math.floor(255*a.g/a.a),n[o+2]=Math.floor(255*a.b/a.a),n[o+3]=Math.floor(255*a.a)}return new ur({width:256,height:1},n)}var pr=(function(t){function e(e){t.call(this,e,cr),this._updateColorRamp()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new rr(t)},e.prototype.setPaintProperty=function(e,n,i){t.prototype.setPaintProperty.call(this,e,n,i),"heatmap-color"===e&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){var t=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=hr(t,"heatmapDensity"),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e})($n),fr={paint:new qn({"hillshade-illumination-direction":new Nn(D.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Nn(D.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Nn(D.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Nn(D.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Nn(D.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Nn(D.paint_hillshade["hillshade-accent-color"])})},dr=(function(t){function e(e){t.call(this,e,fr)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e})($n),mr=Yn([{name:"a_pos",components:2,type:"Int16"}],4).members,vr=yr,gr=yr;function yr(t,e,n){n=n||2;var i,r,o,a,s,l,u,c=e&&e.length,h=c?e[0]*n:t.length,p=_r(t,0,h,n,!0),f=[];if(!p)return f;if(c&&(p=(function(t,e,n,i){var r,o,a,s=[];for(r=0,o=e.length;r<o;r++)(a=_r(t,e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1))===a.next&&(a.steiner=!0),s.push(Ir(a));for(s.sort(Tr),r=0;r<s.length;r++)Ar(s[r],n),n=xr(n,n.next);return n})(t,e,p,n)),t.length>80*n){i=o=t[0],r=a=t[1];for(var d=n;d<h;d+=n)(s=t[d])<i&&(i=s),(l=t[d+1])<r&&(r=l),s>o&&(o=s),l>a&&(a=l);u=0!==(u=Math.max(o-i,a-r))?1/u:0}return br(p,f,n,i,r,u),f}function _r(t,e,n,i,r){var o,a;if(r===Vr(t,e,n,i)>0)for(o=e;o<n;o+=i)a=Br(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=Br(o,t[o],t[o+1],a);return a&&Lr(a,a.next)&&(Fr(a),a=a.next),a}function xr(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!Lr(i,i.next)&&0!==Dr(i.prev,i,i.next))i=i.next;else{if(Fr(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function br(t,e,n,i,r,o,a){if(t){!a&&o&&(function(t,e,n,i){var r=t;do{null===r.z&&(r.z=Mr(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,(function(t){var e,n,i,r,o,a,s,l,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,i=n,s=0,e=0;e<u&&(s++,i=i.nextZ);e++);for(l=u;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(a>1)})(r)})(t,i,r,o);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?Er(t,i,r,o):wr(t))e.push(s.i/n),e.push(t.i/n),e.push(l.i/n),Fr(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?br(t=Sr(t,e,n),e,n,i,r,o,2):2===a&&Cr(t,e,n,i,r,o):br(xr(t),e,n,i,r,o,1);break}}}function wr(t){var e=t.prev,n=t,i=t.next;if(Dr(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(kr(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&Dr(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Er(t,e,n,i){var r=t.prev,o=t,a=t.next;if(Dr(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,l=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,u=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,c=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,h=Mr(s,l,e,n,i),p=Mr(u,c,e,n,i),f=t.prevZ,d=t.nextZ;f&&f.z>=h&&d&&d.z<=p;){if(f!==t.prev&&f!==t.next&&kr(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Dr(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,d!==t.prev&&d!==t.next&&kr(r.x,r.y,o.x,o.y,a.x,a.y,d.x,d.y)&&Dr(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&kr(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Dr(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;d&&d.z<=p;){if(d!==t.prev&&d!==t.next&&kr(r.x,r.y,o.x,o.y,a.x,a.y,d.x,d.y)&&Dr(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function Sr(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!Lr(r,o)&&Pr(r,i,i.next,o)&&Or(r,o)&&Or(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),Fr(i),Fr(i.next),i=t=o),i=i.next}while(i!==t);return i}function Cr(t,e,n,i,r,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&zr(a,s)){var l=Rr(a,s);return a=xr(a,a.next),l=xr(l,l.next),br(a,e,n,i,r,o),void br(l,e,n,i,r,o)}s=s.next}a=a.next}while(a!==t)}function Tr(t,e){return t.x-e.x}function Ar(t,e){if(e=(function(t,e){var n,i=e,r=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>a){if(a=s,s===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===a)return n.prev;var l,u=n,c=n.x,h=n.y,p=1/0;for(i=n.next;i!==u;)r>=i.x&&i.x>=c&&r!==i.x&&kr(o<h?r:a,o,c,h,o<h?a:r,o,i.x,i.y)&&((l=Math.abs(o-i.y)/(r-i.x))<p||l===p&&i.x>n.x)&&Or(i,t)&&(n=i,p=l),i=i.next;return n})(t,e)){var n=Rr(e,t);xr(n,n.next)}}function Mr(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ir(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function kr(t,e,n,i,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function zr(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!(function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Pr(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1})(t,e)&&Or(t,e)&&Or(e,t)&&(function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i})(t,e)}function Dr(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Lr(t,e){return t.x===e.x&&t.y===e.y}function Pr(t,e,n,i){return!!(Lr(t,e)&&Lr(n,i)||Lr(t,i)&&Lr(n,e))||Dr(t,e,n)>0!=Dr(t,e,i)>0&&Dr(n,i,t)>0!=Dr(n,i,e)>0}function Or(t,e){return Dr(t.prev,t,t.next)<0?Dr(t,e,t.next)>=0&&Dr(t,t.prev,e)>=0:Dr(t,e,t.prev)<0||Dr(t,t.next,e)<0}function Rr(t,e){var n=new Nr(t.i,t.x,t.y),i=new Nr(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function Br(t,e,n,i){var r=new Nr(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Fr(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Nr(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Vr(t,e,n,i){for(var r=0,o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}yr.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,a=Math.abs(Vr(t,0,o,n));if(r)for(var s=0,l=e.length;s<l;s++){var u=e[s]*n,c=s<l-1?e[s+1]*n:t.length;a-=Math.abs(Vr(t,u,c,n))}var h=0;for(s=0;s<i.length;s+=3){var p=i[s]*n,f=i[s+1]*n,d=i[s+2]*n;h+=Math.abs((t[p]-t[d])*(t[f+1]-t[p+1])-(t[p]-t[f])*(t[d+1]-t[p+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},yr.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[r][o][a]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n},vr.default=gr;var jr=qr,Ur=qr;function qr(t,e,n,i,r){!(function t(e,n,i,r,o){for(;r>i;){if(r-i>600){var a=r-i+1,s=n-i+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);t(e,n,Math.max(i,Math.floor(n-s*u/a+c)),Math.min(r,Math.floor(n+(a-s)*u/a+c)),o)}var h=e[n],p=i,f=r;for($r(e,i,n),o(e[r],h)>0&&$r(e,i,r);p<f;){for($r(e,p,f),p++,f--;o(e[p],h)<0;)p++;for(;o(e[f],h)>0;)f--}0===o(e[i],h)?$r(e,i,f):$r(e,++f,r),f<=n&&(i=f+1),n<=f&&(r=f-1)}})(t,e,n||0,i||t.length-1,r||Zr)}function $r(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function Zr(t,e){return t<e?-1:t>e?1:0}function Gr(t,e){var n=t.length;if(n<=1)return[t];for(var i,r,o=[],a=0;a<n;a++){var s=w(t[a]);0!==s&&(t[a].area=Math.abs(s),void 0===r&&(r=s<0),r===s<0?(i&&o.push(i),i=[t[a]]):i.push(t[a]))}if(i&&o.push(i),e>1)for(var l=0;l<o.length;l++)o[l].length<=e||(jr(o[l],e,1,o[l].length-1,Wr),o[l]=o[l].slice(0,e));return o}function Wr(t,e){return e.area-t.area}jr.default=Ur;var Yr=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.layoutVertexArray=new Xn,this.indexArray=new ci,this.indexArray2=new hi,this.programConfigurations=new Di(mr,t.layers,t.zoom),this.segments=new Ci,this.segments2=new Ci};Yr.prototype.populate=function(t,e){for(var n=0,i=t;n<i.length;n+=1){var r=i[n],o=r.feature,a=r.index,s=r.sourceLayerIndex;if(this.layers[0]._featureFilter(new kn(this.zoom),o)){var l=Ri(o);this.addFeature(o,l),e.featureIndex.insert(o,l,a,s,this.index)}}},Yr.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Yr.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,mr),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2),this.programConfigurations.upload(t)},Yr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Yr.prototype.addFeature=function(t,e){for(var n=0,i=Gr(e,500);n<i.length;n+=1){for(var r=i[n],o=0,a=0,s=r;a<s.length;a+=1)o+=s[a].length;for(var l=this.segments.prepareSegment(o,this.layoutVertexArray,this.indexArray),u=l.vertexLength,c=[],h=[],p=0,f=r;p<f.length;p+=1){var d=f[p];if(0!==d.length){d!==r[0]&&h.push(c.length/2);var m=this.segments2.prepareSegment(d.length,this.layoutVertexArray,this.indexArray2),v=m.vertexLength;this.layoutVertexArray.emplaceBack(d[0].x,d[0].y),this.indexArray2.emplaceBack(v+d.length-1,v),c.push(d[0].x),c.push(d[0].y);for(var g=1;g<d.length;g++)this.layoutVertexArray.emplaceBack(d[g].x,d[g].y),this.indexArray2.emplaceBack(v+g-1,v+g),c.push(d[g].x),c.push(d[g].y);m.vertexLength+=d.length,m.primitiveLength+=d.length}}for(var y=vr(c,h),_=0;_<y.length;_+=3)this.indexArray.emplaceBack(u+y[_],u+y[_+1],u+y[_+2]);l.vertexLength+=o,l.primitiveLength+=y.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t)},fn("FillBucket",Yr,{omit:["layers"]});var Hr={paint:new qn({"fill-antialias":new Nn(D.paint_fill["fill-antialias"]),"fill-opacity":new Vn(D.paint_fill["fill-opacity"]),"fill-color":new Vn(D.paint_fill["fill-color"]),"fill-outline-color":new Vn(D.paint_fill["fill-outline-color"]),"fill-translate":new Nn(D.paint_fill["fill-translate"]),"fill-translate-anchor":new Nn(D.paint_fill["fill-translate-anchor"]),"fill-pattern":new jn(D.paint_fill["fill-pattern"])})},Xr=(function(t){function e(e){t.call(this,e,Hr)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(t){this.paint=this._transitioningPaint.possiblyEvaluate(t);var e=this.paint._values["fill-outline-color"];"constant"===e.value.kind&&void 0===e.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new Yr(t)},e.prototype.queryRadius=function(){return Xi(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o){return Vi(Ki(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),r.angle,o),n)},e})($n),Kr=Yn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Jr=Math.pow(2,13);function Qr(t,e,n,i,r,o,a,s){t.emplaceBack(e,n,2*Math.floor(i*Jr)+a,r*Jr*2,o*Jr*2,Math.round(s))}var to=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.layoutVertexArray=new Jn,this.indexArray=new ci,this.programConfigurations=new Di(Kr,t.layers,t.zoom),this.segments=new Ci};function eo(t,e){return t.x===e.x&&(t.x<0||t.x>Pi)||t.y===e.y&&(t.y<0||t.y>Pi)}function no(t){return t.every((function(t){return t.x<0}))||t.every((function(t){return t.x>Pi}))||t.every((function(t){return t.y<0}))||t.every((function(t){return t.y>Pi}))}to.prototype.populate=function(t,e){for(var n=0,i=t;n<i.length;n+=1){var r=i[n],o=r.feature,a=r.index,s=r.sourceLayerIndex;if(this.layers[0]._featureFilter(new kn(this.zoom),o)){var l=Ri(o);this.addFeature(o,l),e.featureIndex.insert(o,l,a,s,this.index)}}},to.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},to.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Kr),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.programConfigurations.upload(t)},to.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},to.prototype.addFeature=function(t,e){for(var n=0,i=Gr(e,500);n<i.length;n+=1){for(var r=i[n],o=0,a=0,s=r;a<s.length;a+=1)o+=s[a].length;for(var l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),u=0,c=r;u<c.length;u+=1){var h=c[u];if(0!==h.length&&!no(h))for(var p=0,f=0;f<h.length;f++){var d=h[f];if(f>=1){var m=h[f-1];if(!eo(d,m)){l.vertexLength+4>Ci.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var v=d.sub(m)._perp()._unit(),g=m.dist(d);p+g>32768&&(p=0),Qr(this.layoutVertexArray,d.x,d.y,v.x,v.y,0,0,p),Qr(this.layoutVertexArray,d.x,d.y,v.x,v.y,0,1,p),p+=g,Qr(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,0,p),Qr(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,1,p);var y=l.vertexLength;this.indexArray.emplaceBack(y,y+1,y+2),this.indexArray.emplaceBack(y+1,y+2,y+3),l.vertexLength+=4,l.primitiveLength+=2}}}}l.vertexLength+o>Ci.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(o,this.layoutVertexArray,this.indexArray));for(var _=[],x=[],b=l.vertexLength,w=0,E=r;w<E.length;w+=1){var S=E[w];if(0!==S.length){S!==r[0]&&x.push(_.length/2);for(var C=0;C<S.length;C++){var T=S[C];Qr(this.layoutVertexArray,T.x,T.y,0,0,1,1,0),_.push(T.x),_.push(T.y)}}}for(var A=vr(_,x),M=0;M<A.length;M+=3)this.indexArray.emplaceBack(b+A[M],b+A[M+1],b+A[M+2]);l.primitiveLength+=A.length/3,l.vertexLength+=o}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t)},fn("FillExtrusionBucket",to,{omit:["layers"]});var io={paint:new qn({"fill-extrusion-opacity":new Nn(D["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Vn(D["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Nn(D["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Nn(D["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new jn(D["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Vn(D["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Vn(D["paint_fill-extrusion"]["fill-extrusion-base"])})},ro=(function(t){function e(e){t.call(this,e,io)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new to(t)},e.prototype.queryRadius=function(){return Xi(this.paint.get("fill-extrusion-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o){return Vi(Ki(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),r.angle,o),n)},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("fill-extrusion-opacity")&&"none"!==this.visibility},e.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},e})($n),oo=Yn([{name:"a_pos_normal",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,ao=so;function so(t,e,n,i,r){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=r,t.readFields(lo,this,e)}function lo(t,e,n){1==t?e.id=n.readVarint():2==t?(function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var i=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[i]=r}})(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function uo(t){for(var e,n,i=0,r=0,o=t.length,a=o-1;r<o;a=r++)e=t[r],i+=((n=t[a]).x-e.x)*(e.y+n.y);return i}so.types=["Unknown","Point","LineString","Polygon"],so.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,i=1,r=0,o=0,a=0,l=[];t.pos<n;){if(r<=0){var u=t.readVarint();i=7&u,r=u>>3}if(r--,1===i||2===i)o+=t.readSVarint(),a+=t.readSVarint(),1===i&&(e&&l.push(e),e=[]),e.push(new s(o,a));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&l.push(e),l},so.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,i=0,r=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(i<=0){var c=t.readVarint();n=7&c,i=c>>3}if(i--,1===n||2===n)(r+=t.readSVarint())<a&&(a=r),r>s&&(s=r),(o+=t.readSVarint())<l&&(l=o),o>u&&(u=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,l,s,u]},so.prototype.toGeoJSON=function(t,e,n){var i,r,o=this.extent*Math.pow(2,n),a=this.extent*t,s=this.extent*e,l=this.loadGeometry(),u=so.types[this.type];function c(t){for(var e=0;e<t.length;e++){var n=t[e],i=180-360*(n.y+s)/o;t[e]=[360*(n.x+a)/o-180,360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(i=0;i<l.length;i++)h[i]=l[i][0];c(l=h);break;case 2:for(i=0;i<l.length;i++)c(l[i]);break;case 3:for(l=(function(t){var e=t.length;if(e<=1)return[t];for(var n,i,r=[],o=0;o<e;o++){var a=uo(t[o]);0!==a&&(void 0===i&&(i=a<0),i===a<0?(n&&r.push(n),n=[t[o]]):n.push(t[o]))}return n&&r.push(n),r})(l),i=0;i<l.length;i++)for(r=0;r<l[i].length;r++)c(l[i][r])}1===l.length?l=l[0]:u="Multi"+u;var p={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(p.id=this.id),p};var co=ho;function ho(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(po,this,e),this.length=this._features.length}function po(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var i=t.readVarint()>>3;e=1===i?t.readString():2===i?t.readFloat():3===i?t.readDouble():4===i?t.readVarint64():5===i?t.readVarint():6===i?t.readSVarint():7===i?t.readBoolean():null}return e}(n))}function fo(t,e,n){if(3===t){var i=new co(n,n.readVarint()+n.pos);i.length&&(e[i.name]=i)}}ho.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new ao(this._pbf,e,this.extent,this._keys,this._values)};var mo={VectorTile:function(t,e){this.layers=t.readFields(fo,{},e)},VectorTileFeature:ao,VectorTileLayer:co},vo=mo.VectorTileFeature.types,go=63,yo=Math.cos(Math.PI/180*37.5),_o=.5,xo=Math.pow(2,14)/_o;function bo(t,e,n,i,r,o,a){t.emplaceBack(e.x,e.y,i?1:0,r?1:-1,Math.round(go*n.x)+128,Math.round(go*n.y)+128,1+(0===o?0:o<0?-1:1)|(a*_o&63)<<2,a*_o>>6)}var wo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.layoutVertexArray=new Qn,this.indexArray=new ci,this.programConfigurations=new Di(oo,t.layers,t.zoom),this.segments=new Ci};function Eo(t,e){return(t/e.tileTotal*(e.end-e.start)+e.start)*(xo-1)}wo.prototype.populate=function(t,e){for(var n=0,i=t;n<i.length;n+=1){var r=i[n],o=r.feature,a=r.index,s=r.sourceLayerIndex;if(this.layers[0]._featureFilter(new kn(this.zoom),o)){var l=Ri(o);this.addFeature(o,l),e.featureIndex.insert(o,l,a,s,this.index)}}},wo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},wo.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,oo),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.programConfigurations.upload(t)},wo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},wo.prototype.addFeature=function(t,e){for(var n=this.layers[0].layout,i=n.get("line-join").evaluate(t),r=n.get("line-cap"),o=n.get("line-miter-limit"),a=n.get("line-round-limit"),s=0,l=e;s<l.length;s+=1){var u=l[s];this.addLine(u,t,i,r,o,a)}},wo.prototype.addLine=function(t,e,n,i,r,o){var a=null;e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")&&(a={start:e.properties.mapbox_clip_start,end:e.properties.mapbox_clip_end,tileTotal:void 0});for(var s="Polygon"===vo[e.type],l=t.length;l>=2&&t[l-1].equals(t[l-2]);)l--;for(var u=0;u<l-1&&t[u].equals(t[u+1]);)u++;if(!(l<(s?3:2))){a&&(a.tileTotal=(function(t,e,n){for(var i,r,o=0,a=u;a<n-1;a++)i=t[a],r=t[a+1],o+=i.dist(r);return o})(t,0,l)),"bevel"===n&&(r=1.05);var c=Pi/(512*this.overscaling)*15,h=t[u],p=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray);this.distance=0;var f,d,m,v=i,g=s?"butt":i,y=!0,_=void 0,x=void 0,b=void 0,w=void 0;this.e1=this.e2=this.e3=-1,s&&(f=t[l-2],w=h.sub(f)._unit()._perp());for(var E=u;E<l;E++)if(!(x=s&&E===l-1?t[u+1]:t[E+1])||!t[E].equals(x)){w&&(b=w),f&&(_=f),f=t[E],w=x?x.sub(f)._unit()._perp():b;var S=(b=b||w).add(w);0===S.x&&0===S.y||S._unit();var C=S.x*w.x+S.y*w.y,T=0!==C?1/C:1/0,A=C<yo&&_&&x;if(A&&E>u){var M=f.dist(_);if(M>2*c){var I=f.sub(f.sub(_)._mult(c/M)._round());this.distance+=I.dist(_),this.addCurrentVertex(I,this.distance,b.mult(1),0,0,!1,p,a),_=I}}var k=_&&x,z=k?n:x?v:g;if(k&&"round"===z&&(T<o?z="miter":T<=2&&(z="fakeround")),"miter"===z&&T>r&&(z="bevel"),"bevel"===z&&(T>2&&(z="flipbevel"),T<r&&(z="miter")),_&&(this.distance+=f.dist(_)),"miter"===z)S._mult(T),this.addCurrentVertex(f,this.distance,S,0,0,!1,p,a);else if("flipbevel"===z){if(T>100)S=w.clone().mult(-1);else{var D=b.x*w.y-b.y*w.x>0?-1:1,L=T*b.add(w).mag()/b.sub(w).mag();S._perp()._mult(L*D)}this.addCurrentVertex(f,this.distance,S,0,0,!1,p,a),this.addCurrentVertex(f,this.distance,S.mult(-1),0,0,!1,p,a)}else if("bevel"===z||"fakeround"===z){var P=b.x*w.y-b.y*w.x>0,O=-Math.sqrt(T*T-1);if(P?(m=0,d=O):(d=0,m=O),y||this.addCurrentVertex(f,this.distance,b,d,m,!1,p,a),"fakeround"===z){for(var R=Math.floor(8*(.5-(C-.5))),B=void 0,F=0;F<R;F++)B=w.mult((F+1)/(R+1))._add(b)._unit(),this.addPieSliceVertex(f,this.distance,B,P,p,a);this.addPieSliceVertex(f,this.distance,S,P,p,a);for(var N=R-1;N>=0;N--)B=b.mult((N+1)/(R+1))._add(w)._unit(),this.addPieSliceVertex(f,this.distance,B,P,p,a)}x&&this.addCurrentVertex(f,this.distance,w,-d,-m,!1,p,a)}else"butt"===z?(y||this.addCurrentVertex(f,this.distance,b,0,0,!1,p,a),x&&this.addCurrentVertex(f,this.distance,w,0,0,!1,p,a)):"square"===z?(y||(this.addCurrentVertex(f,this.distance,b,1,1,!1,p,a),this.e1=this.e2=-1),x&&this.addCurrentVertex(f,this.distance,w,-1,-1,!1,p,a)):"round"===z&&(y||(this.addCurrentVertex(f,this.distance,b,0,0,!1,p,a),this.addCurrentVertex(f,this.distance,b,1,1,!0,p,a),this.e1=this.e2=-1),x&&(this.addCurrentVertex(f,this.distance,w,-1,-1,!0,p,a),this.addCurrentVertex(f,this.distance,w,0,0,!1,p,a)));if(A&&E<l-1){var V=f.dist(x);if(V>2*c){var j=f.add(x.sub(f)._mult(c/V)._round());this.distance+=j.dist(f),this.addCurrentVertex(j,this.distance,w.mult(1),0,0,!1,p,a),f=j}}y=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e)}},wo.prototype.addCurrentVertex=function(t,e,n,i,r,o,a,s){var l,u=this.layoutVertexArray,c=this.indexArray;s&&(e=Eo(e,s)),l=n.clone(),i&&l._sub(n.perp()._mult(i)),bo(u,t,l,o,!1,i,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,l=n.mult(-1),r&&l._sub(n.perp()._mult(r)),bo(u,t,l,o,!0,-r,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,e>xo/2&&!s&&(this.distance=0,this.addCurrentVertex(t,this.distance,n,i,r,o,a))},wo.prototype.addPieSliceVertex=function(t,e,n,i,r,o){n=n.mult(i?-1:1);var a=this.layoutVertexArray,s=this.indexArray;o&&(e=Eo(e,o)),bo(a,t,n,!1,i,0,e),this.e3=r.vertexLength++,this.e1>=0&&this.e2>=0&&(s.emplaceBack(this.e1,this.e2,this.e3),r.primitiveLength++),i?this.e2=this.e3:this.e1=this.e3},fn("LineBucket",wo,{omit:["layers"]});var So=new qn({"line-cap":new Nn(D.layout_line["line-cap"]),"line-join":new Vn(D.layout_line["line-join"]),"line-miter-limit":new Nn(D.layout_line["line-miter-limit"]),"line-round-limit":new Nn(D.layout_line["line-round-limit"])}),Co={paint:new qn({"line-opacity":new Vn(D.paint_line["line-opacity"]),"line-color":new Vn(D.paint_line["line-color"]),"line-translate":new Nn(D.paint_line["line-translate"]),"line-translate-anchor":new Nn(D.paint_line["line-translate-anchor"]),"line-width":new Vn(D.paint_line["line-width"]),"line-gap-width":new Vn(D.paint_line["line-gap-width"]),"line-offset":new Vn(D.paint_line["line-offset"]),"line-blur":new Vn(D.paint_line["line-blur"]),"line-dasharray":new jn(D.paint_line["line-dasharray"]),"line-pattern":new jn(D.paint_line["line-pattern"]),"line-gradient":new Un(D.paint_line["line-gradient"])}),layout:So},To=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(e,n){return n=new kn(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),t.prototype.possiblyEvaluate.call(this,e,n)},e.prototype.evaluate=function(e,n,i){return n=p({},n,{zoom:Math.floor(n.zoom)}),t.prototype.evaluate.call(this,e,n,i)},e}(Vn))(Co.paint.properties["line-width"].specification);To.useIntegerZoom=!0;var Ao=(function(t){function e(e){t.call(this,e,Co)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setPaintProperty=function(e,n,i){t.prototype.setPaintProperty.call(this,e,n,i),"line-gradient"===e&&this._updateGradient()},e.prototype._updateGradient=function(){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=hr(t,"lineProgress"),this.gradientTexture=null},e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),this.paint._values["line-floorwidth"]=To.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new wo(t)},e.prototype.queryRadius=function(t){var e=t,n=Mo(Hi("line-width",this,e),Hi("line-gap-width",this,e)),i=Hi("line-offset",this,e);return n/2+Math.abs(i)+Xi(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o){var a=Ki(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),r.angle,o),l=o/2*Mo(this.paint.get("line-width").evaluate(e),this.paint.get("line-gap-width").evaluate(e)),u=this.paint.get("line-offset").evaluate(e);return u&&(n=(function(t,e){for(var n=[],i=new s(0,0),r=0;r<t.length;r++){for(var o=t[r],a=[],l=0;l<o.length;l++){var u=o[l-1],c=o[l],h=o[l+1],p=0===l?i:c.sub(u)._unit()._perp(),f=l===o.length-1?i:h.sub(c)._unit()._perp(),d=p._add(f)._unit(),m=d.x*f.x+d.y*f.y;d._mult(1/m),a.push(d._mult(e)._add(c))}n.push(a)}return n})(n,u*o)),ji(a,n,l)},e})($n);function Mo(t,e){return e>0?e+2*t:t}var Io=Yn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),ko=Yn([{name:"a_projected_pos",components:3,type:"Float32"}],4),zo=(Yn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Yn([{name:"a_placed",components:2,type:"Uint8"}],4)),Do=(Yn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),Yn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Lo=Yn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);function Po(t,e,n){var i=e.layout.get("text-transform").evaluate(n);return"uppercase"===i?t=t.toLocaleUpperCase():"lowercase"===i&&(t=t.toLocaleLowerCase()),In.applyArabicShaping&&(t=In.applyArabicShaping(t)),t}Yn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"}]),Yn([{type:"Float32",name:"offsetX"}]),Yn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Oo={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},Ro=(function(t){function e(e,n,i,r){t.call(this,e,n),this.angle=i,void 0!==r&&(this.segment=r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e})(s);function Bo(t,e){var n=e.expression;if("constant"===n.kind)return{functionType:"constant",layoutSize:n.evaluate(new kn(t+1))};if("source"===n.kind)return{functionType:"source"};for(var i=n.zoomStops,r=0;r<i.length&&i[r]<=t;)r++;for(var o=r=Math.max(0,r-1);o<i.length&&i[o]<t+1;)o++;o=Math.min(i.length-1,o);var a={min:i[r],max:i[o]};return"composite"===n.kind?{functionType:"composite",zoomRange:a,propertyValue:e.value}:{functionType:"camera",layoutSize:n.evaluate(new kn(t+1)),zoomRange:a,sizeRange:{min:n.evaluate(new kn(a.min)),max:n.evaluate(new kn(a.max))},propertyValue:e.value}}fn("Anchor",Ro);var Fo=mo.VectorTileFeature.types,No=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Vo(t,e,n,i,r,o,a,s){t.emplaceBack(e,n,Math.round(32*i),Math.round(32*r),o,a,s?s[0]:0,s?s[1]:0)}function jo(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}var Uo=function(t){this.layoutVertexArray=new ti,this.indexArray=new ci,this.programConfigurations=t,this.segments=new Ci,this.dynamicLayoutVertexArray=new ei,this.opacityVertexArray=new ni,this.placedSymbolArray=new gi};Uo.prototype.upload=function(t,e){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Io.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.programConfigurations.upload(t),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,ko.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,No,!0),this.opacityVertexBuffer.itemSize=1},Uo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},fn("SymbolBuffers",Uo);var qo=function(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new Ci,this.collisionVertexArray=new oi};qo.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,zo.members,!0)},qo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},fn("CollisionBuffers",qo);var $o=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex;var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Bo(this.zoom,e["text-size"]),this.iconSizeData=Bo(this.zoom,e["icon-size"]);var n=this.layers[0].layout;this.sortFeaturesByY=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement")};$o.prototype.createArrays=function(){this.text=new Uo(new Di(Io.members,this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new Uo(new Di(Io.members,this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.collisionBox=new qo(ri,Do.members,hi),this.collisionCircle=new qo(ri,Lo.members,ci),this.glyphOffsetArray=new _i,this.lineVertexArray=new bi},$o.prototype.populate=function(t,e){var n=this.layers[0],i=n.layout,r=i.get("text-font"),o=i.get("text-field"),a=i.get("icon-image"),s=("constant"!==o.value.kind||o.value.value.length>0)&&("constant"!==r.value.kind||r.value.value.length>0),l="constant"!==a.value.kind||a.value.value&&a.value.value.length>0;if(this.features=[],s||l){for(var u=e.iconDependencies,c=e.glyphDependencies,h=new kn(this.zoom),p=0,f=t;p<f.length;p+=1){var d=f[p],m=d.feature,v=d.index,g=d.sourceLayerIndex;if(n._featureFilter(h,m)){var y=void 0;s&&(y=Po(y=n.getValueAndResolveTokens("text-field",m),n,m));var _=void 0;if(l&&(_=n.getValueAndResolveTokens("icon-image",m)),y||_){var x={text:y,icon:_,index:v,sourceLayerIndex:g,geometry:Ri(m),properties:m.properties,type:Fo[m.type]};if(void 0!==m.id&&(x.id=m.id),this.features.push(x),_&&(u[_]=!0),y)for(var b=r.evaluate(m).join(","),w=c[b]=c[b]||{},E="map"===i.get("text-rotation-alignment")&&"line"===i.get("symbol-placement"),S=_n(y),C=0;C<y.length;C++)if(w[y.charCodeAt(C)]=!0,E&&S){var T=Oo[y.charAt(C)];T&&(w[T.charCodeAt(0)]=!0)}}}}"line"===i.get("symbol-placement")&&(this.features=(function(t){var e={},n={},i=[],r=0;function o(e){i.push(t[e]),r++}function a(t,e,r){var o=n[t];return delete n[t],n[e]=o,i[o].geometry[0].pop(),i[o].geometry[0]=i[o].geometry[0].concat(r[0]),o}function s(t,n,r){var o=e[n];return delete e[n],e[t]=o,i[o].geometry[0].shift(),i[o].geometry[0]=r[0].concat(i[o].geometry[0]),o}function l(t,e,n){var i=n?e[0][e[0].length-1]:e[0][0];return t+":"+i.x+":"+i.y}for(var u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.text;if(p){var f=l(p,h),d=l(p,h,!0);if(f in n&&d in e&&n[f]!==e[d]){var m=s(f,d,h),v=a(f,d,i[m].geometry);delete e[f],delete n[d],n[l(p,i[v].geometry,!0)]=v,i[m].geometry=null}else f in n?a(f,d,h):d in e?s(f,d,h):(o(u),e[f]=r-1,n[d]=r-1)}else o(u)}return i.filter((function(t){return t.geometry}))})(this.features))}},$o.prototype.isEmpty=function(){return 0===this.symbolInstances.length},$o.prototype.upload=function(t){this.text.upload(t,this.sortFeaturesByY),this.icon.upload(t,this.sortFeaturesByY),this.collisionBox.upload(t),this.collisionCircle.upload(t)},$o.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},$o.prototype.addToLineVertexArray=function(t,e){var n=this.lineVertexArray.length;if(void 0!==t.segment){for(var i=t.dist(e[t.segment+1]),r=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:i},a<e.length-1&&(i+=e[a+1].dist(e[a]));for(var s=t.segment||0;s>=0;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:r},s>0&&(r+=e[s-1].dist(e[s]));for(var l=0;l<e.length;l++){var u=o[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}},$o.prototype.addSymbols=function(t,e,n,i,r,o,a,s,l,u){for(var c=t.indexArray,h=t.layoutVertexArray,p=t.dynamicLayoutVertexArray,f=t.segments.prepareSegment(4*e.length,t.layoutVertexArray,t.indexArray),d=this.glyphOffsetArray.length,m=f.vertexLength,v=0,g=e;v<g.length;v+=1){var y=g[v],_=y.tl,x=y.tr,b=y.bl,w=y.br,E=y.tex,S=f.vertexLength,C=y.glyphOffset[1];Vo(h,s.x,s.y,_.x,C+_.y,E.x,E.y,n),Vo(h,s.x,s.y,x.x,C+x.y,E.x+E.w,E.y,n),Vo(h,s.x,s.y,b.x,C+b.y,E.x,E.y+E.h,n),Vo(h,s.x,s.y,w.x,C+w.y,E.x+E.w,E.y+E.h,n),jo(p,s,0),c.emplaceBack(S,S+1,S+2),c.emplaceBack(S+1,S+2,S+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(y.glyphOffset[0])}t.placedSymbolArray.emplaceBack(s.x,s.y,d,this.glyphOffsetArray.length-d,m,l,u,s.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],a,!1),t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,o)},$o.prototype._addCollisionDebugVertex=function(t,e,n,i,r){return e.emplaceBack(0,0),t.emplaceBack(n.x,n.y,i.x,i.y,Math.round(r.x),Math.round(r.y))},$o.prototype.addCollisionDebugVertices=function(t,e,n,i,r,o,a,l){var u=r.segments.prepareSegment(4,r.layoutVertexArray,r.indexArray),c=u.vertexLength,h=r.layoutVertexArray,p=r.collisionVertexArray;if(this._addCollisionDebugVertex(h,p,o,a.anchor,new s(t,e)),this._addCollisionDebugVertex(h,p,o,a.anchor,new s(n,e)),this._addCollisionDebugVertex(h,p,o,a.anchor,new s(n,i)),this._addCollisionDebugVertex(h,p,o,a.anchor,new s(t,i)),u.vertexLength+=4,l){var f=r.indexArray;f.emplaceBack(c,c+1,c+2),f.emplaceBack(c,c+2,c+3),u.primitiveLength+=2}else{var d=r.indexArray;d.emplaceBack(c,c+1),d.emplaceBack(c+1,c+2),d.emplaceBack(c+2,c+3),d.emplaceBack(c+3,c),u.primitiveLength+=4}},$o.prototype.generateCollisionDebugBuffers=function(){for(var t=0,e=this.symbolInstances;t<e.length;t+=1){var n=e[t];n.textCollisionFeature={boxStartIndex:n.textBoxStartIndex,boxEndIndex:n.textBoxEndIndex},n.iconCollisionFeature={boxStartIndex:n.iconBoxStartIndex,boxEndIndex:n.iconBoxEndIndex};for(var i=0;i<2;i++){var r=n[0===i?"textCollisionFeature":"iconCollisionFeature"];if(r)for(var o=r.boxStartIndex;o<r.boxEndIndex;o++){var a=this.collisionBoxArray.get(o),s=a.x1,l=a.y1,u=a.x2,c=a.y2,h=a.radius>0;this.addCollisionDebugVertices(s,l,u,c,h?this.collisionCircle:this.collisionBox,a.anchorPoint,n,h)}}}},$o.prototype.deserializeCollisionBoxes=function(t,e,n,i,r){for(var o={},a=e;a<n;a++){var s=t.get(a);if(0===s.radius){o.textBox={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,anchorPointX:s.anchorPointX,anchorPointY:s.anchorPointY},o.textFeatureIndex=s.featureIndex;break}o.textCircles||(o.textCircles=[],o.textFeatureIndex=s.featureIndex),o.textCircles.push(s.anchorPointX,s.anchorPointY,s.radius,s.signedDistanceFromAnchor,1)}for(var l=i;l<r;l++){var u=t.get(l);if(0===u.radius){o.iconBox={x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,anchorPointX:u.anchorPointX,anchorPointY:u.anchorPointY},o.iconFeatureIndex=u.featureIndex;break}}return o},$o.prototype.hasTextData=function(){return this.text.segments.get().length>0},$o.prototype.hasIconData=function(){return this.icon.segments.get().length>0},$o.prototype.hasCollisionBoxData=function(){return this.collisionBox.segments.get().length>0},$o.prototype.hasCollisionCircleData=function(){return this.collisionCircle.segments.get().length>0},$o.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&(this.sortedAngle=t,!(this.text.segments.get().length>1||this.icon.segments.get().length>1))){for(var n=[],i=0;i<this.symbolInstances.length;i++)n.push(i);var r=Math.sin(t),o=Math.cos(t);n.sort((function(t,n){var i=e.symbolInstances[t],a=e.symbolInstances[n];return(r*i.anchor.x+o*i.anchor.y|0)-(r*a.anchor.x+o*a.anchor.y|0)||a.featureIndex-i.featureIndex})),this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var a=0,s=n;a<s.length;a+=1){var l=s[a],u=e.symbolInstances[l];e.featureSortOrder.push(u.featureIndex);for(var c=0,h=u.placedTextSymbolIndices;c<h.length;c+=1)for(var p=h[c],f=e.text.placedSymbolArray.get(p),d=f.vertexStartIndex+4*f.numGlyphs,m=f.vertexStartIndex;m<d;m+=4)e.text.indexArray.emplaceBack(m,m+1,m+2),e.text.indexArray.emplaceBack(m+1,m+2,m+3);var v=e.icon.placedSymbolArray.get(l);if(v.numGlyphs){var g=v.vertexStartIndex;e.icon.indexArray.emplaceBack(g,g+1,g+2),e.icon.indexArray.emplaceBack(g+1,g+2,g+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},fn("SymbolBucket",$o,{omit:["layers","collisionBoxArray","features","compareText"],shallow:["symbolInstances"]}),$o.MAX_GLYPHS=65535,$o.addDynamicAttributes=jo;var Zo=new qn({"symbol-placement":new Nn(D.layout_symbol["symbol-placement"]),"symbol-spacing":new Nn(D.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Nn(D.layout_symbol["symbol-avoid-edges"]),"icon-allow-overlap":new Nn(D.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Nn(D.layout_symbol["icon-ignore-placement"]),"icon-optional":new Nn(D.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Nn(D.layout_symbol["icon-rotation-alignment"]),"icon-size":new Vn(D.layout_symbol["icon-size"]),"icon-text-fit":new Nn(D.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Nn(D.layout_symbol["icon-text-fit-padding"]),"icon-image":new Vn(D.layout_symbol["icon-image"]),"icon-rotate":new Vn(D.layout_symbol["icon-rotate"]),"icon-padding":new Nn(D.layout_symbol["icon-padding"]),"icon-keep-upright":new Nn(D.layout_symbol["icon-keep-upright"]),"icon-offset":new Vn(D.layout_symbol["icon-offset"]),"icon-anchor":new Vn(D.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Nn(D.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Nn(D.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Nn(D.layout_symbol["text-rotation-alignment"]),"text-field":new Vn(D.layout_symbol["text-field"]),"text-font":new Vn(D.layout_symbol["text-font"]),"text-size":new Vn(D.layout_symbol["text-size"]),"text-max-width":new Vn(D.layout_symbol["text-max-width"]),"text-line-height":new Nn(D.layout_symbol["text-line-height"]),"text-letter-spacing":new Vn(D.layout_symbol["text-letter-spacing"]),"text-justify":new Vn(D.layout_symbol["text-justify"]),"text-anchor":new Vn(D.layout_symbol["text-anchor"]),"text-max-angle":new Nn(D.layout_symbol["text-max-angle"]),"text-rotate":new Vn(D.layout_symbol["text-rotate"]),"text-padding":new Nn(D.layout_symbol["text-padding"]),"text-keep-upright":new Nn(D.layout_symbol["text-keep-upright"]),"text-transform":new Vn(D.layout_symbol["text-transform"]),"text-offset":new Vn(D.layout_symbol["text-offset"]),"text-allow-overlap":new Nn(D.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Nn(D.layout_symbol["text-ignore-placement"]),"text-optional":new Nn(D.layout_symbol["text-optional"])}),Go={paint:new qn({"icon-opacity":new Vn(D.paint_symbol["icon-opacity"]),"icon-color":new Vn(D.paint_symbol["icon-color"]),"icon-halo-color":new Vn(D.paint_symbol["icon-halo-color"]),"icon-halo-width":new Vn(D.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Vn(D.paint_symbol["icon-halo-blur"]),"icon-translate":new Nn(D.paint_symbol["icon-translate"]),"icon-translate-anchor":new Nn(D.paint_symbol["icon-translate-anchor"]),"text-opacity":new Vn(D.paint_symbol["text-opacity"]),"text-color":new Vn(D.paint_symbol["text-color"]),"text-halo-color":new Vn(D.paint_symbol["text-halo-color"]),"text-halo-width":new Vn(D.paint_symbol["text-halo-width"]),"text-halo-blur":new Vn(D.paint_symbol["text-halo-blur"]),"text-translate":new Nn(D.paint_symbol["text-translate"]),"text-translate-anchor":new Nn(D.paint_symbol["text-translate-anchor"])}),layout:Zo},Wo=(function(t){function e(e){t.call(this,e,Go)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),"auto"===this.layout.get("icon-rotation-alignment")&&("line"===this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("line"===this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"))},e.prototype.getValueAndResolveTokens=function(t,e){var n,i=this.layout.get(t).evaluate(e),r=this._unevaluatedLayout._values[t];return r.isDataDriven()||xe(r.value)?i:(n=e.properties,i.replace(/{([^{}]+)}/g,(function(t,e){return e in n?String(n[e]):""})))},e.prototype.createBucket=function(t){return new $o(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e})($n),Yo={paint:new qn({"background-color":new Nn(D.paint_background["background-color"]),"background-pattern":new jn(D.paint_background["background-pattern"]),"background-opacity":new Nn(D.paint_background["background-opacity"])})},Ho=(function(t){function e(e){t.call(this,e,Yo)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e})($n),Xo={paint:new qn({"raster-opacity":new Nn(D.paint_raster["raster-opacity"]),"raster-hue-rotate":new Nn(D.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Nn(D.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Nn(D.paint_raster["raster-brightness-max"]),"raster-saturation":new Nn(D.paint_raster["raster-saturation"]),"raster-contrast":new Nn(D.paint_raster["raster-contrast"]),"raster-fade-duration":new Nn(D.paint_raster["raster-fade-duration"])})},Ko={circle:nr,heatmap:pr,hillshade:dr,fill:Xr,"fill-extrusion":ro,line:Ao,symbol:Wo,background:Ho,raster:(function(t){function e(e){t.call(this,e,Xo)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e})($n)},Jo=i((function(t,e){t.exports=(function(){function t(t,e,n){n=n||{},this.w=t||64,this.h=e||64,this.autoResize=!!n.autoResize,this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0}function e(t,e,n){this.x=0,this.y=t,this.w=this.free=e,this.h=n}return t.prototype.pack=function(t,e){t=[].concat(t),e=e||{};for(var n,i,r,o,a=[],s=0;s<t.length;s++)if(n=t[s].w||t[s].width,i=t[s].h||t[s].height,r=t[s].id,n&&i){if(!(o=this.packOne(n,i,r)))continue;e.inPlace&&(t[s].x=o.x,t[s].y=o.y,t[s].id=o.id),a.push(o)}return this.shrink(),a},t.prototype.packOne=function(t,n,i){var r,o,a,s,l,u,c,h,p={freebin:-1,shelf:-1,waste:1/0},f=0;if("string"==typeof i||"number"==typeof i){if(r=this.getBin(i))return this.ref(r),r;"number"==typeof i&&(this.maxId=Math.max(i,this.maxId))}else i=++this.maxId;for(s=0;s<this.freebins.length;s++){if(n===(r=this.freebins[s]).maxh&&t===r.maxw)return this.allocFreebin(s,t,n,i);n>r.maxh||t>r.maxw||n<=r.maxh&&t<=r.maxw&&(a=r.maxw*r.maxh-t*n)<p.waste&&(p.waste=a,p.freebin=s)}for(s=0;s<this.shelves.length;s++)if(f+=(o=this.shelves[s]).h,!(t>o.free)){if(n===o.h)return this.allocShelf(s,t,n,i);n>o.h||n<o.h&&(a=(o.h-n)*t)<p.waste&&(p.freebin=-1,p.waste=a,p.shelf=s)}return-1!==p.freebin?this.allocFreebin(p.freebin,t,n,i):-1!==p.shelf?this.allocShelf(p.shelf,t,n,i):n<=this.h-f&&t<=this.w?(o=new e(f,this.w,n),this.allocShelf(this.shelves.push(o)-1,t,n,i)):this.autoResize?(l=u=this.h,((c=h=this.w)<=l||t>c)&&(h=2*Math.max(t,c)),(l<c||n>l)&&(u=2*Math.max(n,l)),this.resize(h,u),this.packOne(t,n,i)):null},t.prototype.allocFreebin=function(t,e,n,i){var r=this.freebins.splice(t,1)[0];return r.id=i,r.w=e,r.h=n,r.refcount=0,this.bins[i]=r,this.ref(r),r},t.prototype.allocShelf=function(t,e,n,i){var r=this.shelves[t].alloc(e,n,i);return this.bins[i]=r,this.ref(r),r},t.prototype.shrink=function(){if(this.shelves.length>0){for(var t=0,e=0,n=0;n<this.shelves.length;n++){var i=this.shelves[n];e+=i.h,t=Math.max(i.w-i.free,t)}this.resize(t,e)}},t.prototype.getBin=function(t){return this.bins[t]},t.prototype.ref=function(t){if(1==++t.refcount){var e=t.h;this.stats[e]=1+(0|this.stats[e])}return t.refcount},t.prototype.unref=function(t){return 0===t.refcount?0:(0==--t.refcount&&(this.stats[t.h]--,delete this.bins[t.id],this.freebins.push(t)),t.refcount)},t.prototype.clear=function(){this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0},t.prototype.resize=function(t,e){this.w=t,this.h=e;for(var n=0;n<this.shelves.length;n++)this.shelves[n].resize(t);return!0},e.prototype.alloc=function(t,e,n){if(t>this.free||e>this.h)return null;var i=this.x;return this.x+=t,this.free-=t,new function(t,e,n,i,r,o,a){this.id=t,this.x=e,this.y=n,this.w=i,this.h=r,this.maxw=o||i,this.maxh=a||r,this.refcount=0}(n,i,this.y,t,e,t,this.h)},e.prototype.resize=function(t){return this.free+=t-this.w,this.w=t,!0},t})()})),Qo=function(t,e){var n=e.pixelRatio;this.paddedRect=t,this.pixelRatio=n},ta={tl:{configurable:!0},br:{configurable:!0},displaySize:{configurable:!0}};ta.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},ta.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},ta.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Qo.prototype,ta);var ea=function(t){var e=new ur({width:0,height:0}),n={},i=new Jo(0,0,{autoResize:!0});for(var r in t){var o=t[r],a=i.packOne(o.data.width+2,o.data.height+2);e.resize({width:i.w,height:i.h}),ur.copy(o.data,e,{x:0,y:0},{x:a.x+1,y:a.y+1},o.data),n[r]=new Qo(a,o)}i.shrink(),e.resize({width:i.w,height:i.h}),this.image=e,this.positions=n};fn("ImagePosition",Qo),fn("ImageAtlas",ea);var na=function(t,e,n,i,r){var o,a,s=8*r-i-1,l=(1<<s)-1,u=l>>1,c=-7,h=n?r-1:0,p=n?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-c)-1,f>>=-c,c+=s;c>0;o=256*o+t[e+h],h+=p,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=i;c>0;a=256*a+t[e+h],h+=p,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,i),o-=u}return(f?-1:1)*a*Math.pow(2,o-i)},ia=function(t,e,n,i,r,o){var a,s,l,u=8*o-r-1,c=(1<<u)-1,h=c>>1,p=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:o-1,d=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*l-1)*Math.pow(2,r),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;t[n+f]=255&s,f+=d,s/=256,r-=8);for(a=a<<r|s,u+=r;u>0;t[n+f]=255&a,f+=d,a/=256,u-=8);t[n+f-d]|=128*m},ra=oa;function oa(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}function aa(t){return t.type===oa.Bytes?t.readVarint()+t.pos:t.pos+1}function sa(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function la(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function ua(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function ca(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function ha(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function pa(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function fa(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function da(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function ma(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function va(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function ga(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function ya(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function _a(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function xa(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}oa.Varint=0,oa.Fixed64=1,oa.Bytes=2,oa.Fixed32=5,oa.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,o=this.pos;this.type=7&i,t(r,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=ya(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=xa(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=ya(this.buf,this.pos)+4294967296*ya(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=ya(this.buf,this.pos)+4294967296*xa(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=na(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=na(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:(function(t,e,n){var i,r,o=n.buf;if(i=(112&(r=o[n.pos++]))>>4,r<128)return sa(t,i,e);if(i|=(127&(r=o[n.pos++]))<<3,r<128)return sa(t,i,e);if(i|=(127&(r=o[n.pos++]))<<10,r<128)return sa(t,i,e);if(i|=(127&(r=o[n.pos++]))<<17,r<128)return sa(t,i,e);if(i|=(127&(r=o[n.pos++]))<<24,r<128)return sa(t,i,e);if(i|=(1&(r=o[n.pos++]))<<31,r<128)return sa(t,i,e);throw new Error("Expected varint not more than 10 bytes")})(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=(function(t,e,n){for(var i="",r=e;r<n;){var o,a,s,l=t[r],u=null,c=l>239?4:l>223?3:l>191?2:1;if(r+c>n)break;1===c?l<128&&(u=l):2===c?128==(192&(o=t[r+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(o=t[r+1],a=t[r+2],128==(192&o)&&128==(192&a)&&((u=(15&l)<<12|(63&o)<<6|63&a)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(o=t[r+1],a=t[r+2],s=t[r+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,i+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),i+=String.fromCharCode(u),r+=c}return i})(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var n=aa(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=aa(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=aa(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=aa(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=aa(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=aa(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=aa(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=aa(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=aa(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===oa.Varint)for(;this.buf[this.pos++]>127;);else if(e===oa.Bytes)this.pos=this.readVarint()+this.pos;else if(e===oa.Fixed32)this.pos+=4;else{if(e!==oa.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),_a(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),_a(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),_a(this.buf,-1&t,this.pos),_a(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),_a(this.buf,-1&t,this.pos),_a(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?(function(t,e){var n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),(function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t})(n,0,e),(function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))})(i,e)})(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=(function(t,e,n){for(var i,r,o=0;o<e.length;o++){if((i=e.charCodeAt(o))>55295&&i<57344){if(!r){i>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n})(this.buf,t,this.pos);var n=this.pos-e;n>=128&&la(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),ia(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ia(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&la(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,oa.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){this.writeMessage(t,ua,e)},writePackedSVarint:function(t,e){this.writeMessage(t,ca,e)},writePackedBoolean:function(t,e){this.writeMessage(t,fa,e)},writePackedFloat:function(t,e){this.writeMessage(t,ha,e)},writePackedDouble:function(t,e){this.writeMessage(t,pa,e)},writePackedFixed32:function(t,e){this.writeMessage(t,da,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,ma,e)},writePackedFixed64:function(t,e){this.writeMessage(t,va,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,ga,e)},writeBytesField:function(t,e){this.writeTag(t,oa.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,oa.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,oa.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,oa.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,oa.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,oa.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,oa.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,oa.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,oa.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,oa.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var ba=3;function wa(t,e,n){1===t&&n.readMessage(Ea,e)}function Ea(t,e,n){if(3===t){var i=n.readMessage(Sa,{}),r=i.id,o=i.bitmap,a=i.width,s=i.height,l=i.left,u=i.top,c=i.advance;e.push({id:r,bitmap:new lr({width:a+2*ba,height:s+2*ba},o),metrics:{width:a,height:s,left:l,top:u,advance:c}})}}function Sa(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}var Ca=ba,Ta=function(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.callbackID=0,d(["receive"],this),this.target.addEventListener("message",this.receive,!1)};Ta.prototype.send=function(t,e,n,i){var r=n?this.mapId+":"+this.callbackID++:null;n&&(this.callbacks[r]=n);var o=[];this.target.postMessage({targetMapId:i,sourceMapId:this.mapId,type:t,id:String(r),data:mn(e,o)},o)},Ta.prototype.receive=function(t){var e,n=this,i=t.data,r=i.id;if(!i.targetMapId||this.mapId===i.targetMapId){var o=function(t,e){var i=[];n.target.postMessage({sourceMapId:n.mapId,type:"<response>",id:String(r),error:t?mn(t):null,data:mn(e,i)},i)};if("<response>"===i.type)e=this.callbacks[i.id],delete this.callbacks[i.id],e&&i.error?e(vn(i.error)):e&&e(null,vn(i.data));else if(void 0!==i.id&&this.parent[i.type])this.parent[i.type](i.sourceMapId,vn(i.data),o);else if(void 0!==i.id&&this.parent.getWorkerSource){var a=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,a[0],a[1])[a[2]](vn(i.data),o)}else this.parent[i.type](vn(i.data))}},Ta.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};var Aa=n(i((function(t,e){!(function(t){function e(t,e,i){var r=n(256*t,256*(e=Math.pow(2,i)-e-1),i),o=n(256*(t+1),256*(e+1),i);return r[0]+","+r[1]+","+o[0]+","+o[1]}function n(t,e,n){var i=2*Math.PI*6378137/256/Math.pow(2,n);return[t*i-2*Math.PI*6378137/2,e*i-2*Math.PI*6378137/2]}t.getURL=function(t,n,i,r,o,a){return a=a||{},t+"?"+["bbox="+e(i,r,o),"format="+(a.format||"image/png"),"service="+(a.service||"WMS"),"version="+(a.version||"1.1.1"),"request="+(a.request||"GetMap"),"srs="+(a.srs||"EPSG:3857"),"width="+(a.width||256),"height="+(a.height||256),"layers="+n].join("&")},t.getTileBBox=e,t.getMercCoords=n,Object.defineProperty(t,"__esModule",{value:!0})})(e)}))),Ma=function(t,e,n){this.z=t,this.x=e,this.y=n,this.key=za(0,t,e,n)};Ma.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Ma.prototype.url=function(t,e){var n=Aa.getTileBBox(this.x,this.y,this.z),i=(function(t,e,n){for(var i,r="",o=t;o>0;o--)r+=(e&(i=1<<o-1)?1:0)+(n&i?2:0);return r})(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",i).replace("{bbox-epsg-3857}",n)};var Ia=function(t,e){this.wrap=t,this.canonical=e,this.key=za(t,e.z,e.x,e.y)},ka=function(t,e,n,i,r){this.overscaledZ=t,this.wrap=e,this.canonical=new Ma(n,+i,+r),this.key=za(e,t,i,r)};function za(t,e,n,i){(t*=2)<0&&(t=-1*t-1);var r=1<<e;return 32*(r*r*t+r*i+n)+e}ka.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},ka.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new ka(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ka(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},ka.prototype.isChildOf=function(t){var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},ka.prototype.children=function(t){if(this.overscaledZ>=t)return[new ka(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,n=2*this.canonical.x,i=2*this.canonical.y;return[new ka(e,this.wrap,e,n,i),new ka(e,this.wrap,e,n+1,i),new ka(e,this.wrap,e,n,i+1),new ka(e,this.wrap,e,n+1,i+1)]},ka.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},ka.prototype.wrapped=function(){return new ka(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},ka.prototype.unwrapTo=function(t){return new ka(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},ka.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},ka.prototype.toUnwrapped=function(){return new Ia(this.wrap,this.canonical)},ka.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},ka.prototype.toCoordinate=function(){return new a(this.canonical.x+Math.pow(2,this.wrap),this.canonical.y,this.canonical.z)},fn("CanonicalTileID",Ma),fn("OverscaledTileID",ka,{omit:["posMatrix"]});var Da=function(t,e,n){if(t<=0)throw new RangeError("Level must have positive dimension");this.dim=t,this.border=e,this.stride=this.dim+2*this.border,this.data=n||new Int32Array((this.dim+2*this.border)*(this.dim+2*this.border))};Da.prototype.set=function(t,e,n){this.data[this._idx(t,e)]=n+65536},Da.prototype.get=function(t,e){return this.data[this._idx(t,e)]-65536},Da.prototype._idx=function(t,e){if(t<-this.border||t>=this.dim+this.border||e<-this.border||e>=this.dim+this.border)throw new RangeError("out of range source coordinates for DEM data");return(e+this.border)*this.stride+(t+this.border)},fn("Level",Da);var La=function(t,e,n){this.uid=t,this.scale=e||1,this.level=n||new Da(256,512),this.loaded=!!n};La.prototype.loadFromImage=function(t,e){if(t.height!==t.width)throw new RangeError("DEM tiles must be square");if(e&&"mapbox"!==e&&"terrarium"!==e)return x('"'+e+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');var n=this.level=new Da(t.width,t.width/2),i=t.data;this._unpackData(n,i,e||"mapbox");for(var r=0;r<n.dim;r++)n.set(-1,r,n.get(0,r)),n.set(n.dim,r,n.get(n.dim-1,r)),n.set(r,-1,n.get(r,0)),n.set(r,n.dim,n.get(r,n.dim-1));n.set(-1,-1,n.get(0,0)),n.set(n.dim,-1,n.get(n.dim-1,0)),n.set(-1,n.dim,n.get(0,n.dim-1)),n.set(n.dim,n.dim,n.get(n.dim-1,n.dim-1)),this.loaded=!0},La.prototype._unpackMapbox=function(t,e,n){return(256*t*256+256*e+n)/10-1e4},La.prototype._unpackTerrarium=function(t,e,n){return 256*t+e+n/256-32768},La.prototype._unpackData=function(t,e,n){for(var i={mapbox:this._unpackMapbox,terrarium:this._unpackTerrarium}[n],r=0;r<t.dim;r++)for(var o=0;o<t.dim;o++){var a=4*(r*t.dim+o);t.set(o,r,this.scale*i(e[a],e[a+1],e[a+2]))}},La.prototype.getPixels=function(){return new ur({width:this.level.dim+2*this.level.border,height:this.level.dim+2*this.level.border},new Uint8Array(this.level.data.buffer))},La.prototype.backfillBorder=function(t,e,n){var i=this.level,r=t.level;if(i.dim!==r.dim)throw new Error("level mismatch (dem dimension)");var o=e*i.dim,a=e*i.dim+i.dim,s=n*i.dim,l=n*i.dim+i.dim;switch(e){case-1:o=a-1;break;case 1:a=o+1}switch(n){case-1:s=l-1;break;case 1:l=s+1}for(var u=h(o,-i.border,i.dim+i.border),c=h(a,-i.border,i.dim+i.border),p=h(s,-i.border,i.dim+i.border),f=h(l,-i.border,i.dim+i.border),d=-e*i.dim,m=-n*i.dim,v=p;v<f;v++)for(var g=u;g<c;g++)i.set(g,v,r.get(g+d,v+m))},fn("DEMData",La);var Pa=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}};Pa.prototype.encode=function(t){return this._stringToNumber[t]},Pa.prototype.decode=function(t){return this._numberToString[t]};var Oa=function(t,e,n,i){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=i,this.properties=t.properties,null!=t.id&&(this.id=t.id)},Ra={geometry:{configurable:!0}};Ra.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Ra.geometry.set=function(t){this._geometry=t},Oa.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(Oa.prototype,Ra);var Ba=function(t,e,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=e||new ln(Pi,16,0),this.featureIndexArray=n||new Ei};function Fa(t,e){return e-t}Ba.prototype.insert=function(t,e,n,i,r){var o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,r);for(var a=0;a<e.length;a++){for(var s=e[a],l=[1/0,1/0,-1/0,-1/0],u=0;u<s.length;u++){var c=s[u];l[0]=Math.min(l[0],c.x),l[1]=Math.min(l[1],c.y),l[2]=Math.max(l[2],c.x),l[3]=Math.max(l[3],c.y)}l[0]<Pi&&l[1]<Pi&&l[2]>=0&&l[3]>=0&&this.grid.insert(o,l[0],l[1],l[2],l[3])}},Ba.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new mo.VectorTile(new ra(this.rawTileData)).layers,this.sourceLayerCoder=new Pa(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ba.prototype.query=function(t,e){var n=this;this.loadVTLayers();for(var i=t.params||{},r=Pi/t.tileSize/t.scale,o=Oe(i.filter),a=t.queryGeometry,s=t.queryPadding*r,l=1/0,u=1/0,c=-1/0,h=-1/0,p=0;p<a.length;p++)for(var f=a[p],d=0;d<f.length;d++){var m=f[d];l=Math.min(l,m.x),u=Math.min(u,m.y),c=Math.max(c,m.x),h=Math.max(h,m.y)}var v=this.grid.query(l-s,u-s,c+s,h+s);v.sort(Fa);for(var g,y={},_=function(s){var l=v[s];if(l!==g){g=l;var u=n.featureIndexArray.get(l),c=null;n.loadMatchingFeature(y,u.bucketIndex,u.sourceLayerIndex,u.featureIndex,o,i.layers,e,(function(e,i){return c||(c=Ri(e)),i.queryIntersectsFeature(a,e,c,n.z,t.transform,r,t.posMatrix)}))}},x=0;x<v.length;x++)_(x);return y},Ba.prototype.loadMatchingFeature=function(t,e,n,i,r,o,a,s){var l=this.bucketLayerIDs[e];if(!o||(function(t,e){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1})(o,l)){var u=this.sourceLayerCoder.decode(n),c=this.vtLayers[u].feature(i);if(r(new kn(this.tileID.overscaledZ),c))for(var h=0;h<l.length;h++){var p=l[h];if(!(o&&o.indexOf(p)<0)){var f=a[p];if(f&&(!s||s(c,f))){var d=new Oa(c,this.z,this.x,this.y);d.layer=f.serialize();var m=t[p];void 0===m&&(m=t[p]=[]),m.push({featureIndex:i,feature:d})}}}}},Ba.prototype.lookupSymbolFeatures=function(t,e,n,i,r,o){var a={};this.loadVTLayers();for(var s=Oe(i),l=0,u=t;l<u.length;l+=1){var c=u[l];this.loadMatchingFeature(a,e,n,c,s,r,o)}return a},Ba.prototype.hasLayer=function(t){for(var e=0,n=this.bucketLayerIDs;e<n.length;e+=1)for(var i=0,r=n[e];i<r.length;i+=1)if(t===r[i])return!0;return!1},fn("FeatureIndex",Ba,{omit:["rawTileData","sourceLayerCoder"]});var Na={horizontal:1,vertical:2,horizontalOnly:3},Va={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ja={};function Ua(t,e,n,i){var r=Math.pow(t-e,2);return i?t<e?r/2:2*r:r+Math.abs(n)*n}function qa(t,e){var n=0;return 10===t&&(n-=1e4),40!==t&&65288!==t||(n+=50),41!==e&&65289!==e||(n+=50),n}function $a(t,e,n,i,r,o){for(var a=null,s=Ua(e,n,r,o),l=0,u=i;l<u.length;l+=1){var c=u[l],h=Ua(e-c.x,n,r,o)+c.badness;h<=s&&(a=c,s=h)}return{index:t,x:e,priorBreak:a,badness:s}}function Za(t,e,n,i){if(!n)return[];if(!t)return[];for(var r,o=[],a=(function(t,e,n,i){for(var r=0,o=0;o<t.length;o++){var a=i[t.charCodeAt(o)];a&&(r+=a.metrics.advance+e)}return r/Math.max(1,Math.ceil(r/n))})(t,e,n,i),s=0,l=0;l<t.length;l++){var u=t.charCodeAt(l),c=i[u];c&&!Va[u]&&(s+=c.metrics.advance+e),l<t.length-1&&(ja[u]||!((r=u)<11904)&&(yn["Bopomofo Extended"](r)||yn.Bopomofo(r)||yn["CJK Compatibility Forms"](r)||yn["CJK Compatibility Ideographs"](r)||yn["CJK Compatibility"](r)||yn["CJK Radicals Supplement"](r)||yn["CJK Strokes"](r)||yn["CJK Symbols and Punctuation"](r)||yn["CJK Unified Ideographs Extension A"](r)||yn["CJK Unified Ideographs"](r)||yn["Enclosed CJK Letters and Months"](r)||yn["Halfwidth and Fullwidth Forms"](r)||yn.Hiragana(r)||yn["Ideographic Description Characters"](r)||yn["Kangxi Radicals"](r)||yn["Katakana Phonetic Extensions"](r)||yn.Katakana(r)||yn["Vertical Forms"](r)||yn["Yi Radicals"](r)||yn["Yi Syllables"](r)))&&o.push($a(l+1,s,a,o,qa(u,t.charCodeAt(l+1)),!1))}return (function t(e){return e?t(e.priorBreak).concat(e.index):[]})($a(t.length,s,a,o,0,!0))}function Ga(t){var e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Wa(t,e,n,i,r){if(r){var o=e[t[i].glyph];if(o)for(var a=o.metrics.advance,s=(t[i].x+a)*r,l=n;l<=i;l++)t[l].x-=s}}ja[10]=!0,ja[32]=!0,ja[38]=!0,ja[40]=!0,ja[41]=!0,ja[43]=!0,ja[45]=!0,ja[47]=!0,ja[173]=!0,ja[183]=!0,ja[8203]=!0,ja[8208]=!0,ja[8211]=!0,ja[8231]=!0,t.commonjsGlobal=e,t.unwrapExports=n,t.createCommonjsModule=i,t.default=self,t.default$1=s,t.getJSON=function(t,e){var n=C(t);return n.setRequestHeader("Accept","application/json"),n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){if(n.status>=200&&n.status<300&&n.response){var i;try{i=JSON.parse(n.response)}catch(t){return e(t)}e(null,i)}else 401===n.status&&t.url.match(/mapbox.com/)?e(new S(n.statusText+": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens",n.status,t.url)):e(new S(n.statusText,n.status,t.url))},n.send(),n},t.getImage=function(t,e){return T(t,(function(t,n){if(t)e(t);else if(n){var i=new self.Image,r=self.URL||self.webkitURL;i.onload=function(){e(null,i),r.revokeObjectURL(i.src)};var o=new self.Blob([new Uint8Array(n.data)],{type:"image/png"});i.cacheControl=n.cacheControl,i.expires=n.expires,i.src=n.data.byteLength?r.createObjectURL(o):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}}))},t.ResourceType=E,t.RGBAImage=ur,t.default$2=Jo,t.ImagePosition=Qo,t.getArrayBuffer=T,t.default$3=function(t){return new ra(t).readFields(wa,[])},t.default$4=yn,t.asyncAll=function(t,e,n){if(!t.length)return n(null,[]);var i=t.length,r=new Array(t.length),o=null;t.forEach((function(t,a){e(t,(function(t,e){t&&(o=t),r[a]=e,0==--i&&n(o,r)}))}))},t.AlphaImage=lr,t.default$5=D,t.endsWith=m,t.extend=p,t.sphericalToCartesian=function(t){var e=t[0],n=t[1],i=t[2];return n+=90,n*=Math.PI/180,i*=Math.PI/180,{x:e*Math.cos(n)*Math.sin(i),y:e*Math.sin(n)*Math.sin(i),z:e*Math.cos(i)}},t.Evented=z,t.validateStyle=nn,t.validateLight=rn,t.emitValidationErrors=sn,t.default$6=Q,t.number=bt,t.Properties=qn,t.Transitionable=Ln,t.Transitioning=On,t.PossiblyEvaluated=Fn,t.DataConstantProperty=Nn,t.warnOnce=x,t.uniqueId=function(){return f++},t.default$7=Ta,t.pick=function(t,e){for(var n={},i=0;i<e.length;i++){var r=e[i];r in t&&(n[r]=t[r])}return n},t.wrap=function(t,e,n){var i=n-e,r=((t-e)%i+i)%i+e;return r===e?n:r},t.clamp=h,t.Event=I,t.ErrorEvent=k,t.OverscaledTileID=ka,t.default$8=Pi,t.createLayout=Yn,t.getCoordinatesCenter=function(t){for(var e=1/0,n=1/0,i=-1/0,r=-1/0,o=0;o<t.length;o++)e=Math.min(e,t[o].column),n=Math.min(n,t[o].row),i=Math.max(i,t[o].column),r=Math.max(r,t[o].row);var s=i-e,l=r-n,u=Math.max(s,l),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2));return new a((e+i)/2,(n+r)/2,0).zoomTo(c)},t.CanonicalTileID=Ma,t.RasterBoundsArray=Kn,t.getVideo=function(t,e){var n,i,r=self.document.createElement("video");r.onloadstart=function(){e(null,r)};for(var o=0;o<t.length;o++){var a=self.document.createElement("source");n=t[o],i=void 0,(i=self.document.createElement("a")).href=n,(i.protocol!==self.document.location.protocol||i.host!==self.document.location.host)&&(r.crossOrigin="Anonymous"),a.src=t[o],r.appendChild(a)}return r},t.default$9=L,t.bindAll=d,t.default$10=function t(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(!t(e[i],n[i]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(e).length!==Object.keys(n).length)return!1;for(var r in e)if(!t(e[r],n[r]))return!1;return!0}return e===n},t.parseCacheControl=function(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(t,n,i,r){var o=i||r;return e[n]=!o||o.toLowerCase(),""})),e["max-age"]){var n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e},t.default$11=Ba,t.default$12=Oa,t.default$13=Oe,t.default$14=$o,t.CollisionBoxArray=mi,t.default$15=Ci,t.TriangleIndexArray=ci,t.default$16=kn,t.default$17=a,t.keysDifference=function(t,e){var n=[];for(var i in t)i in e||n.push(i);return n},t.default$18=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.mat4=er,t.vec4=tr,t.getSizeData=Bo,t.evaluateSizeForFeature=function(t,e,n){var i=e;return"source"===t.functionType?n.lowerSize/10:"composite"===t.functionType?bt(n.lowerSize/10,n.upperSize/10,i.uSizeT):i.uSize},t.evaluateSizeForZoom=function(t,e,n){if("constant"===t.functionType)return{uSizeT:0,uSize:t.layoutSize};if("source"===t.functionType)return{uSizeT:0,uSize:0};if("camera"===t.functionType){var i=t.propertyValue,r=t.zoomRange,o=t.sizeRange,a=h(Te(i,n.specification).interpolationFactor(e,r.min,r.max),0,1);return{uSizeT:0,uSize:o.min+a*(o.max-o.min)}}var s=t.propertyValue,l=t.zoomRange;return{uSizeT:h(Te(s,n.specification).interpolationFactor(e,l.min,l.max),0,1),uSize:0}},t.addDynamicAttributes=jo,t.default$19=Go,t.WritingMode=Na,t.multiPolygonIntersectsBufferedPoint=Ni,t.multiPolygonIntersectsMultiPolygon=Vi,t.multiPolygonIntersectsBufferedMultiLine=ji,t.polygonIntersectsPolygon=function(t,e){for(var n=0;n<t.length;n++)if(Yi(e,t[n]))return!0;for(var i=0;i<e.length;i++)if(Yi(t,e[i]))return!0;return!!qi(t,e)},t.distToSegmentSquared=Gi,t.default$20=Qi,t.default$21=$n,t.default$22=function(t){return new Ko[t.type](t)},t.clone=y,t.filterObject=g,t.mapObject=v,t.registerForPluginAvailability=function(t){return Tn?t({pluginURL:Tn,completionCallback:Sn}):Mn.once("pluginAvailable",t),t},t.evented=Mn,t.default$23=gn,t.default$24=zi,t.PosArray=Xn,t.UnwrappedTileID=Ia,t.ease=c,t.bezier=u,t.setRTLTextPlugin=function(t,e){if(Cn)throw new Error("setRTLTextPlugin cannot be called multiple times.");Cn=!0,Tn=t,Sn=function(t){t?(Cn=!1,Tn=null,e&&e(t)):An=!0},Mn.fire(new I("pluginAvailable",{pluginURL:Tn,completionCallback:Sn}))},t.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},t.default$25=Ro,t.register=fn,t.GLYPH_PBF_BORDER=Ca,t.shapeText=function(t,e,n,i,r,o,a,s,l,u){var c=t.trim();u===Na.vertical&&(c=(function(t){for(var e="",n=0;n<t.length;n++){var i=t.charCodeAt(n+1)||null,r=t.charCodeAt(n-1)||null;i&&wn(i)&&!Oo[t[n+1]]||r&&wn(r)&&!Oo[t[n-1]]||!Oo[t[n]]?e+=t[n]:e+=Oo[t[n]]}return e})(c));var h=[],p={positionedGlyphs:h,text:c,top:s[1],bottom:s[1],left:s[0],right:s[0],writingMode:u},f=In.processBidirectionalText;return (function(t,e,n,i,r,o,a,s,l){for(var u=0,c=-17,h=0,p=t.positionedGlyphs,f="right"===o?1:"left"===o?0:.5,d=0,m=n;d<m.length;d+=1){var v=m[d];if((v=v.trim()).length){for(var g=p.length,y=0;y<v.length;y++){var _=v.charCodeAt(y),x=e[_];x&&(bn(_)&&a!==Na.horizontal?(p.push({glyph:_,x:u,y:0,vertical:!0}),u+=l+s):(p.push({glyph:_,x:u,y:c,vertical:!1}),u+=x.metrics.advance+s))}if(p.length!==g){var b=u-s;h=Math.max(b,h),Wa(p,e,g,p.length-1,f)}u=0,c+=i}else c+=i}var w=Ga(r),E=w.horizontalAlign,S=w.verticalAlign;!(function(t,e,n,i,r,o,a){for(var s=(e-n)*r,l=(-i*a+.5)*o,u=0;u<t.length;u++)t[u].x+=s,t[u].y+=l})(p,f,E,S,h,i,n.length);var C=n.length*i;t.top+=-S*C,t.bottom=t.top+C,t.left+=-E*h,t.right=t.left+h})(p,e,f?f(c,Za(c,a,n,e)):(function(t,e){for(var n=[],i=0,r=0,o=e;r<o.length;r+=1){var a=o[r];n.push(t.substring(i,a)),i=a}return i<t.length&&n.push(t.substring(i,t.length)),n})(c,Za(c,a,n,e)),i,r,o,u,a,l),!!h.length&&p},t.shapeIcon=function(t,e,n){var i=Ga(n),r=i.horizontalAlign,o=i.verticalAlign,a=e[0],s=e[1],l=a-t.displaySize[0]*r,u=l+t.displaySize[0],c=s-t.displaySize[1]*o;return{image:t,top:c,bottom:c+t.displaySize[1],left:l,right:u}},t.allowsVerticalWritingMode=_n,t.allowsLetterSpacing=function(t){for(var e=0,n=t;e<n.length;e+=1)if(!xn(n[e].charCodeAt(0)))return!1;return!0},t.default$26=Gr,t.default$27=Pa,t.default$28=ea,t.default$29=mo,t.default$30=ra,t.default$31=La,t.__moduleExports=mo,t.default$32=s,t.__moduleExports$1=ra,t.plugin=In})),i(0,(function(t){function e(t){var n=typeof t;if("number"===n||"boolean"===n||"string"===n||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var i="[",r=0,o=t;r<o.length;r+=1)i+=e(o[r])+",";return i+"]"}for(var a=Object.keys(t).sort(),s="{",l=0;l<a.length;l++)s+=JSON.stringify(a[l])+":"+e(t[a[l]])+",";return s+"}"}function n(n){for(var i="",r=0,o=t.default$18;r<o.length;r+=1)i+="/"+e(n[o[r]]);return i}var i=function(t){t&&this.replace(t)};function r(t,e,n,i,r){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;s>-n/2;){if(--a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var l=[],u=0;s<n/2;){var c=t[a-1],h=t[a],p=t[a+1];if(!p)return!1;var f=c.angleTo(h)-h.angleTo(p);for(f=Math.abs((f+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:f}),u+=f;s-l[0].distance>i;)u-=l.shift().angleDelta;if(u>r)return!1;a++,s+=h.dist(p)}return!0}function o(e,n,i,o,a,s,l,u,c){var h=o?.6*s*l:0,p=Math.max(o?o.right-o.left:0,a?a.right-a.left:0),f=0===e[0].x||e[0].x===c||0===e[0].y||e[0].y===c;return n-p*l<n/4&&(n=p*l+n/4),(function e(n,i,o,a,s,l,u,c,h){for(var p=l/2,f=0,d=0;d<n.length-1;d++)f+=n[d].dist(n[d+1]);for(var m=0,v=i-o,g=[],y=0;y<n.length-1;y++){for(var _=n[y],x=n[y+1],b=_.dist(x),w=x.angleTo(_);v+o<m+b;){var E=((v+=o)-m)/b,S=t.number(_.x,x.x,E),C=t.number(_.y,x.y,E);if(S>=0&&S<h&&C>=0&&C<h&&v-p>=0&&v+p<=f){var T=new t.default$25(S,C,w,y);T._round(),a&&!r(n,T,l,a,s)||g.push(T)}}m+=b}return c||g.length||u||(g=e(n,m/2,o,a,s,l,u,!0,h)),g})(e,f?n/2*u%n:(p/2+2*s)*l*u%n,n,h,i,p*l,f,!1,c)}i.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},i.prototype.update=function(e,i){for(var r=this,o=0,a=e;o<a.length;o+=1){var s=a[o];r._layerConfigs[s.id]=s;var l=r._layers[s.id]=t.default$22(s);l._featureFilter=t.default$13(l.filter)}for(var u=0,c=i;u<c.length;u+=1){var h=c[u];delete r._layerConfigs[h],delete r._layers[h]}this.familiesBySource={};for(var p=0,f=(function(t){for(var e={},i=0;i<t.length;i++){var r=n(t[i]),o=e[r];o||(o=e[r]=[]),o.push(t[i])}var a=[];for(var s in e)a.push(e[s]);return a})(t.values(this._layerConfigs));p<f.length;p+=1){var d=f[p].map((function(t){return r._layers[t.id]})),m=d[0];if("none"!==m.visibility){var v=m.source||"",g=r.familiesBySource[v];g||(g=r.familiesBySource[v]={});var y=m.sourceLayer||"_geojsonTileLayer",_=g[y];_||(_=g[y]=[]),_.push(d)}}};var a=function(){this.opacity=0,this.targetOpacity=0,this.time=0};a.prototype.clone=function(){var t=new a;return t.opacity=this.opacity,t.targetOpacity=this.targetOpacity,t.time=this.time,t},t.register("OpacityState",a);var s=function(t,e,n,i,r,o,a,s,l,u,c){var h=a.top*s-l,p=a.bottom*s+l,f=a.left*s-l,d=a.right*s+l;if(this.boxStartIndex=t.length,u){var m=p-h,v=d-f;m>0&&(m=Math.max(10*s,m),this._addLineCollisionCircles(t,e,n,n.segment,v,m,i,r,o,c))}else t.emplaceBack(n.x,n.y,f,h,d,p,i,r,o,0,0);this.boxEndIndex=t.length};s.prototype._addLineCollisionCircles=function(t,e,n,i,r,o,a,s,l,u){var c=o/2,h=Math.floor(r/c),p=1+.4*Math.log(u)/Math.LN2,f=Math.floor(h*p/2),d=-o/2,m=n,v=i+1,g=d,y=-r/2,_=y-r/4;do{if(--v<0){if(g>y)return;v=0;break}g-=e[v].dist(m),m=e[v]}while(g>_);for(var x=e[v].dist(e[v+1]),b=-f;b<h+f;b++){var w=b*c,E=y+w;if(w<0&&(E+=w),w>r&&(E+=w-r),!(E<g)){for(;g+x<E;){if(g+=x,++v+1>=e.length)return;x=e[v].dist(e[v+1])}var S=E-g,C=e[v],T=e[v+1].sub(C)._unit()._mult(S)._add(C)._round(),A=Math.abs(E-d)<c?0:.8*(E-d);t.emplaceBack(T.x,T.y,-o/2,-o/2,o/2,o/2,a,s,l,o/2,A)}}};var l=c,u=c;function c(t,e){if(!(this instanceof c))return new c(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||h,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function h(t,e){return t<e?-1:t>e?1:0}function p(e,n,i){void 0===n&&(n=1),void 0===i&&(i=!1);for(var r=1/0,o=1/0,a=-1/0,s=-1/0,u=e[0],c=0;c<u.length;c++){var h=u[c];(!c||h.x<r)&&(r=h.x),(!c||h.y<o)&&(o=h.y),(!c||h.x>a)&&(a=h.x),(!c||h.y>s)&&(s=h.y)}var p=a-r,m=s-o,v=Math.min(p,m),g=v/2,y=new l(null,f);if(0===v)return new t.default$1(r,o);for(var _=r;_<a;_+=v)for(var x=o;x<s;x+=v)y.push(new d(_+g,x+g,g,e));for(var b=(function(t){for(var e=0,n=0,i=0,r=t[0],o=0,a=r.length,s=a-1;o<a;s=o++){var l=r[o],u=r[s],c=l.x*u.y-u.x*l.y;n+=(l.x+u.x)*c,i+=(l.y+u.y)*c,e+=3*c}return new d(n/e,i/e,0,t)})(e),w=y.length;y.length;){var E=y.pop();(E.d>b.d||!b.d)&&(b=E,i&&console.log("found best %d after %d probes",Math.round(1e4*E.d)/1e4,w)),E.max-b.d<=n||(g=E.h/2,y.push(new d(E.p.x-g,E.p.y-g,g,e)),y.push(new d(E.p.x+g,E.p.y-g,g,e)),y.push(new d(E.p.x-g,E.p.y+g,g,e)),y.push(new d(E.p.x+g,E.p.y+g,g,e)),w+=4)}return i&&(console.log("num probes: "+w),console.log("best distance: "+b.d)),b.p}function f(t,e){return e.max-t.max}function d(e,n,i,r){this.p=new t.default$1(e,n),this.h=i,this.d=(function(e,n){for(var i=!1,r=1/0,o=0;o<n.length;o++)for(var a=n[o],s=0,l=a.length,u=l-1;s<l;u=s++){var c=a[s],h=a[u];c.y>e.y!=h.y>e.y&&e.x<(h.x-c.x)*(e.y-c.y)/(h.y-c.y)+c.x&&(i=!i),r=Math.min(r,t.distToSegmentSquared(e,c,h))}return(i?1:-1)*Math.sqrt(r)})(this.p,r),this.max=this.d+this.h*Math.SQRT2}function m(e,n,i,r,o,a){e.createArrays(),e.symbolInstances=[];var s=512*e.overscaling;e.tilePixelRatio=t.default$8/s,e.compareText={},e.iconsNeedLinear=!1;var l=e.layers[0].layout,u=e.layers[0]._unevaluatedLayout._values,c={};if("composite"===e.textSizeData.functionType){var h=e.textSizeData.zoomRange,p=h.min,f=h.max;c.compositeTextSizes=[u["text-size"].possiblyEvaluate(new t.default$16(p)),u["text-size"].possiblyEvaluate(new t.default$16(f))]}if("composite"===e.iconSizeData.functionType){var d=e.iconSizeData.zoomRange,m=d.min,g=d.max;c.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new t.default$16(m)),u["icon-size"].possiblyEvaluate(new t.default$16(g))]}c.layoutTextSize=u["text-size"].possiblyEvaluate(new t.default$16(e.zoom+1)),c.layoutIconSize=u["icon-size"].possiblyEvaluate(new t.default$16(e.zoom+1)),c.textMaxSize=u["text-size"].possiblyEvaluate(new t.default$16(18));for(var y=24*l.get("text-line-height"),_="map"===l.get("text-rotation-alignment")&&"line"===l.get("symbol-placement"),x=l.get("text-keep-upright"),b=0,w=e.features;b<w.length;b+=1){var E=w[b],S=l.get("text-font").evaluate(E).join(","),C=n[S]||{},T=i[S]||{},A={},M=E.text;if(M){var I=l.get("text-offset").evaluate(E).map((function(t){return 24*t})),k=24*l.get("text-letter-spacing").evaluate(E),z=t.allowsLetterSpacing(M)?k:0,D=l.get("text-anchor").evaluate(E),L=l.get("text-justify").evaluate(E),P="line"!==l.get("symbol-placement")?24*l.get("text-max-width").evaluate(E):0;A.horizontal=t.shapeText(M,C,P,y,D,L,z,I,24,t.WritingMode.horizontal),t.allowsVerticalWritingMode(M)&&_&&x&&(A.vertical=t.shapeText(M,C,P,y,D,L,z,I,24,t.WritingMode.vertical))}var O=void 0;if(E.icon){var R=r[E.icon];R&&(O=t.shapeIcon(o[E.icon],l.get("icon-offset").evaluate(E),l.get("icon-anchor").evaluate(E)),void 0===e.sdfIcons?e.sdfIcons=R.sdf:e.sdfIcons!==R.sdf&&t.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),R.pixelRatio!==e.pixelRatio?e.iconsNeedLinear=!0:0!==l.get("icon-rotate").constantOr(1)&&(e.iconsNeedLinear=!0))}(A.horizontal||O)&&v(e,E,A,O,T,c)}a&&e.generateCollisionDebugBuffers()}function v(e,n,i,r,l,u){var c=u.layoutTextSize.evaluate(n),h=u.layoutIconSize.evaluate(n),f=u.textMaxSize.evaluate(n);void 0===f&&(f=c);var d=e.layers[0].layout,m=d.get("text-offset").evaluate(n),v=d.get("icon-offset").evaluate(n),_=c/24,x=e.tilePixelRatio*_,b=e.tilePixelRatio*f/24,w=e.tilePixelRatio*h,E=e.tilePixelRatio*d.get("symbol-spacing"),S=d.get("text-padding")*e.tilePixelRatio,C=d.get("icon-padding")*e.tilePixelRatio,T=d.get("text-max-angle")/180*Math.PI,A="map"===d.get("text-rotation-alignment")&&"line"===d.get("symbol-placement"),M="map"===d.get("icon-rotation-alignment")&&"line"===d.get("symbol-placement"),I=E/2,k=function(o,c){c.x<0||c.x>=t.default$8||c.y<0||c.y>=t.default$8||e.symbolInstances.push(function(e,n,i,r,o,l,u,c,h,p,f,d,m,v,y,_,x,b,w,E,S){var C,T,A=e.addToLineVertexArray(n,i),M=0,I=0,k=0,z=r.horizontal?r.horizontal.text:"",D=[];r.horizontal&&(C=new s(u,i,n,c,h,p,r.horizontal,f,d,m,e.overscaling),I+=g(e,n,r.horizontal,l,m,w,v,A,r.vertical?t.WritingMode.horizontal:t.WritingMode.horizontalOnly,D,E,S),r.vertical&&(k+=g(e,n,r.vertical,l,m,w,v,A,t.WritingMode.vertical,D,E,S)));var L=C?C.boxStartIndex:e.collisionBoxArray.length,P=C?C.boxEndIndex:e.collisionBoxArray.length;if(o){var O=(function(e,n,i,r,o,a){var s,l,u,c,h=n.image,p=i.layout,f=n.top-1/h.pixelRatio,d=n.left-1/h.pixelRatio,m=n.bottom+1/h.pixelRatio,v=n.right+1/h.pixelRatio;if("none"!==p.get("icon-text-fit")&&o){var g=v-d,y=m-f,_=p.get("text-size").evaluate(a)/24,x=o.left*_,b=o.right*_,w=o.top*_,E=b-x,S=o.bottom*_-w,C=p.get("icon-text-fit-padding")[0],T=p.get("icon-text-fit-padding")[1],A=p.get("icon-text-fit-padding")[2],M=p.get("icon-text-fit-padding")[3],I="width"===p.get("icon-text-fit")?.5*(S-y):0,k="height"===p.get("icon-text-fit")?.5*(E-g):0,z="width"===p.get("icon-text-fit")||"both"===p.get("icon-text-fit")?E:g,D="height"===p.get("icon-text-fit")||"both"===p.get("icon-text-fit")?S:y;s=new t.default$1(x+k-M,w+I-C),l=new t.default$1(x+k+T+z,w+I-C),u=new t.default$1(x+k+T+z,w+I+A+D),c=new t.default$1(x+k-M,w+I+A+D)}else s=new t.default$1(d,f),l=new t.default$1(v,f),u=new t.default$1(v,m),c=new t.default$1(d,m);var L=i.layout.get("icon-rotate").evaluate(a)*Math.PI/180;if(L){var P=Math.sin(L),O=Math.cos(L),R=[O,-P,P,O];s._matMult(R),l._matMult(R),c._matMult(R),u._matMult(R)}return[{tl:s,tr:l,bl:c,br:u,tex:h.paddedRect,writingMode:void 0,glyphOffset:[0,0]}]})(0,o,l,0,r.horizontal,w);T=new s(u,i,n,c,h,p,o,y,_,!1,e.overscaling),M=4*O.length;var R=e.iconSizeData,B=null;"source"===R.functionType?B=[10*l.layout.get("icon-size").evaluate(w)]:"composite"===R.functionType&&(B=[10*S.compositeIconSizes[0].evaluate(w),10*S.compositeIconSizes[1].evaluate(w)]),e.addSymbols(e.icon,O,B,b,x,w,!1,n,A.lineStartIndex,A.lineLength)}var F=T?T.boxStartIndex:e.collisionBoxArray.length,N=T?T.boxEndIndex:e.collisionBoxArray.length;return e.glyphOffsetArray.length>=t.default$14.MAX_GLYPHS&&t.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),{key:z,textBoxStartIndex:L,textBoxEndIndex:P,iconBoxStartIndex:F,iconBoxEndIndex:N,textOffset:v,iconOffset:b,anchor:n,line:i,featureIndex:c,feature:w,numGlyphVertices:I,numVerticalGlyphVertices:k,numIconVertices:M,textOpacityState:new a,iconOpacityState:new a,isDuplicate:!1,placedTextSymbolIndices:D,crossTileID:0}}(e,c,o,i,r,e.layers[0],e.collisionBoxArray,n.index,n.sourceLayerIndex,e.index,x,S,A,m,w,C,M,v,n,l,u))};if("line"===d.get("symbol-placement"))for(var z=0,D=(function(e,n,i,r,o){for(var a=[],s=0;s<e.length;s++)for(var l=e[s],u=void 0,c=0;c<l.length-1;c++){var h=l[c],p=l[c+1];h.x<0&&p.x<0||(h.x<0?h=new t.default$1(0,h.y+(p.y-h.y)*((0-h.x)/(p.x-h.x)))._round():p.x<0&&(p=new t.default$1(0,h.y+(p.y-h.y)*((0-h.x)/(p.x-h.x)))._round()),h.y<0&&p.y<0||(h.y<0?h=new t.default$1(h.x+(p.x-h.x)*((0-h.y)/(p.y-h.y)),0)._round():p.y<0&&(p=new t.default$1(h.x+(p.x-h.x)*((0-h.y)/(p.y-h.y)),0)._round()),h.x>=r&&p.x>=r||(h.x>=r?h=new t.default$1(r,h.y+(p.y-h.y)*((r-h.x)/(p.x-h.x)))._round():p.x>=r&&(p=new t.default$1(r,h.y+(p.y-h.y)*((r-h.x)/(p.x-h.x)))._round()),h.y>=o&&p.y>=o||(h.y>=o?h=new t.default$1(h.x+(p.x-h.x)*((o-h.y)/(p.y-h.y)),o)._round():p.y>=o&&(p=new t.default$1(h.x+(p.x-h.x)*((o-h.y)/(p.y-h.y)),o)._round()),u&&h.equals(u[u.length-1])||(u=[h],a.push(u)),u.push(p)))))}return a})(n.geometry,0,0,t.default$8,t.default$8);z<D.length;z+=1)for(var L=D[z],P=0,O=o(L,E,T,i.vertical||i.horizontal,r,24,b,e.overscaling,t.default$8);P<O.length;P+=1){var R=O[P],B=i.horizontal;B&&y(e,B.text,I,R)||k(L,R)}else if("Polygon"===n.type)for(var F=0,N=t.default$26(n.geometry,0);F<N.length;F+=1){var V=N[F],j=p(V,16);k(V[0],new t.default$25(j.x,j.y,0))}else if("LineString"===n.type)for(var U=0,q=n.geometry;U<q.length;U+=1){var $=q[U];k($,new t.default$25($[0].x,$[0].y,0))}else if("Point"===n.type)for(var Z=0,G=n.geometry;Z<G.length;Z+=1)for(var W=0,Y=G[Z];W<Y.length;W+=1){var H=Y[W];k([H],new t.default$25(H.x,H.y,0))}}function g(e,n,i,r,o,a,s,l,u,c,h,p){var f=(function(e,n,i,r,o,a){for(var s=i.layout.get("text-rotate").evaluate(o)*Math.PI/180,l=i.layout.get("text-offset").evaluate(o).map((function(t){return 24*t})),u=n.positionedGlyphs,c=[],h=0;h<u.length;h++){var p=u[h],f=a[p.glyph];if(f){var d=f.rect;if(d){var m=t.GLYPH_PBF_BORDER+1,v=f.metrics.advance/2,g=r?[p.x+v,p.y]:[0,0],y=r?[0,0]:[p.x+v+l[0],p.y+l[1]],_=f.metrics.left-m-v+y[0],x=-f.metrics.top-m+y[1],b=_+d.w,w=x+d.h,E=new t.default$1(_,x),S=new t.default$1(b,x),C=new t.default$1(_,w),T=new t.default$1(b,w);if(r&&p.vertical){var A=new t.default$1(-v,v),M=-Math.PI/2,I=new t.default$1(5,0);E._rotateAround(M,A)._add(I),S._rotateAround(M,A)._add(I),C._rotateAround(M,A)._add(I),T._rotateAround(M,A)._add(I)}if(s){var k=Math.sin(s),z=Math.cos(s),D=[z,-k,k,z];E._matMult(D),S._matMult(D),C._matMult(D),T._matMult(D)}c.push({tl:E,tr:S,bl:C,br:T,tex:d,writingMode:n.writingMode,glyphOffset:g})}}}return c})(0,i,r,o,a,h),d=e.textSizeData,m=null;return"source"===d.functionType?m=[10*r.layout.get("text-size").evaluate(a)]:"composite"===d.functionType&&(m=[10*p.compositeTextSizes[0].evaluate(a),10*p.compositeTextSizes[1].evaluate(a)]),e.addSymbols(e.text,f,m,s,o,a,u,n,l.lineStartIndex,l.lineLength),c.push(e.text.placedSymbolArray.length-1),4*f.length}function y(t,e,n,i){var r=t.compareText;if(e in r){for(var o=r[e],a=o.length-1;a>=0;a--)if(i.dist(o[a])<n)return!0}else r[e]=[];return r[e].push(i),!1}c.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,i=e[t];t>0;){var r=t-1>>1,o=e[r];if(n(i,o)>=0)break;e[t]=o,t=r}e[t]=i},_down:function(t){for(var e=this.data,n=this.compare,i=this.length>>1,r=e[t];t<i;){var o=1+(t<<1),a=o+1,s=e[o];if(a<this.length&&n(e[a],s)<0&&(o=a,s=e[a]),n(s,r)>=0)break;e[t]=s,t=o}e[t]=r}},l.default=u;var _=function(e){var n=new t.AlphaImage({width:0,height:0}),i={},r=new t.default$2(0,0,{autoResize:!0});for(var o in e){var a=e[o],s=i[o]={};for(var l in a){var u=a[+l];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var c=r.packOne(u.bitmap.width+2,u.bitmap.height+2);n.resize({width:r.w,height:r.h}),t.AlphaImage.copy(u.bitmap,n,{x:0,y:0},{x:c.x+1,y:c.y+1},u.bitmap),s[l]={rect:c,metrics:u.metrics}}}}r.shrink(),n.resize({width:r.w,height:r.h}),this.image=n,this.positions=i};t.register("GlyphAtlas",_);var x=function(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming};function b(e,n){for(var i=new t.default$16(n),r=0,o=e;r<o.length;r+=1)o[r].recalculate(i)}x.prototype.parse=function(e,n,i,r){var o=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var a=new t.default$27(Object.keys(e.layers).sort()),s=new t.default$11(this.tileID);s.bucketLayerIDs=[];var l,u,c,h={},p={featureIndex:s,iconDependencies:{},glyphDependencies:{}},f=n.familiesBySource[this.source];for(var d in f){var v=e.layers[d];if(v){1===v.version&&t.warnOnce('Vector tile source "'+o.source+'" layer "'+d+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var g=a.encode(d),y=[],x=0;x<v.length;x++){var w=v.feature(x);y.push({feature:w,index:x,sourceLayerIndex:g})}for(var E=0,S=f[d];E<S.length;E+=1){var C=S[E],T=C[0];T.minzoom&&o.zoom<Math.floor(T.minzoom)||T.maxzoom&&o.zoom>=T.maxzoom||"none"!==T.visibility&&(b(C,o.zoom),(h[T.id]=T.createBucket({index:s.bucketLayerIDs.length,layers:C,zoom:o.zoom,pixelRatio:o.pixelRatio,overscaling:o.overscaling,collisionBoxArray:o.collisionBoxArray,sourceLayerIndex:g})).populate(y,p),s.bucketLayerIDs.push(C.map((function(t){return t.id}))))}}}var A=t.mapObject(p.glyphDependencies,(function(t){return Object.keys(t).map(Number)}));Object.keys(A).length?i.send("getGlyphs",{uid:this.uid,stacks:A},(function(t,e){l||(l=t,u=e,I.call(o))})):u={};var M=Object.keys(p.iconDependencies);function I(){if(l)return r(l);if(u&&c){var e=new _(u),n=new t.default$28(c);for(var i in h){var o=h[i];o instanceof t.default$14&&(b(o.layers,this.zoom),m(o,u,e.positions,c,n.positions,this.showCollisionBoxes))}this.status="done",r(null,{buckets:t.values(h).filter((function(t){return!t.isEmpty()})),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,iconAtlasImage:n.image})}}M.length?i.send("getImages",{icons:M},(function(t,e){l||(l=t,c=e,I.call(o))})):c={},I.call(this)};var w=function(t){return!(!performance||!performance.getEntriesByName)&&performance.getEntriesByName(t)};function E(e,n){var i=t.getArrayBuffer(e.request,(function(e,i){e?n(e):i&&n(null,{vectorTile:new t.default$29.VectorTile(new t.default$30(i.data)),rawData:i.data,cacheControl:i.cacheControl,expires:i.expires})}));return function(){i.abort(),n()}}var S=function(t,e,n){this.actor=t,this.layerIndex=e,this.loadVectorData=n||E,this.loading={},this.loaded={}};S.prototype.loadTile=function(e,n){var i=this,r=e.uid;this.loading||(this.loading={});var o=this.loading[r]=new x(e);o.abort=this.loadVectorData(e,(function(a,s){if(delete i.loading[r],a||!s)return n(a);var l=s.rawData,u={};s.expires&&(u.expires=s.expires),s.cacheControl&&(u.cacheControl=s.cacheControl);var c={};if(e.request&&e.request.collectResourceTiming){var h=w(e.request.url);h&&(c.resourceTiming=JSON.parse(JSON.stringify(h)))}o.vectorTile=s.vectorTile,o.parse(s.vectorTile,i.layerIndex,i.actor,(function(e,i){if(e||!i)return n(e);n(null,t.extend({rawTileData:l.slice(0)},i,u,c))})),i.loaded=i.loaded||{},i.loaded[r]=o}))},S.prototype.reloadTile=function(t,e){var n=this.loaded,i=t.uid,r=this;if(n&&n[i]){var o=n[i];o.showCollisionBoxes=t.showCollisionBoxes;var a=function(t,n){var i=o.reloadCallback;i&&(delete o.reloadCallback,o.parse(o.vectorTile,r.layerIndex,r.actor,i)),e(t,n)};"parsing"===o.status?o.reloadCallback=a:"done"===o.status&&o.parse(o.vectorTile,this.layerIndex,this.actor,a)}},S.prototype.abortTile=function(t,e){var n=this.loading,i=t.uid;n&&n[i]&&n[i].abort&&(n[i].abort(),delete n[i]),e()},S.prototype.removeTile=function(t,e){var n=this.loaded,i=t.uid;n&&n[i]&&delete n[i],e()};var C=function(){this.loading={},this.loaded={}};C.prototype.loadTile=function(e,n){var i=e.uid,r=e.encoding,o=new t.default$31(i);this.loading[i]=o,o.loadFromImage(e.rawImageData,r),delete this.loading[i],this.loaded=this.loaded||{},this.loaded[i]=o,n(null,o)},C.prototype.removeTile=function(t){var e=this.loaded,n=t.uid;e&&e[n]&&delete e[n]};var T={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function A(t){var e=0;if(t&&t.length>0){e+=Math.abs(M(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(M(t[n]))}return e}function M(t){var e,n,i,r,o,a,s=0,l=t.length;if(l>2){for(a=0;a<l;a++)a===l-2?(i=l-2,r=l-1,o=0):a===l-1?(i=l-1,r=0,o=1):(i=a,r=a+1,o=a+2),e=t[i],n=t[r],s+=(I(t[o][0])-I(e[0]))*Math.sin(I(n[1]));s=s*T.RADIUS*T.RADIUS/2}return s}function I(t){return t*Math.PI/180}var k={geometry:function t(e){var n,i=0;switch(e.type){case"Polygon":return A(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)i+=A(e.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)i+=t(e.geometries[n]);return i}},ring:M};function z(t,e){return function(n){return t(n,e)}}function D(t,e){e=!!e,t[0]=L(t[0],e);for(var n=1;n<t.length;n++)t[n]=L(t[n],!e);return t}function L(t,e){return (function(t){return k.ring(t)>=0})(t)===e?t:t.reverse()}var P=t.default$29.VectorTileFeature.prototype.toGeoJSON,O=function(e){this._feature=e,this.extent=t.default$8,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};O.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],n=0,i=this._feature.geometry;n<i.length;n+=1){var r=i[n];e.push([new t.default$1(r[0],r[1])])}return e}for(var o=[],a=0,s=this._feature.geometry;a<s.length;a+=1){for(var l=[],u=0,c=s[a];u<c.length;u+=1){var h=c[u];l.push(new t.default$1(h[0],h[1]))}o.push(l)}return o},O.prototype.toGeoJSON=function(t,e,n){return P.call(this,t,e,n)};var R=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.default$8,this.length=e.length,this._features=e};R.prototype.feature=function(t){return new O(this._features[t])};var B=t.__moduleExports.VectorTileFeature,F=N;function N(t,e){this.options=e||{},this.features=t,this.length=t.length}function V(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}N.prototype.feature=function(t){return new V(this.features[t],this.options.extent)},V.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var n=0;n<e.length;n++){for(var i=e[n],r=[],o=0;o<i.length;o++)r.push(new t.default$32(i[o][0],i[o][1]));this.geometry.push(r)}return this.geometry},V.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,i=1/0,r=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),n=Math.max(n,l.x),i=Math.min(i,l.y),r=Math.max(r,l.y)}return[e,i,n,r]},V.prototype.toGeoJSON=B.prototype.toGeoJSON;var j=$,U=$,q=F;function $(e){var n=new t.__moduleExports$1;return (function(t,e){for(var n in t.layers)e.writeMessage(3,Z,t.layers[n])})(e,n),n.finish()}function Z(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)i.feature=t.feature(n),e.writeMessage(2,G,i);var r=i.keys;for(n=0;n<r.length;n++)e.writeStringField(3,r[n]);var o=i.values;for(n=0;n<o.length;n++)e.writeMessage(4,K,o[n])}function G(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,W,t),e.writeVarintField(3,n.type),e.writeMessage(4,X,n)}function W(t,e){var n=t.feature,i=t.keys,r=t.values,o=t.keycache,a=t.valuecache;for(var s in n.properties){var l=o[s];void 0===l&&(i.push(s),l=i.length-1,o[s]=l),e.writeVarint(l);var u=n.properties[s],c=typeof u;"string"!==c&&"boolean"!==c&&"number"!==c&&(u=JSON.stringify(u));var h=c+":"+u,p=a[h];void 0===p&&(r.push(u),p=r.length-1,a[h]=p),e.writeVarint(p)}}function Y(t,e){return(e<<3)+(7&t)}function H(t){return t<<1^t>>31}function X(t,e){for(var n=t.loadGeometry(),i=t.type,r=0,o=0,a=n.length,s=0;s<a;s++){var l=n[s],u=1;1===i&&(u=l.length),e.writeVarint(Y(1,u));for(var c=3===i?l.length-1:l.length,h=0;h<c;h++){1===h&&1!==i&&e.writeVarint(Y(2,c-1));var p=l[h].x-r,f=l[h].y-o;e.writeVarint(H(p)),e.writeVarint(H(f)),r+=p,o+=f}3===i&&e.writeVarint(Y(7,0))}}function K(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}j.fromVectorTileJs=U,j.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var i in t)n[i]=new F(t[i].features,e),n[i].name=i,n[i].version=e.version,n[i].extent=e.extent;return $({layers:n})},j.GeoJSONWrapper=q;var J=function t(e,n,i,r,o,a){if(!(o-r<=i)){var s=Math.floor((r+o)/2);!(function t(e,n,i,r,o,a){for(;o>r;){if(o-r>600){var s=o-r+1,l=i-r+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);t(e,n,i,Math.max(r,Math.floor(i-l*c/s+h)),Math.min(o,Math.floor(i+(s-l)*c/s+h)),a)}var p=n[2*i+a],f=r,d=o;for(Q(e,n,r,i),n[2*o+a]>p&&Q(e,n,r,o);f<d;){for(Q(e,n,f,d),f++,d--;n[2*f+a]<p;)f++;for(;n[2*d+a]>p;)d--}n[2*r+a]===p?Q(e,n,r,d):Q(e,n,++d,o),d<=i&&(r=d+1),i<=d&&(o=d-1)}})(e,n,s,r,o,a%2),t(e,n,i,r,s-1,a+1),t(e,n,i,s+1,o,a+1)}};function Q(t,e,n,i){tt(t,n,i),tt(e,2*n,2*i),tt(e,2*n+1,2*i+1)}function tt(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function et(t,e,n,i){var r=t-n,o=e-i;return r*r+o*o}var nt=function(t,e,n,i,r){return new it(t,e,n,i,r)};function it(t,e,n,i,r){e=e||rt,n=n||ot,r=r||Array,this.nodeSize=i||64,this.points=t,this.ids=new r(t.length),this.coords=new r(2*t.length);for(var o=0;o<t.length;o++)this.ids[o]=o,this.coords[2*o]=e(t[o]),this.coords[2*o+1]=n(t[o]);J(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function rt(t){return t[0]}function ot(t){return t[1]}it.prototype={range:function(t,e,n,i){return (function(t,e,n,i,r,o,a){for(var s,l,u=[0,t.length-1,0],c=[];u.length;){var h=u.pop(),p=u.pop(),f=u.pop();if(p-f<=a)for(var d=f;d<=p;d++)s=e[2*d],l=e[2*d+1],s>=n&&s<=r&&l>=i&&l<=o&&c.push(t[d]);else{var m=Math.floor((f+p)/2);s=e[2*m],l=e[2*m+1],s>=n&&s<=r&&l>=i&&l<=o&&c.push(t[m]);var v=(h+1)%2;(0===h?n<=s:i<=l)&&(u.push(f),u.push(m-1),u.push(v)),(0===h?r>=s:o>=l)&&(u.push(m+1),u.push(p),u.push(v))}}return c})(this.ids,this.coords,t,e,n,i,this.nodeSize)},within:function(t,e,n){return (function(t,e,n,i,r,o){for(var a=[0,t.length-1,0],s=[],l=r*r;a.length;){var u=a.pop(),c=a.pop(),h=a.pop();if(c-h<=o)for(var p=h;p<=c;p++)et(e[2*p],e[2*p+1],n,i)<=l&&s.push(t[p]);else{var f=Math.floor((h+c)/2),d=e[2*f],m=e[2*f+1];et(d,m,n,i)<=l&&s.push(t[f]);var v=(u+1)%2;(0===u?n-r<=d:i-r<=m)&&(a.push(h),a.push(f-1),a.push(v)),(0===u?n+r>=d:i+r>=m)&&(a.push(f+1),a.push(c),a.push(v))}}return s})(this.ids,this.coords,t,e,n,this.nodeSize)}};function at(t){this.options=ft(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function st(t,e,n,i,r){return{x:t,y:e,zoom:1/0,id:i,properties:r,parentId:-1,numPoints:n}}function lt(t,e){var n=t.geometry.coordinates;return{x:ht(n[0]),y:pt(n[1]),zoom:1/0,id:e,parentId:-1}}function ut(t){return{type:"Feature",properties:ct(t),geometry:{type:"Point",coordinates:[(i=t.x,360*(i-.5)),(e=t.y,n=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var e,n,i}function ct(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return ft(ft({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function ht(t){return t/360+.5}function pt(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function ft(t,e){for(var n in e)t[n]=e[n];return t}function dt(t){return t.x}function mt(t){return t.y}function vt(t,e,n,i,r,o){var a=r-n,s=o-i;if(0!==a||0!==s){var l=((t-n)*a+(e-i)*s)/(a*a+s*s);l>1?(n=r,i=o):l>0&&(n+=a*l,i+=s*l)}return(a=t-n)*a+(s=e-i)*s}function gt(t,e,n,i){var r={id:t||null,type:e,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return (function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)yt(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var i=0;i<e.length;i++)yt(t,e[i]);else if("MultiPolygon"===n)for(i=0;i<e.length;i++)for(var r=0;r<e[i].length;r++)yt(t,e[i][r])})(r),r}function yt(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function _t(t,e,n){if(e.geometry){var i=e.geometry.coordinates,r=e.geometry.type,o=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),a=[];if("Point"===r)xt(i,a);else if("MultiPoint"===r)for(var s=0;s<i.length;s++)xt(i[s],a);else if("LineString"===r)bt(i,a,o,!1);else if("MultiLineString"===r)if(n.lineMetrics)for(s=0;s<i.length;s++)return a=[],bt(i[s],a,o,!1),void t.push(gt(e.id,"LineString",a,e.properties));else wt(i,a,o,!1);else if("Polygon"===r)wt(i,a,o,!0);else{if("MultiPolygon"!==r){if("GeometryCollection"===r){for(s=0;s<e.geometry.geometries.length;s++)_t(t,{id:e.id,geometry:e.geometry.geometries[s],properties:e.properties},n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(s=0;s<i.length;s++){var l=[];wt(i[s],l,o,!0),a.push(l)}}t.push(gt(e.id,r,a,e.properties))}}function xt(t,e){e.push(Et(t[0])),e.push(St(t[1])),e.push(0)}function bt(t,e,n,i){for(var r,o,a=0,s=0;s<t.length;s++){var l=Et(t[s][0]),u=St(t[s][1]);e.push(l),e.push(u),e.push(0),s>0&&(a+=i?(r*u-l*o)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(u-o,2))),r=l,o=u}var c=e.length-3;e[2]=1,(function t(e,n,i,r){for(var o,a=r,s=e[n],l=e[n+1],u=e[i],c=e[i+1],h=n+3;h<i;h+=3){var p=vt(e[h],e[h+1],s,l,u,c);p>a&&(o=h,a=p)}a>r&&(o-n>3&&t(e,n,o,r),e[o+2]=a,i-o>3&&t(e,o,i,r))})(e,0,c,n),e[c+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function wt(t,e,n,i){for(var r=0;r<t.length;r++){var o=[];bt(t[r],o,n,i),e.push(o)}}function Et(t){return t/360+.5}function St(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function Ct(t,e,n,i,r,o,a,s){if(i/=e,o>=(n/=e)&&a<=i)return t;if(o>i||a<n)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.type,f=0===r?c.minX:c.minY,d=0===r?c.maxX:c.maxY;if(f>=n&&d<=i)l.push(c);else if(!(f>i||d<n)){var m=[];if("Point"===p||"MultiPoint"===p)Tt(h,m,n,i,r);else if("LineString"===p)At(h,m,n,i,r,!1,s.lineMetrics);else if("MultiLineString"===p)It(h,m,n,i,r,!1);else if("Polygon"===p)It(h,m,n,i,r,!0);else if("MultiPolygon"===p)for(var v=0;v<h.length;v++){var g=[];It(h[v],g,n,i,r,!0),g.length&&m.push(g)}if(m.length){if(s.lineMetrics&&"LineString"===p){for(v=0;v<m.length;v++)l.push(gt(c.id,p,m[v],c.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===m.length?(p="LineString",m=m[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===m.length?"Point":"MultiPoint"),l.push(gt(c.id,p,m,c.tags))}}}return l.length?l:null}function Tt(t,e,n,i,r){for(var o=0;o<t.length;o+=3){var a=t[o+r];a>=n&&a<=i&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function At(t,e,n,i,r,o,a){for(var s,l,u=Mt(t),c=0===r?zt:Dt,h=t.start,p=0;p<t.length-3;p+=3){var f=t[p],d=t[p+1],m=t[p+2],v=t[p+3],g=t[p+4],y=0===r?f:d,_=0===r?v:g,x=!1;a&&(s=Math.sqrt(Math.pow(f-v,2)+Math.pow(d-g,2))),y<n?_>=n&&(l=c(u,f,d,v,g,n),a&&(u.start=h+s*l)):y>i?_<=i&&(l=c(u,f,d,v,g,i),a&&(u.start=h+s*l)):kt(u,f,d,m),_<n&&y>=n&&(l=c(u,f,d,v,g,n),x=!0),_>i&&y<=i&&(l=c(u,f,d,v,g,i),x=!0),!o&&x&&(a&&(u.end=h+s*l),e.push(u),u=Mt(t)),a&&(h+=s)}var b=t.length-3;f=t[b],d=t[b+1],m=t[b+2],(y=0===r?f:d)>=n&&y<=i&&kt(u,f,d,m),b=u.length-3,o&&b>=3&&(u[b]!==u[0]||u[b+1]!==u[1])&&kt(u,u[0],u[1],u[2]),u.length&&e.push(u)}function Mt(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function It(t,e,n,i,r,o){for(var a=0;a<t.length;a++)At(t[a],e,n,i,r,o,!1)}function kt(t,e,n,i){t.push(e),t.push(n),t.push(i)}function zt(t,e,n,i,r,o){var a=(o-e)/(i-e);return t.push(o),t.push(n+(r-n)*a),t.push(1),a}function Dt(t,e,n,i,r,o){var a=(o-n)/(r-n);return t.push(e+(i-e)*a),t.push(o),t.push(1),a}function Lt(t,e){for(var n=[],i=0;i<t.length;i++){var r,o=t[i],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)r=Pt(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){r=[];for(var s=0;s<o.geometry.length;s++)r.push(Pt(o.geometry[s],e))}else if("MultiPolygon"===a)for(r=[],s=0;s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(Pt(o.geometry[s][u],e));r.push(l)}n.push(gt(o.id,a,r,o.tags))}return n}function Pt(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var i=0;i<t.length;i+=3)n.push(t[i]+e,t[i+1],t[i+2]);return n}function Ot(t,e){if(t.transformed)return t;var n,i,r,o=1<<t.z,a=t.x,s=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(i=0;i<u.length;i+=2)l.geometry.push(Rt(u[i],u[i+1],e,o,a,s));else for(i=0;i<u.length;i++){var h=[];for(r=0;r<u[i].length;r+=2)h.push(Rt(u[i][r],u[i][r+1],e,o,a,s));l.geometry.push(h)}}return t.transformed=!0,t}function Rt(t,e,n,i,r,o){return[Math.round(n*(t*i-r)),Math.round(n*(e*i-o))]}function Bt(t,e,n,i,r){for(var o=e===r.maxZoom?0:r.tolerance/((1<<e)*r.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,Ft(a,t[s],o,r);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,h=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}function Ft(t,e,n,i){var r=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<r.length;s+=3)a.push(r[s]),a.push(r[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)Nt(a,r,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<r.length;s++)Nt(a,r[s],t,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<r.length;l++){var u=r[l];for(s=0;s<u.length;s++)Nt(a,u[s],t,n,!0,0===s)}if(a.length){var c=e.tags||null;if("LineString"===o&&i.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=r.start/r.size,c.mapbox_clip_end=r.end/r.size}var p={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==e.id&&(p.id=e.id),t.features.push(p)}}function Nt(t,e,n,i,r,o){var a=i*i;if(i>0&&e.size<(r?a:i))n.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===i||e[l+2]>a)&&(n.numSimplified++,s.push(e[l]),s.push(e[l+1])),n.numPoints++;r&&(function(t,e){for(var n=0,i=0,r=t.length,o=r-2;i<r;o=i,i+=2)n+=(t[i]-t[o])*(t[i+1]+t[o+1]);if(n>0===e)for(i=0,r=t.length;i<r/2;i+=2){var a=t[i],s=t[i+1];t[i]=t[r-2-i],t[i+1]=t[r-1-i],t[r-2-i]=a,t[r-1-i]=s}})(s,o),t.push(s)}}function Vt(t,e){var n=(e=this.options=(function(t,e){for(var n in e)t[n]=e[n];return t})(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");var i=(function(t,e){var n=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)_t(n,t.features[i],e);else"Feature"===t.type?_t(n,t,e):_t(n,{geometry:t},e);return n})(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=(function(t,e){var n=e.buffer/e.extent,i=t,r=Ct(t,1,-1-n,n,0,-1,2,e),o=Ct(t,1,1-n,2+n,0,-1,2,e);return(r||o)&&(i=Ct(t,1,-n,1+n,0,-1,2,e)||[],r&&(i=Lt(r,1).concat(i)),o&&(i=i.concat(Lt(o,-1)))),i})(i,e)).length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function jt(t,e,n){return 32*((1<<t)*n+e)+t}function Ut(t,e){var n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var i=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!i)return e(null,null);var r=new R(i.features),o=j(r);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:r,rawData:o.buffer})}at.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var n="prepare "+t.length+" points";e&&console.time(n),this.points=t;var i=t.map(lt);e&&console.timeEnd(n);for(var r=this.options.maxZoom;r>=this.options.minZoom;r--){var o=+Date.now();this.trees[r+1]=nt(i,dt,mt,this.options.nodeSize,Float32Array),i=this._cluster(i,r),e&&console.log("z%d: %d clusters in %dms",r,i.length,+Date.now()-o)}return this.trees[this.options.minZoom]=nt(i,dt,mt,this.options.nodeSize,Float32Array),e&&console.timeEnd("total time"),this},getClusters:function(t,e){for(var n=this.trees[this._limitZoom(e)],i=n.range(ht(t[0]),pt(t[3]),ht(t[2]),pt(t[1])),r=[],o=0;o<i.length;o++){var a=n.points[i[o]];r.push(a.numPoints?ut(a):this.points[a.id])}return r},getChildren:function(t,e){for(var n=this.trees[e+1].points[t],i=this.options.radius/(this.options.extent*Math.pow(2,e)),r=this.trees[e+1].within(n.x,n.y,i),o=[],a=0;a<r.length;a++){var s=this.trees[e+1].points[r[a]];s.parentId===t&&o.push(s.numPoints?ut(s):this.points[s.id])}return o},getLeaves:function(t,e,n,i){n=n||10,i=i||0;var r=[];return this._appendLeaves(r,t,e,n,i,0),r},getTile:function(t,e,n){var i=this.trees[this._limitZoom(t)],r=Math.pow(2,t),o=this.options.extent,a=this.options.radius/o,s=(n-a)/r,l=(n+1+a)/r,u={features:[]};return this._addTileFeatures(i.range((e-a)/r,s,(e+1+a)/r,l),i.points,e,n,r,u),0===e&&this._addTileFeatures(i.range(1-a/r,s,1,l),i.points,r,n,r,u),e===r-1&&this._addTileFeatures(i.range(0,s,a/r,l),i.points,-1,n,r,u),u.features.length?u:null},getClusterExpansionZoom:function(t,e){for(;e<this.options.maxZoom;){var n=this.getChildren(t,e);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},_appendLeaves:function(t,e,n,i,r,o){for(var a=this.getChildren(e,n),s=0;s<a.length;s++){var l=a[s].properties;if(l.cluster?o+l.point_count<=r?o+=l.point_count:o=this._appendLeaves(t,l.cluster_id,n+1,i,r,o):o<r?o++:t.push(a[s]),t.length===i)break}return o},_addTileFeatures:function(t,e,n,i,r,o){for(var a=0;a<t.length;a++){var s=e[t[a]];o.features.push({type:1,geometry:[[Math.round(this.options.extent*(s.x*r-n)),Math.round(this.options.extent*(s.y*r-i))]],tags:s.numPoints?ct(s):this.points[s.id].properties})}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var n=[],i=this.options.radius/(this.options.extent*Math.pow(2,e)),r=0;r<t.length;r++){var o=t[r];if(!(o.zoom<=e)){o.zoom=e;var a=this.trees[e+1],s=a.within(o.x,o.y,i),l=o.numPoints||1,u=o.x*l,c=o.y*l,h=null;this.options.reduce&&(h=this.options.initial(),this._accumulate(h,o));for(var p=0;p<s.length;p++){var f=a.points[s[p]];if(e<f.zoom){var d=f.numPoints||1;f.zoom=e,u+=f.x*d,c+=f.y*d,l+=d,f.parentId=r,this.options.reduce&&this._accumulate(h,f)}}1===l?n.push(o):(o.parentId=r,n.push(st(u/l,c/l,l,r,h)))}}return n},_accumulate:function(t,e){var n=e.numPoints?e.properties:this.options.map(this.points[e.id].properties);this.options.reduce(t,n)}},Vt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,debug:0},Vt.prototype.splitTile=function(t,e,n,i,r,o,a){for(var s=[t,e,n,i],l=this.options,u=l.debug;s.length;){i=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var c=1<<e,h=jt(e,n,i),p=this.tiles[h];if(!p&&(u>1&&console.time("creation"),p=this.tiles[h]=Bt(t,e,n,i,l),this.tileCoords.push({z:e,x:n,y:i}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var f="z"+e;this.stats[f]=(this.stats[f]||0)+1,this.total++}if(p.source=t,r){if(e===l.maxZoom||e===r)continue;var d=1<<r-e;if(n!==Math.floor(o/d)||i!==Math.floor(a/d))continue}else if(e===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue;if(p.source=null,0!==t.length){u>1&&console.time("clipping");var m,v,g,y,_,x,b=.5*l.buffer/l.extent,w=.5-b,E=.5+b,S=1+b;m=v=g=y=null,_=Ct(t,c,n-b,n+E,0,p.minX,p.maxX,l),x=Ct(t,c,n+w,n+S,0,p.minX,p.maxX,l),t=null,_&&(m=Ct(_,c,i-b,i+E,1,p.minY,p.maxY,l),v=Ct(_,c,i+w,i+S,1,p.minY,p.maxY,l),_=null),x&&(g=Ct(x,c,i-b,i+E,1,p.minY,p.maxY,l),y=Ct(x,c,i+w,i+S,1,p.minY,p.maxY,l),x=null),u>1&&console.timeEnd("clipping"),s.push(m||[],e+1,2*n,2*i),s.push(v||[],e+1,2*n,2*i+1),s.push(g||[],e+1,2*n+1,2*i),s.push(y||[],e+1,2*n+1,2*i+1)}}},Vt.prototype.getTile=function(t,e,n){var i=this.options,r=i.extent,o=i.debug;if(t<0||t>24)return null;var a=1<<t,s=jt(t,e=(e%a+a)%a,n);if(this.tiles[s])return Ot(this.tiles[s],r);o>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var l,u=t,c=e,h=n;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[jt(u,c,h)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",u,c,h),o>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,t,e,n),o>1&&console.timeEnd("drilling down"),this.tiles[s]?Ot(this.tiles[s],r):null):null};var qt=(function(e){function n(t,n,i){e.call(this,t,n,Ut),i&&(this.loadGeoJSON=i)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},n.prototype._loadData=function(){var t=this;if(this._pendingCallback&&this._pendingLoadDataParams){var e=this._pendingCallback,n=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams,this.loadGeoJSON(n,(function(i,r){if(i||!r)return e(i);if("object"!=typeof r)return e(new Error("Input data is not a valid GeoJSON object."));!(function t(e,n){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(z(t,n)),e;case"Feature":return e.geometry=t(e.geometry,n),e;case"Polygon":case"MultiPolygon":return (function(t,e){return"Polygon"===t.type?t.coordinates=D(t.coordinates,e):"MultiPolygon"===t.type&&(t.coordinates=t.coordinates.map(z(D,e))),t})(e,n);default:return e}})(r,!0);try{t._geoJSONIndex=n.cluster?(function(t){return new at(t)})(n.superclusterOptions).load(r.features):new Vt(r,n.geojsonVtOptions)}catch(i){return e(i)}t.loaded={};var o={};if(n.request&&n.request.collectResourceTiming){var a=w(n.request.url);a&&(o.resourceTiming={},o.resourceTiming[n.source]=JSON.parse(JSON.stringify(a)))}e(null,o)}))}},n.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},n.prototype.reloadTile=function(t,n){var i=this.loaded,r=t.uid;return i&&i[r]?e.prototype.reloadTile.call(this,t,n):this.loadTile(t,n)},n.prototype.loadGeoJSON=function(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error("Input data is not a valid GeoJSON object."));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error("Input data is not a valid GeoJSON object."))}}},n.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},n})(S),$t=function(e){var n=this;this.self=e,this.actor=new t.default$7(e,this),this.layerIndexes={},this.workerSourceTypes={vector:S,geojson:qt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(n.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');n.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isLoaded())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText}};return $t.prototype.setLayers=function(t,e,n){this.getLayerIndex(t).replace(e),n()},$t.prototype.updateLayers=function(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()},$t.prototype.loadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).loadTile(e,n)},$t.prototype.loadDEMTile=function(t,e,n){this.getDEMWorkerSource(t,e.source).loadTile(e,n)},$t.prototype.reloadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).reloadTile(e,n)},$t.prototype.abortTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)},$t.prototype.removeTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)},$t.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},$t.prototype.removeSource=function(t,e,n){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var i=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==i.removeSource?i.removeSource(e,n):n()}},$t.prototype.loadWorkerSource=function(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}},$t.prototype.loadRTLTextPlugin=function(e,n,i){try{t.plugin.isLoaded()||(this.self.importScripts(n),i(t.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+n)))}catch(t){i(t.toString())}},$t.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new i),e},$t.prototype.getWorkerSource=function(t,e,n){var i=this;if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][n]){var r={send:function(e,n,r){i.actor.send(e,n,r,t)}};this.workerSources[t][e][n]=new this.workerSourceTypes[e](r,this.getLayerIndex(t))}return this.workerSources[t][e][n]},$t.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new C),this.demWorkerSources[t][e]},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&new $t(self),$t})),i(0,(function(t){var e=t.createCommonjsModule((function(t){function e(t){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&(function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(n);try{e=new Worker(i),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(i),t})()&&"Uint8ClampedArray"in window&&(function(t){return void 0===n[t]&&(n[t]=(function(t){var n=document.createElement("canvas"),i=Object.create(e.webGLContextAttributes);return i.failIfMajorPerformanceCaveat=t,n.probablySupportsContext?n.probablySupportsContext("webgl",i)||n.probablySupportsContext("experimental-webgl",i):n.supportsContext?n.supportsContext("webgl",i)||n.supportsContext("experimental-webgl",i):n.getContext("webgl",i)||n.getContext("experimental-webgl",i)})(t)),n[t]})(t&&t.failIfMajorPerformanceCaveat))}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e);var n={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}})),n=t.default.performance&&t.default.performance.now?t.default.performance.now.bind(t.default.performance):Date.now.bind(Date),i=t.default.requestAnimationFrame||t.default.mozRequestAnimationFrame||t.default.webkitRequestAnimationFrame||t.default.msRequestAnimationFrame,r=t.default.cancelAnimationFrame||t.default.mozCancelAnimationFrame||t.default.webkitCancelAnimationFrame||t.default.msCancelAnimationFrame,o={now:n,frame:function(t){return i(t)},cancelFrame:function(t){return r(t)},getImageData:function(e){var n=t.default.document.createElement("canvas"),i=n.getContext("2d");if(!i)throw new Error("failed to create canvas 2d context");return n.width=e.width,n.height=e.height,i.drawImage(e,0,0,e.width,e.height),i.getImageData(0,0,e.width,e.height)},hardwareConcurrency:t.default.navigator.hardwareConcurrency||4,get devicePixelRatio(){return t.default.devicePixelRatio},supportsWebp:!1};if(t.default.document){var a=t.default.document.createElement("img");a.onload=function(){o.supportsWebp=!0},a.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="}var s={create:function(e,n,i){var r=t.default.document.createElement(e);return n&&(r.className=n),i&&i.appendChild(r),r},createNS:function(e,n){return t.default.document.createElementNS(e,n)}},l=t.default.document?t.default.document.documentElement.style:null;function u(t){if(!l)return null;for(var e=0;e<t.length;e++)if(t[e]in l)return t[e];return t[0]}var c,h=u(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);s.disableDrag=function(){l&&h&&(c=l[h],l[h]="none")},s.enableDrag=function(){l&&h&&(l[h]=c)};var p=u(["transform","WebkitTransform"]);s.setTransform=function(t,e){t.style[p]=e};var f=!1;try{var d=Object.defineProperty({},"passive",{get:function(){f=!0}});t.default.addEventListener("test",d,d),t.default.removeEventListener("test",d,d)}catch(t){f=!1}s.addEventListener=function(t,e,n,i){void 0===i&&(i={}),"passive"in i&&f?t.addEventListener(e,n,i):t.addEventListener(e,n,i.capture)},s.removeEventListener=function(t,e,n,i){void 0===i&&(i={}),"passive"in i&&f?t.removeEventListener(e,n,i):t.removeEventListener(e,n,i.capture)};var m=function(e){e.preventDefault(),e.stopPropagation(),t.default.removeEventListener("click",m,!0)};s.suppressClick=function(){t.default.addEventListener("click",m,!0),t.default.setTimeout((function(){t.default.removeEventListener("click",m,!0)}),0)},s.mousePos=function(e,n){var i=e.getBoundingClientRect();return n=n.touches?n.touches[0]:n,new t.default$1(n.clientX-i.left-e.clientLeft,n.clientY-i.top-e.clientTop)},s.touchPos=function(e,n){for(var i=e.getBoundingClientRect(),r=[],o="touchend"===n.type?n.changedTouches:n.touches,a=0;a<o.length;a++)r.push(new t.default$1(o[a].clientX-i.left-e.clientLeft,o[a].clientY-i.top-e.clientTop));return r},s.mouseButton=function(e){return void 0!==t.default.InstallTrigger&&2===e.button&&e.ctrlKey&&t.default.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},s.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var v={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null},g="See https://www.mapbox.com/api-documentation/#access-tokens";function y(t,e){var n=C(v.API_URL);if(t.protocol=n.protocol,t.authority=n.authority,"/"!==n.path&&(t.path=""+n.path+t.path),!v.REQUIRE_ACCESS_TOKEN)return T(t);if(!(e=e||v.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+g);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+g);return t.params.push("access_token="+e),T(t)}function _(t){return 0===t.indexOf("mapbox:")}var x=function(t,e){if(!_(t))return t;var n=C(t);return n.path="/v4/"+n.authority+".json",n.params.push("secure"),y(n,e)},b=function(t,e,n,i){var r=C(t);return _(t)?(r.path="/styles/v1"+r.path+"/sprite"+e+n,y(r,i)):(r.path+=""+e+n,T(r))},w=/(\.(png|jpg)\d*)(?=$)/,E=function(t,e,n){if(!e||!_(e))return t;var i=C(t),r=o.devicePixelRatio>=2||512===n?"@2x":"",a=o.supportsWebp?".webp":"$1";return i.path=i.path.replace(w,""+r+a),(function(t){for(var e=0;e<t.length;e++)0===t[e].indexOf("access_token=tk.")&&(t[e]="access_token="+(v.ACCESS_TOKEN||""))})(i.params),T(i)},S=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function C(t){var e=t.match(S);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function T(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}var A=t.default.HTMLImageElement,M=t.default.HTMLCanvasElement,I=t.default.HTMLVideoElement,k=t.default.ImageData,z=function(t,e,n,i){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,i)};z.prototype.update=function(t,e){var n=t.width,i=t.height,r=!this.size||this.size[0]!==n||this.size[1]!==i,o=this.context,a=o.gl;this.useMipmap=Boolean(e&&e.useMipmap),a.bindTexture(a.TEXTURE_2D,this.texture),r?(this.size=[n,i],o.pixelStoreUnpack.set(1),this.format!==a.RGBA||e&&!1===e.premultiply||o.pixelStoreUnpackPremultiplyAlpha.set(!0),t instanceof A||t instanceof M||t instanceof I||t instanceof k?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,n,i,0,this.format,a.UNSIGNED_BYTE,t.data)):t instanceof A||t instanceof M||t instanceof I||t instanceof k?a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,0,0,n,i,a.RGBA,a.UNSIGNED_BYTE,t.data),this.useMipmap&&this.isSizePowerOfTwo()&&a.generateMipmap(a.TEXTURE_2D)},z.prototype.bind=function(t,e,n){var i=this.context.gl;i.bindTexture(i.TEXTURE_2D,this.texture),n!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=i.LINEAR),t!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e),this.wrap=e)},z.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},z.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var D=function(){this.images={},this.loaded=!1,this.requestors=[],this.shelfPack=new t.default$2(64,64,{autoResize:!0}),this.patterns={},this.atlasImage=new t.RGBAImage({width:64,height:64}),this.dirty=!0};D.prototype.isLoaded=function(){return this.loaded},D.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t,t)){for(var e=0,n=this.requestors;e<n.length;e+=1){var i=n[e],r=i.ids,o=i.callback;this._notify(r,o)}this.requestors=[]}},D.prototype.getImage=function(t){return this.images[t]},D.prototype.addImage=function(t,e){this.images[t]=e},D.prototype.removeImage=function(t){delete this.images[t];var e=this.patterns[t];e&&(this.shelfPack.unref(e.bin),delete this.patterns[t])},D.prototype.getImages=function(t,e){var n=!0;if(!this.isLoaded())for(var i=0,r=t;i<r.length;i+=1){var o=r[i];this.images[o]||(n=!1)}this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})},D.prototype._notify=function(t,e){for(var n={},i=0,r=t;i<r.length;i+=1){var o=r[i],a=this.images[o];a&&(n[o]={data:a.data.clone(),pixelRatio:a.pixelRatio,sdf:a.sdf})}e(null,n)},D.prototype.getPixelSize=function(){return{width:this.shelfPack.w,height:this.shelfPack.h}},D.prototype.getPattern=function(e){var n=this.patterns[e];if(n)return n.position;var i=this.getImage(e);if(!i)return null;var r=i.data.width+2,o=i.data.height+2,a=this.shelfPack.packOne(r,o);if(!a)return null;this.atlasImage.resize(this.getPixelSize());var s=i.data,l=this.atlasImage,u=a.x+1,c=a.y+1,h=s.width,p=s.height;t.RGBAImage.copy(s,l,{x:0,y:0},{x:u,y:c},{width:h,height:p}),t.RGBAImage.copy(s,l,{x:0,y:p-1},{x:u,y:c-1},{width:h,height:1}),t.RGBAImage.copy(s,l,{x:0,y:0},{x:u,y:c+p},{width:h,height:1}),t.RGBAImage.copy(s,l,{x:h-1,y:0},{x:u-1,y:c},{width:1,height:p}),t.RGBAImage.copy(s,l,{x:0,y:0},{x:u+h,y:c},{width:1,height:p}),this.dirty=!0;var f=new t.ImagePosition(a,i);return this.patterns[e]={bin:a,position:f},f},D.prototype.bind=function(t){var e=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new z(t,this.atlasImage,e.RGBA),this.atlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)};var L=O,P=1e20;function O(t,e,n,i,r,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=i||.25,this.fontFamily=r||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function R(t,e,n,i,r,o,a){for(var s=0;s<e;s++){for(var l=0;l<n;l++)i[l]=t[l*e+s];for(B(i,r,o,a,n),l=0;l<n;l++)t[l*e+s]=r[l]}for(l=0;l<n;l++){for(s=0;s<e;s++)i[s]=t[l*e+s];for(B(i,r,o,a,e),s=0;s<e;s++)t[l*e+s]=Math.sqrt(r[s])}}function B(t,e,n,i,r){n[0]=0,i[0]=-P,i[1]=+P;for(var o=1,a=0;o<r;o++){for(var s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);s<=i[a];)a--,s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,i[a]=s,i[a+1]=+P}for(o=0,a=0;o<r;o++){for(;i[a+1]<o;)a++;e[o]=(o-n[a])*(o-n[a])+t[n[a]]}}O.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var r=e.data[4*i+3]/255;this.gridOuter[i]=1===r?0:0===r?P:Math.pow(Math.max(0,.5-r),2),this.gridInner[i]=1===r?P:0===r?0:Math.pow(Math.max(0,r-.5),2)}for(R(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),R(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++){var o=this.gridOuter[i]-this.gridInner[i];n[i]=Math.max(0,Math.min(255,Math.round(255-255*(o/this.radius+this.cutoff))))}return n};var F=function(t,e){this.requestTransform=t,this.localIdeographFontFamily=e,this.entries={}};F.prototype.setURL=function(t){this.url=t},F.prototype.getGlyphs=function(e,n){var i=this,r=[];for(var o in e)for(var a=0,s=e[o];a<s.length;a+=1){var l=s[a];r.push({stack:o,id:l})}t.asyncAll(r,(function(t,e){var n=t.stack,r=t.id,o=i.entries[n];o||(o=i.entries[n]={glyphs:{},requests:{}});var a=o.glyphs[r];if(void 0===a)if(a=i._tinySDF(o,n,r))e(null,{stack:n,id:r,glyph:a});else{var s=Math.floor(r/256);if(256*s>65535)e(new Error("glyphs > 65535 not supported"));else{var l=o.requests[s];l||(l=o.requests[s]=[],F.loadGlyphRange(n,s,i.url,i.requestTransform,(function(t,e){if(e)for(var n in e)o.glyphs[+n]=e[+n];for(var i=0,r=l;i<r.length;i+=1)(0,r[i])(t,e);delete o.requests[s]}))),l.push((function(t,i){t?e(t):i&&e(null,{stack:n,id:r,glyph:i[r]||null})}))}}else e(null,{stack:n,id:r,glyph:a})}),(function(t,e){if(t)n(t);else if(e){for(var i={},r=0,o=e;r<o.length;r+=1){var a=o[r],s=a.stack,l=a.id,u=a.glyph;(i[s]||(i[s]={}))[l]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}n(null,i)}}))},F.prototype._tinySDF=function(e,n,i){var r=this.localIdeographFontFamily;if(r&&(t.default$4["CJK Unified Ideographs"](i)||t.default$4["Hangul Syllables"](i))){var o=e.tinySDF;if(!o){var a="400";/bold/i.test(n)?a="900":/medium/i.test(n)?a="500":/light/i.test(n)&&(a="200"),o=e.tinySDF=new F.TinySDF(24,3,8,.25,r,a)}return{id:i,bitmap:new t.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},F.loadGlyphRange=function(e,n,i,r,o){var a=256*n,s=a+255,l=r(function(t,e){if(!_(t))return t;var n=C(t);return n.path="/fonts/v1"+n.path,y(n,e)}(i).replace("{fontstack}",e).replace("{range}",a+"-"+s),t.ResourceType.Glyphs);t.getArrayBuffer(l,(function(e,n){if(e)o(e);else if(n){for(var i={},r=0,a=t.default$3(n.data);r<a.length;r+=1){var s=a[r];i[s.id]=s}o(null,i)}}))},F.TinySDF=L;var N=function(){this.specification=t.default$5.light.position};N.prototype.possiblyEvaluate=function(e,n){return t.sphericalToCartesian(e.expression.evaluate(n))},N.prototype.interpolate=function(e,n,i){return{x:t.number(e.x,n.x,i),y:t.number(e.y,n.y,i),z:t.number(e.z,n.z,i)}};var V=new t.Properties({anchor:new t.DataConstantProperty(t.default$5.light.anchor),position:new N,color:new t.DataConstantProperty(t.default$5.light.color),intensity:new t.DataConstantProperty(t.default$5.light.intensity)}),j=(function(e){function n(n){e.call(this),this._transitionable=new t.Transitionable(V),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getLight=function(){return this._transitionable.serialize()},n.prototype.setLight=function(e){if(!this._validate(t.validateLight,e))for(var n in e){var i=e[n];t.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-"-transition".length),i):this._transitionable.setValue(n,i)}},n.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},n.prototype.hasTransition=function(){return this._transitioning.hasTransition()},n.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},n.prototype._validate=function(e,n){return t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.default$5})))},n})(t.Evented),U=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};U.prototype.getDash=function(t,e){var n=t.join(",")+String(e);return this.positions[n]||(this.positions[n]=this.addDash(t,e)),this.positions[n]},U.prototype.addDash=function(e,n){var i=n?7:0,r=2*i+1;if(this.nextRow+r>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<e.length;a++)o+=e[a];for(var s=this.width/o,l=s/2,u=e.length%2==1,c=-i;c<=i;c++)for(var h=this.nextRow+i+c,p=this.width*h,f=u?-e[e.length-1]:0,d=e[0],m=1,v=0;v<this.width;v++){for(;d<v/s;)f=d,d+=e[m],u&&m===e.length-1&&(d+=e[0]),m++;var g=Math.abs(v-f*s),y=Math.abs(v-d*s),_=Math.min(g,y),x=m%2==1,b=void 0;if(n){var w=i?c/i*(l+1):0;if(x){var E=l-Math.abs(w);b=Math.sqrt(_*_+E*E)}else b=l-Math.sqrt(_*_+w*w)}else b=(x?1:-1)*_;this.data[3+4*(p+v)]=Math.max(0,Math.min(255,b+128))}var S={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:o};return this.nextRow+=r,this.dirty=!0,S},U.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,this.data))};var q=function e(n,i){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var r=this.workerPool.acquire(this.id),o=0;o<r.length;o++){var a=r[o],s=new e.Actor(a,i,this.id);s.name="Worker "+o,this.actors.push(s)}};function $(e,n,i){var r=function(e,n){if(e)return i(e);if(n){var r=t.pick(n,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);n.vector_layers&&(r.vectorLayers=n.vector_layers,r.vectorLayerIds=r.vectorLayers.map((function(t){return t.id}))),i(null,r)}};e.url?t.getJSON(n(x(e.url),t.ResourceType.Source),r):o.frame((function(){return r(null,e)}))}q.prototype.broadcast=function(e,n,i){i=i||function(){},t.asyncAll(this.actors,(function(t,i){t.send(e,n,i)}),i)},q.prototype.send=function(t,e,n,i){return("number"!=typeof i||isNaN(i))&&(i=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[i].send(t,e,n),i},q.prototype.remove=function(){this.actors.forEach((function(t){t.remove()})),this.actors=[],this.workerPool.release(this.id)},q.Actor=t.default$7;var Z=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Z.prototype.wrap=function(){return new Z(t.wrap(this.lng,-180,180),this.lat)},Z.prototype.toArray=function(){return[this.lng,this.lat]},Z.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Z.prototype.toBounds=function(t){var e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new G(new Z(this.lng-n,this.lat-e),new Z(this.lng+n,this.lat+e))},Z.convert=function(t){if(t instanceof Z)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Z(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Z(Number(t.lng),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var G=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};G.prototype.setNorthEast=function(t){return this._ne=t instanceof Z?new Z(t.lng,t.lat):Z.convert(t),this},G.prototype.setSouthWest=function(t){return this._sw=t instanceof Z?new Z(t.lng,t.lat):Z.convert(t),this},G.prototype.extend=function(t){var e,n,i=this._sw,r=this._ne;if(t instanceof Z)e=t,n=t;else{if(!(t instanceof G))return Array.isArray(t)?t.every(Array.isArray)?this.extend(G.convert(t)):this.extend(Z.convert(t)):this;if(e=t._sw,n=t._ne,!e||!n)return this}return i||r?(i.lng=Math.min(e.lng,i.lng),i.lat=Math.min(e.lat,i.lat),r.lng=Math.max(n.lng,r.lng),r.lat=Math.max(n.lat,r.lat)):(this._sw=new Z(e.lng,e.lat),this._ne=new Z(n.lng,n.lat)),this},G.prototype.getCenter=function(){return new Z((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},G.prototype.getSouthWest=function(){return this._sw},G.prototype.getNorthEast=function(){return this._ne},G.prototype.getNorthWest=function(){return new Z(this.getWest(),this.getNorth())},G.prototype.getSouthEast=function(){return new Z(this.getEast(),this.getSouth())},G.prototype.getWest=function(){return this._sw.lng},G.prototype.getSouth=function(){return this._sw.lat},G.prototype.getEast=function(){return this._ne.lng},G.prototype.getNorth=function(){return this._ne.lat},G.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},G.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},G.prototype.isEmpty=function(){return!(this._sw&&this._ne)},G.convert=function(t){return!t||t instanceof G?t:new G(t)};var W=function(t,e,n){this.bounds=G.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=n||24};W.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},W.prototype.contains=function(t){var e=Math.floor(this.lngX(this.bounds.getWest(),t.z)),n=Math.floor(this.latY(this.bounds.getNorth(),t.z)),i=Math.ceil(this.lngX(this.bounds.getEast(),t.z)),r=Math.ceil(this.latY(this.bounds.getSouth(),t.z));return t.x>=e&&t.x<i&&t.y>=n&&t.y<r},W.prototype.lngX=function(t,e){return(t+180)*(Math.pow(2,e)/360)},W.prototype.latY=function(e,n){var i=t.clamp(Math.sin(Math.PI/180*e),-.9999,.9999),r=Math.pow(2,n)/(2*Math.PI);return Math.pow(2,n-1)+.5*Math.log((1+i)/(1-i))*-r};var Y=(function(e){function n(n,i,r,o){if(e.call(this),this.id=n,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,t.extend(this,t.pick(i,["url","scheme","tileSize"])),this._options=t.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),$(this._options,this.map._transformRequest,(function(n,i){n?e.fire(new t.ErrorEvent(n)):i&&(t.extend(e,i),i.bounds&&(e.tileBounds=new W(i.bounds,e.minzoom,e.maxzoom)),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.loadTile=function(e,n){var i=E(e.tileID.canonical.url(this.tiles,this.scheme),this.url),r={request:this.map._transformRequest(i,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};function a(t,i){return e.aborted?n(null):t?n(t):(i&&i.resourceTiming&&(e.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&e.setExpiryData(i),e.loadVectorData(i,this.map.painter),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}r.request.collectResourceTiming=this._collectResourceTiming,void 0===e.workerID||"expired"===e.state?e.workerID=this.dispatcher.send("loadTile",r,a.bind(this)):"loading"===e.state?e.reloadCallback=n:this.dispatcher.send("reloadTile",r,a.bind(this),e.workerID)},n.prototype.abortTile=function(t){this.dispatcher.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},n.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},n.prototype.hasTransition=function(){return!1},n})(t.Evented),H=(function(e){function n(n,i,r,o){e.call(this),this.id=n,this.dispatcher=r,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({},i),t.extend(this,t.pick(i,["url","scheme","tileSize"]))}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),$(this._options,this.map._transformRequest,(function(n,i){n?e.fire(new t.ErrorEvent(n)):i&&(t.extend(e,i),i.bounds&&(e.tileBounds=new W(i.bounds,e.minzoom,e.maxzoom)),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.loadTile=function(e,n){var i=this,r=E(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(r,t.ResourceType.Tile),(function(t,r){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(t)e.state="errored",n(t);else if(r){i.map._refreshExpiredTiles&&e.setExpiryData(r),delete r.cacheControl,delete r.expires;var o=i.map.painter.context,a=o.gl;e.texture=i.map.painter.getTileTexture(r.width),e.texture?e.texture.update(r,{useMipmap:!0}):(e.texture=new z(o,r,a.RGBA,{useMipmap:!0}),e.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),o.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax)),e.state="loaded",n(null)}}))},n.prototype.abortTile=function(t,e){t.request&&(t.request.abort(),delete t.request),e()},n.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},n.prototype.hasTransition=function(){return!1},n})(t.Evented),X=(function(e){function n(n,i,r,o){e.call(this,n,i,r,o),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({},i),this.encoding=i.encoding||"mapbox"}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},n.prototype.loadTile=function(e,n){var i=E(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(i,t.ResourceType.Tile),function(t,i){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(t)e.state="errored",n(t);else if(i){this.map._refreshExpiredTiles&&e.setExpiryData(i),delete i.cacheControl,delete i.expires;var r=o.getImageData(i),a={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:r,encoding:this.encoding};e.workerID&&"expired"!==e.state||(e.workerID=this.dispatcher.send("loadDEMTile",a,function(t,i){t&&(e.state="errored",n(t)),i&&(e.dem=i,e.needsHillshadePrepare=!0,e.state="loaded",n(null))}.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},n.prototype._getNeighboringTiles=function(e){var n=e.canonical,i=Math.pow(2,n.z),r=(n.x-1+i)%i,o=0===n.x?e.wrap-1:e.wrap,a=(n.x+1+i)%i,s=n.x+1===i?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y).key]={backfilled:!1},n.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y-1).key]={backfilled:!1}),n.y+1<i&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y+1).key]={backfilled:!1}),l},n.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",this.dispatcher.send("removeDEMTile",{uid:t.uid,source:this.id},void 0,t.workerID)},n})(H),K=(function(e){function n(n,i,r,o){e.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this.dispatcher=r,this.setEventedParent(o),this._data=i.data,this._options=t.extend({},i),this._collectResourceTiming=i.collectResourceTiming,this._resourceTiming=[],void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type);var a=t.default$8/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*a,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*a,extent:t.default$8,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?Math.min(i.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:t.default$8,radius:(i.clusterRadius||50)*a,log:!1}},i.workerOptions)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(n){if(n)e.fire(new t.ErrorEvent(n));else{var i={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(i.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",i))}}))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setData=function(e){var n=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(e){if(e)return n.fire(new t.ErrorEvent(e));var i={dataType:"source",sourceDataType:"content"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(i.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new t.Event("data",i))})),this},n.prototype._updateWorkerData=function(e){var n,i,r=this,o=t.extend({},this.workerOptions),a=this._data;"string"==typeof a?(o.request=this.map._transformRequest((n=a,(i=t.default.document.createElement("a")).href=n,i.href),t.ResourceType.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(a),this.workerID=this.dispatcher.send(this.type+"."+o.source+".loadData",o,(function(t,n){r._removed||n&&n.abandoned||(r._loaded=!0,n&&n.resourceTiming&&n.resourceTiming[r.id]&&(r._resourceTiming=n.resourceTiming[r.id].slice(0)),r.dispatcher.send(r.type+"."+o.source+".coalesce",null,null,r.workerID),e(t))}),this.workerID)},n.prototype.loadTile=function(t,e){var n=this,i=void 0===t.workerID?"loadTile":"reloadTile",r={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};t.workerID=this.dispatcher.send(i,r,(function(r,o){return t.unloadVectorData(),t.aborted?e(null):r?e(r):(t.loadVectorData(o,n.map.painter,"reloadTile"===i),e(null))}),this.workerID)},n.prototype.abortTile=function(t){t.aborted=!0},n.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},null,t.workerID)},n.prototype.onRemove=function(){this._removed=!0,this.dispatcher.send("removeSource",{type:this.type,source:this.id},null,this.workerID)},n.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},n.prototype.hasTransition=function(){return!1},n})(t.Evented),J=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Q=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Q.prototype.bind=function(t,e,n,i,r,o,a,s){this.context=t;for(var l=this.boundPaintVertexBuffers.length!==i.length,u=0;!l&&u<i.length;u++)this.boundPaintVertexBuffers[u]!==i[u]&&(l=!0);var c=!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==n||l||this.boundIndexBuffer!==r||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==a||this.boundDynamicVertexBuffer2!==s;!t.extVertexArrayObject||c?this.freshBind(e,n,i,r,o,a,s):(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),r&&r.dynamicDraw&&r.bind(),s&&s.bind())},Q.prototype.freshBind=function(t,e,n,i,r,o,a){var s,l=t.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=i,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=u.currentNumAttributes||0;for(var h=l;h<s;h++)c.disableVertexAttribArray(h)}e.enableAttributes(c,t);for(var p=0,f=n;p<f.length;p+=1)f[p].enableAttributes(c,t);o&&o.enableAttributes(c,t),a&&a.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,r);for(var d=0,m=n;d<m.length;d+=1){var v=m[d];v.bind(),v.setVertexAttribPointers(c,t,r)}o&&(o.bind(),o.setVertexAttribPointers(c,t,r)),i&&i.bind(),a&&(a.bind(),a.setVertexAttribPointers(c,t,r)),u.currentNumAttributes=l},Q.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var tt=(function(e){function n(t,n,i,r){e.call(this),this.id=t,this.dispatcher=i,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(r),this.options=n}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._transformRequest(this.url,t.ResourceType.Image),(function(n,i){n?e.fire(new t.ErrorEvent(n)):i&&(e.image=o.getImageData(i),e._finishLoading())}))},n.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setCoordinates=function(e){this.coordinates=e;var n=this.map,i=e.map((function(t){return n.transform.locationCoordinate(Z.convert(t)).zoomTo(0)})),r=this.centerCoord=t.getCoordinatesCenter(i);r.column=Math.floor(r.column),r.row=Math.floor(r.row),this.tileID=new t.CanonicalTileID(r.zoom,r.column,r.row),this.minzoom=this.maxzoom=r.zoom;var o=i.map((function(e){var n=e.zoomTo(r.zoom);return new t.default$1(Math.round((n.column-r.column)*t.default$8),Math.round((n.row-r.row)*t.default$8))}));return this._boundsArray=new t.RasterBoundsArray,this._boundsArray.emplaceBack(o[0].x,o[0].y,0,0),this._boundsArray.emplaceBack(o[1].x,o[1].y,t.default$8,0),this._boundsArray.emplaceBack(o[3].x,o[3].y,0,t.default$8),this._boundsArray.emplaceBack(o[2].x,o[2].y,t.default$8,t.default$8),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},n.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var t=this.map.painter.context,e=t.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,J.members)),this.boundsVAO||(this.boundsVAO=new Q),this.texture||(this.texture=new z(t,this.image,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[n];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},n.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return!1},n})(t.Evented),et=(function(e){function n(t,n,i,r){e.call(this,t,n,i,r),this.roundZoom=!0,this.type="video",this.options=n}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this,n=this.options;this.urls=[];for(var i=0,r=n.urls;i<r.length;i+=1){var o=r[i];e.urls.push(e.map._transformRequest(o,t.ResourceType.Source).url)}t.getVideo(this.urls,(function(n,i){n?e.fire(new t.ErrorEvent(n)):i&&(e.video=i,e.video.loop=!0,e.video.addEventListener("playing",(function(){e.map._rerender()})),e.map&&e.video.play(),e._finishLoading())}))},n.prototype.getVideo=function(){return this.video},n.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},n.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var t=this.map.painter.context,e=t.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,J.members)),this.boundsVAO||(this.boundsVAO=new Q),this.texture?this.video.paused||(this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,this.video)):(this.texture=new z(t,this.video,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[n];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this.video&&!this.video.paused},n})(tt),nt=(function(e){function n(n,i,r,o){e.call(this,n,i,r,o),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some((function(t){return!Array.isArray(t)||2!==t.length||t.some((function(t){return"number"!=typeof t}))}))||this.fire(new t.ErrorEvent(new t.default$9("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.default$9("sources."+n,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new t.ErrorEvent(new t.default$9("sources."+n,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof t.default.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.default$9("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.default$9("sources."+n,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){this.canvas||(this.canvas=this.options.canvas instanceof t.default.HTMLCanvasElement?this.options.canvas:t.default.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map._rerender()},this.pause=function(){this._playing=!1},this._finishLoading())},n.prototype.getCanvas=function(){return this.canvas},n.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},n.prototype.onRemove=function(){this.pause()},n.prototype.prepare=function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var e=this.map.painter.context,n=e.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,J.members)),this.boundsVAO||(this.boundsVAO=new Q),this.texture?t?this.texture.update(this.canvas):this._playing&&(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.canvas)):(this.texture=new z(e,this.canvas,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var r=this.tiles[i];"loaded"!==r.state&&(r.state="loaded",r.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this._playing},n.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var n=e[t];if(isNaN(n)||n<=0)return!0}return!1},n})(tt),it={vector:Y,raster:H,"raster-dem":X,geojson:K,video:et,image:tt,canvas:nt},rt=function(e,n,i,r){var o=new it[n.type](e,n,i,r);if(o.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+o.id);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o};function ot(t,e,n,i,r){var o=r.maxPitchScaleFactor(),a=t.tilesIn(n,o);a.sort(at);for(var s=[],l=0,u=a;l<u.length;l+=1){var c=u[l];s.push({wrappedTileID:c.tileID.wrapped().key,queryResults:c.tile.queryRenderedFeatures(e,c.queryGeometry,c.scale,i,r,o,t.transform.calculatePosMatrix(c.tileID.toUnwrapped()))})}return (function(t){for(var e={},n={},i=0,r=t;i<r.length;i+=1){var o=r[i],a=o.queryResults,s=o.wrappedTileID,l=n[s]=n[s]||{};for(var u in a)for(var c=a[u],h=l[u]=l[u]||{},p=e[u]=e[u]||[],f=0,d=c;f<d.length;f+=1){var m=d[f];h[m.featureIndex]||(h[m.featureIndex]=!0,p.push(m.feature))}}return e})(s)}function at(t,e){var n=t.tileID,i=e.tileID;return n.overscaledZ-i.overscaledZ||n.canonical.y-i.canonical.y||n.wrap-i.wrap||n.canonical.x-i.canonical.x}var st=function(e,n){this.tileID=e,this.uid=t.uniqueId(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.expiredRequestCount=0,this.state="loading"};st.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<o.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},st.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},st.prototype.loadVectorData=function(e,n,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){if(e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=(function(t,e){var n={};if(!e)return n;for(var i=0,r=t;i<r.length;i+=1){var o=r[i],a=o.layerIds.map((function(t){return e.getLayer(t)})).filter(Boolean);if(0!==a.length){o.layers=a;for(var s=0,l=a;s<l.length;s+=1)n[l[s].id]=o}}return n})(e.buckets,n.style),i)for(var r in this.buckets){var o=this.buckets[r];o instanceof t.default$14&&(o.justReloaded=!0)}for(var a in this.queryPadding=0,this.buckets){var s=this.buckets[a];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(s.layerIds[0]).queryRadius(s))}e.iconAtlasImage&&(this.iconAtlasImage=e.iconAtlasImage),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new t.CollisionBoxArray},st.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.iconAtlasTexture&&this.iconAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},st.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},st.prototype.getBucket=function(t){return this.buckets[t.id]},st.prototype.upload=function(t){for(var e in this.buckets){var n=this.buckets[e];n.uploaded||(n.upload(t),n.uploaded=!0)}var i=t.gl;this.iconAtlasImage&&(this.iconAtlasTexture=new z(t,this.iconAtlasImage,i.RGBA),this.iconAtlasImage=null),this.glyphAtlasImage&&(this.glyphAtlasTexture=new z(t,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)},st.prototype.queryRenderedFeatures=function(t,e,n,i,r,o,a){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:e,scale:n,tileSize:this.tileSize,posMatrix:a,transform:r,params:i,queryPadding:this.queryPadding*o},t):{}},st.prototype.querySourceFeatures=function(e,n){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var i=this.latestFeatureIndex.loadVTLayers(),r=n?n.sourceLayer:"",o=i._geojsonTileLayer||i[r];if(o)for(var a=t.default$13(n&&n.filter),s={z:this.tileID.overscaledZ,x:this.tileID.canonical.x,y:this.tileID.canonical.y},l=0;l<o.length;l++){var u=o.feature(l);if(a(new t.default$16(this.tileID.overscaledZ),u)){var c=new t.default$12(u,s.z,s.x,s.y);c.tile=s,e.push(c)}}}},st.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},st.prototype.setMask=function(e,n){if(!t.default$10(this.mask,e)&&(this.mask=e,this.clearMask(),!t.default$10(e,{0:!0}))){var i=new t.RasterBoundsArray,r=new t.TriangleIndexArray;this.segments=new t.default$15,this.segments.prepareSegment(0,i,r);for(var o=Object.keys(e),a=0;a<o.length;a++){var s=e[o[a]],l=t.default$8>>s.z,u=new t.default$1(s.x*l,s.y*l),c=new t.default$1(u.x+l,u.y+l),h=this.segments.prepareSegment(4,i,r);i.emplaceBack(u.x,u.y,u.x,u.y),i.emplaceBack(c.x,u.y,c.x,u.y),i.emplaceBack(u.x,c.y,u.x,c.y),i.emplaceBack(c.x,c.y,c.x,c.y);var p=h.vertexLength;r.emplaceBack(p,p+1,p+2),r.emplaceBack(p+1,p+2,p+3),h.vertexLength+=4,h.primitiveLength+=2}this.maskedBoundsBuffer=n.createVertexBuffer(i,J.members),this.maskedIndexBuffer=n.createIndexBuffer(r)}},st.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},st.prototype.setExpiryData=function(e){var n=this.expirationTime;if(e.cacheControl){var i=t.parseCacheControl(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var r=Date.now(),o=!1;if(this.expirationTime>r)o=!1;else if(n)if(this.expirationTime<n)o=!0;else{var a=this.expirationTime-n;a?this.expirationTime=r+Math.max(a,3e4):o=!0}else o=!0;o?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},st.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)};var lt=function(t,e){this.max=t,this.onRemove=e,this.reset()};lt.prototype.reset=function(){for(var t in this.data)for(var e=0,n=this.data[t];e<n.length;e+=1){var i=n[e];i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value)}return this.data={},this.order=[],this},lt.prototype.add=function(t,e,n){var i=this,r=t.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);var o={value:e,timeout:void 0};if(void 0!==n&&(o.timeout=setTimeout((function(){i.remove(t,o)}),n)),this.data[r].push(o),this.order.push(r),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},lt.prototype.has=function(t){return t.wrapped().key in this.data},lt.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},lt.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},lt.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},lt.prototype.remove=function(t,e){if(!this.has(t))return this;var n=t.wrapped().key,i=void 0===e?0:this.data[n].indexOf(e),r=this.data[n][i];return this.data[n].splice(i,1),r.timeout&&clearTimeout(r.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(r.value),this.order.splice(this.order.indexOf(n),1),this},lt.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this};var ut=function(t,e,n){this.context=t;var i=t.gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(n),this.unbindVAO(),t.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};ut.prototype.unbindVAO=function(){this.context.extVertexArrayObject&&this.context.bindVertexArrayOES.set(null)},ut.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},ut.prototype.updateData=function(t){var e=this.context.gl;this.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},ut.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var ct={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ht=function(t,e,n,i){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=i,this.context=t;var r=t.gl;this.buffer=r.createBuffer(),t.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};ht.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ht.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},ht.prototype.enableAttributes=function(t,e){for(var n=0;n<this.attributes.length;n++){var i=this.attributes[n],r=e.attributes[i.name];void 0!==r&&t.enableVertexAttribArray(r)}},ht.prototype.setVertexAttribPointers=function(t,e,n){for(var i=0;i<this.attributes.length;i++){var r=this.attributes[i],o=e.attributes[r.name];void 0!==o&&t.vertexAttribPointer(o,r.components,t[ct[r.type]],!1,this.itemSize,r.offset+this.itemSize*(n||0))}},ht.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var pt=function(e){this.context=e,this.current=t.default$6.transparent};pt.prototype.get=function(){return this.current},pt.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a||(this.context.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t)};var ft=function(t){this.context=t,this.current=1};ft.prototype.get=function(){return this.current},ft.prototype.set=function(t){this.current!==t&&(this.context.gl.clearDepth(t),this.current=t)};var dt=function(t){this.context=t,this.current=0};dt.prototype.get=function(){return this.current},dt.prototype.set=function(t){this.current!==t&&(this.context.gl.clearStencil(t),this.current=t)};var mt=function(t){this.context=t,this.current=[!0,!0,!0,!0]};mt.prototype.get=function(){return this.current},mt.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]||(this.context.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t)};var vt=function(t){this.context=t,this.current=!0};vt.prototype.get=function(){return this.current},vt.prototype.set=function(t){this.current!==t&&(this.context.gl.depthMask(t),this.current=t)};var gt=function(t){this.context=t,this.current=255};gt.prototype.get=function(){return this.current},gt.prototype.set=function(t){this.current!==t&&(this.context.gl.stencilMask(t),this.current=t)};var yt=function(t){this.context=t,this.current={func:t.gl.ALWAYS,ref:0,mask:255}};yt.prototype.get=function(){return this.current},yt.prototype.set=function(t){var e=this.current;t.func===e.func&&t.ref===e.ref&&t.mask===e.mask||(this.context.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t)};var _t=function(t){this.context=t;var e=this.context.gl;this.current=[e.KEEP,e.KEEP,e.KEEP]};_t.prototype.get=function(){return this.current},_t.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]||(this.context.gl.stencilOp(t[0],t[1],t[2]),this.current=t)};var xt=function(t){this.context=t,this.current=!1};xt.prototype.get=function(){return this.current},xt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t}};var bt=function(t){this.context=t,this.current=[0,1]};bt.prototype.get=function(){return this.current},bt.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]||(this.context.gl.depthRange(t[0],t[1]),this.current=t)};var wt=function(t){this.context=t,this.current=!1};wt.prototype.get=function(){return this.current},wt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t}};var Et=function(t){this.context=t,this.current=t.gl.LESS};Et.prototype.get=function(){return this.current},Et.prototype.set=function(t){this.current!==t&&(this.context.gl.depthFunc(t),this.current=t)};var St=function(t){this.context=t,this.current=!1};St.prototype.get=function(){return this.current},St.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t}};var Ct=function(t){this.context=t;var e=this.context.gl;this.current=[e.ONE,e.ZERO]};Ct.prototype.get=function(){return this.current},Ct.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]||(this.context.gl.blendFunc(t[0],t[1]),this.current=t)};var Tt=function(e){this.context=e,this.current=t.default$6.transparent};Tt.prototype.get=function(){return this.current},Tt.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a||(this.context.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t)};var At=function(t){this.context=t,this.current=null};At.prototype.get=function(){return this.current},At.prototype.set=function(t){this.current!==t&&(this.context.gl.useProgram(t),this.current=t)};var Mt=function(t){this.context=t,this.current=1};Mt.prototype.get=function(){return this.current},Mt.prototype.set=function(e){var n=this.context.lineWidthRange,i=t.clamp(e,n[0],n[1]);this.current!==i&&(this.context.gl.lineWidth(i),this.current=e)};var It=function(t){this.context=t,this.current=t.gl.TEXTURE0};It.prototype.get=function(){return this.current},It.prototype.set=function(t){this.current!==t&&(this.context.gl.activeTexture(t),this.current=t)};var kt=function(t){this.context=t;var e=this.context.gl;this.current=[0,0,e.drawingBufferWidth,e.drawingBufferHeight]};kt.prototype.get=function(){return this.current},kt.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]||(this.context.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t)};var zt=function(t){this.context=t,this.current=null};zt.prototype.get=function(){return this.current},zt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t}};var Dt=function(t){this.context=t,this.current=null};Dt.prototype.get=function(){return this.current},Dt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t}};var Lt=function(t){this.context=t,this.current=null};Lt.prototype.get=function(){return this.current},Lt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t}};var Pt=function(t){this.context=t,this.current=null};Pt.prototype.get=function(){return this.current},Pt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t}};var Ot=function(t){this.context=t,this.current=null};Ot.prototype.get=function(){return this.current},Ot.prototype.set=function(t){var e=this.context.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t};var Rt=function(t){this.context=t,this.current=null};Rt.prototype.get=function(){return this.current},Rt.prototype.set=function(t){this.current!==t&&this.context.extVertexArrayObject&&(this.context.extVertexArrayObject.bindVertexArrayOES(t),this.current=t)};var Bt=function(t){this.context=t,this.current=4};Bt.prototype.get=function(){return this.current},Bt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t}};var Ft=function(t){this.context=t,this.current=!1};Ft.prototype.get=function(){return this.current},Ft.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t}};var Nt=function(t,e){this.context=t,this.current=null,this.parent=e};Nt.prototype.get=function(){return this.current};var Vt=(function(t){function e(e,n){t.call(this,e,n),this.dirty=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(this.dirty||this.current!==t){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e.prototype.setDirty=function(){this.dirty=!0},e})(Nt),jt=(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t}},e})(Nt),Ut=function(t,e,n){this.context=t,this.width=e,this.height=n;var i=t.gl,r=this.framebuffer=i.createFramebuffer();this.colorAttachment=new Vt(t,r),this.depthAttachment=new jt(t,r)};Ut.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();e&&t.deleteTexture(e);var n=this.depthAttachment.get();n&&t.deleteRenderbuffer(n),t.deleteFramebuffer(this.framebuffer)};var qt=function(t,e,n){this.func=t,this.mask=e,this.range=n};qt.ReadOnly=!1,qt.ReadWrite=!0,qt.disabled=new qt(519,qt.ReadOnly,[0,1]);var $t=function(t,e,n,i,r,o){this.test=t,this.ref=e,this.mask=n,this.fail=i,this.depthFail=r,this.pass=o};$t.disabled=new $t({func:519,mask:0},0,0,7680,7680,7680);var Zt=function(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n};Zt.disabled=new Zt(Zt.Replace=[1,0],t.default$6.transparent,[!1,!1,!1,!1]),Zt.unblended=new Zt(Zt.Replace,t.default$6.transparent,[!0,!0,!0,!0]),Zt.alphaBlended=new Zt([1,771],t.default$6.transparent,[!0,!0,!0,!0]);var Gt=function(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.lineWidthRange=t.getParameter(t.ALIASED_LINE_WIDTH_RANGE),this.clearColor=new pt(this),this.clearDepth=new ft(this),this.clearStencil=new dt(this),this.colorMask=new mt(this),this.depthMask=new vt(this),this.stencilMask=new gt(this),this.stencilFunc=new yt(this),this.stencilOp=new _t(this),this.stencilTest=new xt(this),this.depthRange=new bt(this),this.depthTest=new wt(this),this.depthFunc=new Et(this),this.blend=new St(this),this.blendFunc=new Ct(this),this.blendColor=new Tt(this),this.program=new At(this),this.lineWidth=new Mt(this),this.activeTexture=new It(this),this.viewport=new kt(this),this.bindFramebuffer=new zt(this),this.bindRenderbuffer=new Dt(this),this.bindTexture=new Lt(this),this.bindVertexBuffer=new Pt(this),this.bindElementBuffer=new Ot(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Rt(this),this.pixelStoreUnpack=new Bt(this),this.pixelStoreUnpackPremultiplyAlpha=new Ft(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&t.getExtension("OES_texture_half_float_linear")};Gt.prototype.createIndexBuffer=function(t,e){return new ut(this,t,e)},Gt.prototype.createVertexBuffer=function(t,e,n){return new ht(this,t,e,n)},Gt.prototype.createRenderbuffer=function(t,e,n){var i=this.gl,r=i.createRenderbuffer();return this.bindRenderbuffer.set(r),i.renderbufferStorage(i.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),r},Gt.prototype.createFramebuffer=function(t,e){return new Ut(this,t,e)},Gt.prototype.clear=function(t){var e=t.color,n=t.depth,i=this.gl,r=0;e&&(r|=i.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(r|=i.DEPTH_BUFFER_BIT,this.clearDepth.set(n),this.depthMask.set(!0)),i.clear(r)},Gt.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},Gt.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},Gt.prototype.setColorMode=function(e){t.default$10(e.blendFunction,Zt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)};var Wt=(function(e){function n(t,n,i){var r=this;e.call(this),this.id=t,this.dispatcher=i,this.on("data",(function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(r._sourceLoaded=!0),r._sourceLoaded&&!r._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(r.reload(),r.transform&&r.update(r.transform))})),this.on("error",(function(){r._sourceErrored=!0})),this._source=rt(t,n,i,this),this._tiles={},this._cache=new lt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._isIdRenderable=this._isIdRenderable.bind(this),this._coveredTiles={}}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},n.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},n.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},n.prototype.getSource=function(){return this._source},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},n.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},n.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,(function(){}))},n.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,(function(){}))},n.prototype.serialize=function(){return this._source.serialize()},n.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._tiles)this._tiles[e].upload(t)},n.prototype.getIds=function(){var e=this;return Object.keys(this._tiles).map(Number).sort((function(n,i){var r=e._tiles[n].tileID,o=e._tiles[i].tileID,a=new t.default$1(r.canonical.x,r.canonical.y).rotate(e.transform.angle),s=new t.default$1(o.canonical.x,o.canonical.y).rotate(e.transform.angle);return r.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x}))},n.prototype.getRenderableIds=function(){return this.getIds().filter(this._isIdRenderable)},n.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0,{});return!!e&&this._isIdRenderable(e.tileID.key)},n.prototype._isIdRenderable=function(t){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]},n.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)this._reloadTile(t,"reloading")},n.prototype._reloadTile=function(t,e){var n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))},n.prototype._tileLoaded=function(e,n,i,r){if(r)return e.state="errored",void(404!==r.status?this._source.fire(new t.ErrorEvent(r,{tile:e})):this.update(this.transform));e.timeAdded=o.now(),"expired"===i&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID})),this.map&&(this.map.painter.tileExtentVAO.vao=null)},n.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),n=0;n<e.length;n++){var i=e[n];if(t.neighboringTiles&&t.neighboringTiles[i]){var r=this.getTileByID(i);o(t,r),o(r,t)}}function o(t,e){t.needsHillshadePrepare=!0;var n=e.tileID.canonical.x-t.tileID.canonical.x,i=e.tileID.canonical.y-t.tileID.canonical.y,r=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===n&&0===i||Math.abs(i)>1||(Math.abs(n)>1&&(1===Math.abs(n+r)?n+=r:1===Math.abs(n-r)&&(n-=r)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,i),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}},n.prototype.getTile=function(t){return this.getTileByID(t.key)},n.prototype.getTileByID=function(t){return this._tiles[t]},n.prototype.getZoom=function(t){return t.zoom+t.scaleZoom(t.tileSize/this._source.tileSize)},n.prototype._findLoadedChildren=function(t,e,n){var i=!1;for(var r in this._tiles){var o=this._tiles[r];if(!(n[r]||!o.hasData()||o.tileID.overscaledZ<=t.overscaledZ||o.tileID.overscaledZ>e)){var a=Math.pow(2,o.tileID.canonical.z-t.canonical.z);if(Math.floor(o.tileID.canonical.x/a)===t.canonical.x&&Math.floor(o.tileID.canonical.y/a)===t.canonical.y)for(n[r]=o.tileID,i=!0;o&&o.tileID.overscaledZ-1>t.overscaledZ;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);if(!s)break;(o=this._tiles[s.key])&&o.hasData()&&(delete n[r],n[s.key]=s)}}}return i},n.prototype.findLoadedParent=function(t,e,n){for(var i=t.overscaledZ-1;i>=e;i--){var r=t.scaledTo(i);if(!r)return;var o=String(r.key),a=this._tiles[o];if(a&&a.hasData())return n[o]=r,a;if(this._cache.has(r))return n[o]=r,this._cache.get(r)}},n.prototype.updateCacheSize=function(t){var e=(Math.ceil(t.width/this._source.tileSize)+1)*(Math.ceil(t.height/this._source.tileSize)+1),n=Math.floor(5*e),i="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,n):n;this._cache.setMaxSize(i)},n.prototype.handleWrapJump=function(t){var e=(t-(void 0===this._prevLng?t:this._prevLng))/360,n=Math.round(e);if(this._prevLng=t,n){var i={};for(var r in this._tiles){var o=this._tiles[r];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+n),i[o.tileID.key]=o}for(var a in this._tiles=i,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var s in this._tiles){var l=this._tiles[s];this._setTileReloadTimer(s,l)}}},n.prototype.update=function(e){var i=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var r;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?r=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)})):(r=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(r=r.filter((function(t){return i._source.hasTile(t)})))):r=[];var a,s=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(e)),l=Math.max(s-n.maxOverzooming,this._source.minzoom),u=Math.max(s+n.maxUnderzooming,this._source.minzoom),c=this._updateRetainedTiles(r,s),h={};if(Ht(this._source.type))for(var p=Object.keys(c),f=0;f<p.length;f++){var d=p[f],m=c[d],v=i._tiles[d];if(v&&(void 0===v.fadeEndTime||v.fadeEndTime>=o.now())){i._findLoadedChildren(m,u,c)&&(c[d]=m);var g=i.findLoadedParent(m,l,h);g&&i._addTile(g.tileID)}}for(a in h)c[a]||(i._coveredTiles[a]=!0);for(a in h)c[a]=h[a];for(var y=t.keysDifference(this._tiles,c),_=0;_<y.length;_++)i._removeTile(y[_])}},n.prototype._updateRetainedTiles=function(t,e){for(var i={},r={},o=Math.max(e-n.maxOverzooming,this._source.minzoom),a=Math.max(e+n.maxUnderzooming,this._source.minzoom),s=0;s<t.length;s++){var l=t[s],u=this._addTile(l),c=!1;if(u.hasData())i[l.key]=l;else{c=u.wasRequested(),i[l.key]=l;var h=!0;if(e+1>this._source.maxzoom){var p=l.children(this._source.maxzoom)[0],f=this.getTile(p);f&&f.hasData()?i[p.key]=p:h=!1}else{this._findLoadedChildren(l,a,i);for(var d=l.children(this._source.maxzoom),m=0;m<d.length;m++)if(!i[d[m].key]){h=!1;break}}if(!h)for(var v=l.overscaledZ-1;v>=o;--v){var g=l.scaledTo(v);if(r[g.key])break;if(r[g.key]=!0,!(u=this.getTile(g))&&c&&(u=this._addTile(g)),u&&(i[g.key]=g,c=u.wasRequested(),u.hasData()))break}}}return i},n.prototype._addTile=function(e){var n=this._tiles[e.key];if(n)return n;(n=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,n),n.tileID=e);var i=Boolean(n);return i||(n=new st(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))),n?(n.uses++,this._tiles[e.key]=n,i||this._source.fire(new t.Event("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null},n.prototype._setTileReloadTimer=function(t,e){var n=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var i=e.getExpiryTimeout();i&&(this._timers[t]=setTimeout((function(){n._reloadTile(t,"expired"),delete n._timers[t]}),i))},n.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},n.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},n.prototype.tilesIn=function(e,n){for(var i=[],r=this.getIds(),o=1/0,a=1/0,s=-1/0,l=-1/0,u=e[0].zoom,c=0;c<e.length;c++){var h=e[c];o=Math.min(o,h.column),a=Math.min(a,h.row),s=Math.max(s,h.column),l=Math.max(l,h.row)}for(var p=0;p<r.length;p++){var f=this._tiles[r[p]],d=f.tileID,m=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),v=n*f.queryPadding*t.default$8/f.tileSize/m,g=[Yt(d,new t.default$17(o,a,u)),Yt(d,new t.default$17(s,l,u))];if(g[0].x-v<t.default$8&&g[0].y-v<t.default$8&&g[1].x+v>=0&&g[1].y+v>=0){for(var y=[],_=0;_<e.length;_++)y.push(Yt(d,e[_]));i.push({tile:f,tileID:d,queryGeometry:[y],scale:m})}}return i},n.prototype.getVisibleCoordinates=function(){for(var t=this,e=this.getRenderableIds().map((function(e){return t._tiles[e].tileID})),n=0,i=e;n<i.length;n+=1){var r=i[n];r.posMatrix=t.transform.calculatePosMatrix(r.toUnwrapped())}return e},n.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ht(this._source.type))for(var t in this._tiles){var e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=o.now())return!0}return!1},n})(t.Evented);function Yt(e,n){var i=n.zoomTo(e.canonical.z);return new t.default$1((i.column-(e.canonical.x+e.wrap*Math.pow(2,e.canonical.z)))*t.default$8,(i.row-e.canonical.y)*t.default$8)}function Ht(t){return"raster"===t||"image"===t||"video"===t}function Xt(){return new t.default.Worker(Mi.workerUrl)}Wt.maxOverzooming=10,Wt.maxUnderzooming=3;var Kt,Jt=function(){this.active={}};function Qt(e,n){var i={};for(var r in e)"ref"!==r&&(i[r]=e[r]);return t.default$18.forEach((function(t){t in n&&(i[t]=n[t])})),i}function te(t){t=t.slice();for(var e=Object.create(null),n=0;n<t.length;n++)e[t[n].id]=t[n];for(var i=0;i<t.length;i++)"ref"in t[i]&&(t[i]=Qt(t[i],e[t[i].ref]));return t}Jt.prototype.acquire=function(t){if(!this.workers){var e=Mi.workerCount;for(this.workers=[];this.workers.length<e;)this.workers.push(new Xt)}return this.active[t]=!0,this.workers.slice()},Jt.prototype.release=function(t){delete this.active[t],0===Object.keys(this.active).length&&(this.workers.forEach((function(t){t.terminate()})),this.workers=null)};var ee={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ne(t,e,n){n.push({command:ee.addSource,args:[t,e[t]]})}function ie(t,e,n){e.push({command:ee.removeSource,args:[t]}),n[t]=!0}function re(t,e,n,i){ie(t,n,i),ne(t,e,n)}function oe(e,n,i){var r;for(r in e[i])if(e[i].hasOwnProperty(r)&&"data"!==r&&!t.default$10(e[i][r],n[i][r]))return!1;for(r in n[i])if(n[i].hasOwnProperty(r)&&"data"!==r&&!t.default$10(e[i][r],n[i][r]))return!1;return!0}function ae(e,n,i,r,o,a){var s;for(s in n=n||{},e=e||{})e.hasOwnProperty(s)&&(t.default$10(e[s],n[s])||i.push({command:a,args:[r,s,n[s],o]}));for(s in n)n.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t.default$10(e[s],n[s])||i.push({command:a,args:[r,s,n[s],o]}))}function se(t){return t.id}function le(t,e){return t[e.id]=e,t}var ue=function(t,e,n){var i=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(var o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0};ue.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},ue.prototype.insert=function(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)},ue.prototype.insertCircle=function(t,e,n,i){this._forEachCell(e-i,n-i,e+i,n+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(i)},ue.prototype._insertBoxCell=function(t,e,n,i,r,o){this.boxCells[r].push(o)},ue.prototype._insertCircleCell=function(t,e,n,i,r,o){this.circleCells[r].push(o)},ue.prototype._query=function(t,e,n,i,r){if(n<0||t>this.width||i<0||e>this.height)return!r&&[];var o=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=i){if(r)return!0;for(var a=0;a<this.boxKeys.length;a++)o.push({key:this.boxKeys[a],x1:this.bboxes[4*a],y1:this.bboxes[4*a+1],x2:this.bboxes[4*a+2],y2:this.bboxes[4*a+3]});for(var s=0;s<this.circleKeys.length;s++){var l=this.circles[3*s],u=this.circles[3*s+1],c=this.circles[3*s+2];o.push({key:this.circleKeys[s],x1:l-c,y1:u-c,x2:l+c,y2:u+c})}}else{var h={hitTest:r,seenUids:{box:{},circle:{}}};this._forEachCell(t,e,n,i,this._queryCell,o,h)}return r?o.length>0:o},ue.prototype._queryCircle=function(t,e,n,i){var r=t-n,o=t+n,a=e-n,s=e+n;if(o<0||r>this.width||s<0||a>this.height)return!i&&[];var l=[],u={hitTest:i,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}};return this._forEachCell(r,a,o,s,this._queryCellCircle,l,u),i?l.length>0:l},ue.prototype.query=function(t,e,n,i){return this._query(t,e,n,i,!1)},ue.prototype.hitTest=function(t,e,n,i){return this._query(t,e,n,i,!0)},ue.prototype.hitTestCircle=function(t,e,n){return this._queryCircle(t,e,n,!0)},ue.prototype._queryCell=function(t,e,n,i,r,o,a){var s=a.seenUids,l=this.boxCells[r];if(null!==l)for(var u=this.bboxes,c=0,h=l;c<h.length;c+=1){var p=h[c];if(!s.box[p]){s.box[p]=!0;var f=4*p;if(t<=u[f+2]&&e<=u[f+3]&&n>=u[f+0]&&i>=u[f+1]){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[p],x1:u[f],y1:u[f+1],x2:u[f+2],y2:u[f+3]})}}}var d=this.circleCells[r];if(null!==d)for(var m=this.circles,v=0,g=d;v<g.length;v+=1){var y=g[v];if(!s.circle[y]){s.circle[y]=!0;var _=3*y;if(this._circleAndRectCollide(m[_],m[_+1],m[_+2],t,e,n,i)){if(a.hitTest)return o.push(!0),!0;var x=m[_],b=m[_+1],w=m[_+2];o.push({key:this.circleKeys[y],x1:x-w,y1:b-w,x2:x+w,y2:b+w})}}}},ue.prototype._queryCellCircle=function(t,e,n,i,r,o,a){var s=a.circle,l=a.seenUids,u=this.boxCells[r];if(null!==u)for(var c=this.bboxes,h=0,p=u;h<p.length;h+=1){var f=p[h];if(!l.box[f]){l.box[f]=!0;var d=4*f;if(this._circleAndRectCollide(s.x,s.y,s.radius,c[d+0],c[d+1],c[d+2],c[d+3]))return o.push(!0),!0}}var m=this.circleCells[r];if(null!==m)for(var v=this.circles,g=0,y=m;g<y.length;g+=1){var _=y[g];if(!l.circle[_]){l.circle[_]=!0;var x=3*_;if(this._circlesCollide(v[x],v[x+1],v[x+2],s.x,s.y,s.radius))return o.push(!0),!0}}},ue.prototype._forEachCell=function(t,e,n,i,r,o,a){for(var s=this._convertToXCellCoord(t),l=this._convertToYCellCoord(e),u=this._convertToXCellCoord(n),c=this._convertToYCellCoord(i),h=s;h<=u;h++)for(var p=l;p<=c;p++){var f=this.xCellCount*p+h;if(r.call(this,t,e,n,i,f,o,a))return}},ue.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},ue.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},ue.prototype._circlesCollide=function(t,e,n,i,r,o){var a=i-t,s=r-e,l=n+o;return l*l>a*a+s*s},ue.prototype._circleAndRectCollide=function(t,e,n,i,r,o,a){var s=(o-i)/2,l=Math.abs(t-(i+s));if(l>s+n)return!1;var u=(a-r)/2,c=Math.abs(e-(r+u));if(c>u+n)return!1;if(l<=s||c<=u)return!0;var h=l-s,p=c-u;return h*h+p*p<=n*n};var ce=t.default$19.layout;function he(e,n,i,r,o){var a=t.mat4.identity(new Float32Array(16));return n?(t.mat4.identity(a),t.mat4.scale(a,a,[1/o,1/o,1]),i||t.mat4.rotateZ(a,a,r.angle)):(t.mat4.scale(a,a,[r.width/2,-r.height/2,1]),t.mat4.translate(a,a,[1,-1,0]),t.mat4.multiply(a,a,e)),a}function pe(e,n,i,r,o){var a=t.mat4.identity(new Float32Array(16));return n?(t.mat4.multiply(a,a,e),t.mat4.scale(a,a,[o,o,1]),i||t.mat4.rotateZ(a,a,-r.angle)):(t.mat4.scale(a,a,[1,-1,1]),t.mat4.translate(a,a,[-1,-1,0]),t.mat4.scale(a,a,[2/r.width,2/r.height,1])),a}function fe(e,n){var i=[e.x,e.y,0,1];Ee(i,i,n);var r=i[3];return{point:new t.default$1(i[0]/r,i[1]/r),signedDistanceFromCamera:r}}function de(t,e){var n=t[0]/t[3],i=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&i>=-e[1]&&i<=e[1]}function me(e,n,i,r,o,a,s,l){var u=r?e.textSizeData:e.iconSizeData,c=t.evaluateSizeForZoom(u,i.transform.zoom,ce.properties[r?"text-size":"icon-size"]),h=[256/i.width*2+1,256/i.height*2+1],p=r?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;p.clear();for(var f=e.lineVertexArray,d=r?e.text.placedSymbolArray:e.icon.placedSymbolArray,m=i.transform.width/i.transform.height,v=!1,g=0;g<d.length;g++){var y=d.get(g);if(y.hidden||y.writingMode===t.WritingMode.vertical&&!v)we(y.numGlyphs,p);else{v=!1;var _=[y.anchorX,y.anchorY,0,1];if(t.vec4.transformMat4(_,_,n),de(_,h)){var x=.5+_[3]/i.transform.cameraToCenterDistance*.5,b=t.evaluateSizeForFeature(u,c,y),w=s?b*x:b/x,E=new t.default$1(y.anchorX,y.anchorY),S=fe(E,o).point,C={},T=ye(y,w,!1,l,n,o,a,e.glyphOffsetArray,f,p,S,E,C,m);v=T.useVertical,(T.notEnoughRoom||v||T.needsFlipping&&ye(y,w,!0,l,n,o,a,e.glyphOffsetArray,f,p,S,E,C,m).notEnoughRoom)&&we(y.numGlyphs,p)}else we(y.numGlyphs,p)}}r?e.text.dynamicLayoutVertexBuffer.updateData(p):e.icon.dynamicLayoutVertexBuffer.updateData(p)}function ve(t,e,n,i,r,o,a,s,l,u,c,h){var p=s.glyphStartIndex+s.numGlyphs,f=s.lineStartIndex,d=s.lineStartIndex+s.lineLength,m=e.getoffsetX(s.glyphStartIndex),v=e.getoffsetX(p-1),g=xe(t*m,n,i,r,o,a,s.segment,f,d,l,u,c,h);if(!g)return null;var y=xe(t*v,n,i,r,o,a,s.segment,f,d,l,u,c,h);return y?{first:g,last:y}:null}function ge(e,n,i,r){return e===t.WritingMode.horizontal&&Math.abs(i.y-n.y)>Math.abs(i.x-n.x)*r?{useVertical:!0}:(e===t.WritingMode.vertical?n.y<i.y:n.x>i.x)?{needsFlipping:!0}:null}function ye(e,n,i,r,o,a,s,l,u,c,h,p,f,d){var m,v=n/24,g=e.lineOffsetX*n,y=e.lineOffsetY*n;if(e.numGlyphs>1){var _=e.glyphStartIndex+e.numGlyphs,x=e.lineStartIndex,b=e.lineStartIndex+e.lineLength,w=ve(v,l,g,y,i,h,p,e,u,a,f,!1);if(!w)return{notEnoughRoom:!0};var E=fe(w.first.point,s).point,S=fe(w.last.point,s).point;if(r&&!i){var C=ge(e.writingMode,E,S,d);if(C)return C}m=[w.first];for(var T=e.glyphStartIndex+1;T<_-1;T++)m.push(xe(v*l.getoffsetX(T),g,y,i,h,p,e.segment,x,b,u,a,f,!1));m.push(w.last)}else{if(r&&!i){var A=fe(p,o).point,M=e.lineStartIndex+e.segment+1,I=new t.default$1(u.getx(M),u.gety(M)),k=fe(I,o),z=k.signedDistanceFromCamera>0?k.point:_e(p,I,A,1,o),D=ge(e.writingMode,A,z,d);if(D)return D}var L=xe(v*l.getoffsetX(e.glyphStartIndex),g,y,i,h,p,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,u,a,f,!1);if(!L)return{notEnoughRoom:!0};m=[L]}for(var P=0,O=m;P<O.length;P+=1){var R=O[P];t.addDynamicAttributes(c,R.point,R.angle)}return{}}function _e(t,e,n,i,r){var o=fe(t.add(t.sub(e)._unit()),r).point,a=n.sub(o);return n.add(a._mult(i/a.mag()))}function xe(e,n,i,r,o,a,s,l,u,c,h,p,f){var d=r?e-n:e+n,m=d>0?1:-1,v=0;r&&(m*=-1,v=Math.PI),m<0&&(v+=Math.PI);for(var g=m>0?l+s:l+s+1,y=g,_=o,x=o,b=0,w=0,E=Math.abs(d);b+w<=E;){if((g+=m)<l||g>=u)return null;if(x=_,void 0===(_=p[g])){var S=new t.default$1(c.getx(g),c.gety(g)),C=fe(S,h);if(C.signedDistanceFromCamera>0)_=p[g]=C.point;else{var T=g-m;_=_e(0===b?a:new t.default$1(c.getx(T),c.gety(T)),S,x,E-b+1,h)}}b+=w,w=x.dist(_)}var A=(E-b)/w,M=_.sub(x),I=M.mult(A)._add(x);return I._add(M._unit()._perp()._mult(i*m)),{point:I,angle:v+Math.atan2(_.y-x.y,_.x-x.x),tileDistance:f?{prevTileDistance:g-m===y?0:c.gettileUnitDistanceFromAnchor(g-m),lastSegmentViewportDistance:E-b}:null}}var be=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function we(t,e){for(var n=0;n<t;n++){var i=e.length;e.resize(i+4),e.float32.set(be,3*i)}}function Ee(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t[3]=n[3]*i+n[7]*r+n[15],t}t.default$20.mat4;var Se=function(t,e,n){void 0===e&&(e=new ue(t.width+200,t.height+200,25)),void 0===n&&(n=new ue(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=n,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100};function Ce(t,e,n){t[e+4]=n?1:0}function Te(e,n,i){return n*(t.default$8/(e.tileSize*Math.pow(2,i-e.tileID.overscaledZ)))}Se.prototype.placeCollisionBox=function(t,e,n,i){var r=this.projectAndGetPerspectiveRatio(i,t.anchorPointX,t.anchorPointY),o=n*r.perspectiveRatio,a=t.x1*o+r.point.x,s=t.y1*o+r.point.y,l=t.x2*o+r.point.x,u=t.y2*o+r.point.y;return!e&&this.grid.hitTest(a,s,l,u)?{box:[],offscreen:!1}:{box:[a,s,l,u],offscreen:this.isOffscreen(a,s,l,u)}},Se.prototype.approximateTileDistance=function(t,e,n,i,r){var o=r?1:i/this.pitchfactor,a=t.lastSegmentViewportDistance*n;return t.prevTileDistance+a+(o-1)*a*Math.abs(Math.sin(e))},Se.prototype.placeCollisionCircles=function(e,n,i,r,o,a,s,l,u,c,h,p,f){var d=[],m=this.projectAnchor(c,a.anchorX,a.anchorY),v=u/24,g=a.lineOffsetX*u,y=a.lineOffsetY*u,_=new t.default$1(a.anchorX,a.anchorY),x=ve(v,l,g,y,!1,fe(_,h).point,_,a,s,h,{},!0),b=!1,w=!0,E=m.perspectiveRatio*r,S=1/(r*i),C=0,T=0;x&&(C=this.approximateTileDistance(x.first.tileDistance,x.first.angle,S,m.cameraDistance,f),T=this.approximateTileDistance(x.last.tileDistance,x.last.angle,S,m.cameraDistance,f));for(var A=0;A<e.length;A+=5){var M=e[A],I=e[A+1],k=e[A+2],z=e[A+3];if(!x||z<-C||z>T)Ce(e,A,!1);else{var D=this.projectPoint(c,M,I),L=k*E;if(d.length>0){var P=D.x-d[d.length-4],O=D.y-d[d.length-3];if(L*L*2>P*P+O*O&&A+8<e.length){var R=e[A+8];if(R>-C&&R<T){Ce(e,A,!1);continue}}}var B=A/5;if(d.push(D.x,D.y,L,B),Ce(e,A,!0),w=w&&this.isOffscreen(D.x-L,D.y-L,D.x+L,D.y+L),!n&&this.grid.hitTestCircle(D.x,D.y,L)){if(!p)return{circles:[],offscreen:!1};b=!0}}}return{circles:b?[]:d,offscreen:w}},Se.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var n=[],i=1/0,r=1/0,o=-1/0,a=-1/0,s=0,l=e;s<l.length;s+=1){var u=l[s],c=new t.default$1(u.x+100,u.y+100);i=Math.min(i,c.x),r=Math.min(r,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y),n.push(c)}for(var h={},p={},f=0,d=this.grid.query(i,r,o,a).concat(this.ignoredGrid.query(i,r,o,a));f<d.length;f+=1){var m=d[f],v=m.key;if(void 0===h[v.bucketInstanceId]&&(h[v.bucketInstanceId]={}),!h[v.bucketInstanceId][v.featureIndex]){var g=[new t.default$1(m.x1,m.y1),new t.default$1(m.x2,m.y1),new t.default$1(m.x2,m.y2),new t.default$1(m.x1,m.y2)];t.polygonIntersectsPolygon(n,g)&&(h[v.bucketInstanceId][v.featureIndex]=!0,void 0===p[v.bucketInstanceId]&&(p[v.bucketInstanceId]=[]),p[v.bucketInstanceId].push(v.featureIndex))}}return p},Se.prototype.insertCollisionBox=function(t,e,n,i){var r={bucketInstanceId:n,featureIndex:i};(e?this.ignoredGrid:this.grid).insert(r,t[0],t[1],t[2],t[3])},Se.prototype.insertCollisionCircles=function(t,e,n,i){for(var r=e?this.ignoredGrid:this.grid,o={bucketInstanceId:n,featureIndex:i},a=0;a<t.length;a+=4)r.insertCircle(o,t[a],t[a+1],t[a+2])},Se.prototype.projectAnchor=function(t,e,n){var i=[e,n,0,1];return Ee(i,i,t),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/i[3]*.5,cameraDistance:i[3]}},Se.prototype.projectPoint=function(e,n,i){var r=[n,i,0,1];return Ee(r,r,e),new t.default$1((r[0]/r[3]+1)/2*this.transform.width+100,(-r[1]/r[3]+1)/2*this.transform.height+100)},Se.prototype.projectAndGetPerspectiveRatio=function(e,n,i){var r=[n,i,0,1];return Ee(r,r,e),{point:new t.default$1((r[0]/r[3]+1)/2*this.transform.width+100,(-r[1]/r[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/r[3]*.5}},Se.prototype.isOffscreen=function(t,e,n,i){return n<100||t>=this.screenRightBoundary||i<100||e>this.screenBottomBoundary};var Ae=t.default$19.layout,Me=function(t,e,n,i){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):i&&n?1:0,this.placed=n};Me.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Ie=function(t,e,n,i,r){this.text=new Me(t?t.text:null,e,n,r),this.icon=new Me(t?t.icon:null,e,i,r)};Ie.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ke=function(t,e,n){this.text=t,this.icon=e,this.skipFade=n},ze=function(t,e){this.transform=t.clone(),this.collisionIndex=new Se(this.transform),this.placements={},this.opacities={},this.stale=!1,this.fadeDuration=e,this.retainedQueryData={}};function De(t,e,n){t.emplaceBack(e?1:0,n?1:0),t.emplaceBack(e?1:0,n?1:0),t.emplaceBack(e?1:0,n?1:0),t.emplaceBack(e?1:0,n?1:0)}ze.prototype.placeLayerTile=function(e,n,i,r){var o=n.getBucket(e),a=n.latestFeatureIndex;if(o&&a&&e.id===o.layerIds[0]){var s=n.collisionBoxArray,l=o.layers[0].layout,u=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),c=n.tileSize/t.default$8,h=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),p=he(h,"map"===l.get("text-pitch-alignment"),"map"===l.get("text-rotation-alignment"),this.transform,Te(n,1,this.transform.zoom)),f=he(h,"map"===l.get("icon-pitch-alignment"),"map"===l.get("icon-rotation-alignment"),this.transform,Te(n,1,this.transform.zoom));this.retainedQueryData[o.bucketInstanceId]=new function(t,e,n,i,r){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=i,this.tileID=r}(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,n.tileID),this.placeLayerBucket(o,h,p,f,u,c,i,r,s)}},ze.prototype.placeLayerBucket=function(e,n,i,r,o,a,s,l,u){for(var c=e.layers[0].layout,h=t.evaluateSizeForZoom(e.textSizeData,this.transform.zoom,Ae.properties["text-size"]),p=!e.hasTextData()||c.get("text-optional"),f=!e.hasIconData()||c.get("icon-optional"),d=0,m=e.symbolInstances;d<m.length;d+=1){var v=m[d];if(!l[v.crossTileID]){var g=void 0!==v.feature.text,y=void 0!==v.feature.icon,_=!0,x=null,b=null,w=null,E=0,S=0;v.collisionArrays||(v.collisionArrays=e.deserializeCollisionBoxes(u,v.textBoxStartIndex,v.textBoxEndIndex,v.iconBoxStartIndex,v.iconBoxEndIndex)),v.collisionArrays.textFeatureIndex&&(E=v.collisionArrays.textFeatureIndex),v.collisionArrays.textBox&&(g=(x=this.collisionIndex.placeCollisionBox(v.collisionArrays.textBox,c.get("text-allow-overlap"),a,n)).box.length>0,_=_&&x.offscreen);var C=v.collisionArrays.textCircles;if(C){var T=e.text.placedSymbolArray.get(v.placedTextSymbolIndices[0]),A=t.evaluateSizeForFeature(e.textSizeData,h,T);b=this.collisionIndex.placeCollisionCircles(C,c.get("text-allow-overlap"),o,a,v.key,T,e.lineVertexArray,e.glyphOffsetArray,A,n,i,s,"map"===c.get("text-pitch-alignment")),g=c.get("text-allow-overlap")||b.circles.length>0,_=_&&b.offscreen}v.collisionArrays.iconFeatureIndex&&(S=v.collisionArrays.iconFeatureIndex),v.collisionArrays.iconBox&&(y=(w=this.collisionIndex.placeCollisionBox(v.collisionArrays.iconBox,c.get("icon-allow-overlap"),a,n)).box.length>0,_=_&&w.offscreen),p||f?f?p||(y=y&&g):g=y&&g:y=g=y&&g,g&&x&&this.collisionIndex.insertCollisionBox(x.box,c.get("text-ignore-placement"),e.bucketInstanceId,E),y&&w&&this.collisionIndex.insertCollisionBox(w.box,c.get("icon-ignore-placement"),e.bucketInstanceId,S),g&&b&&this.collisionIndex.insertCollisionCircles(b.circles,c.get("text-ignore-placement"),e.bucketInstanceId,E),this.placements[v.crossTileID]=new ke(g,y,_||e.justReloaded),l[v.crossTileID]=!0}}e.justReloaded=!1},ze.prototype.commit=function(t,e){this.commitTime=e;var n=!1,i=t&&0!==this.fadeDuration?(this.commitTime-t.commitTime)/this.fadeDuration:1,r=t?t.opacities:{};for(var o in this.placements){var a=this.placements[o],s=r[o];s?(this.opacities[o]=new Ie(s,i,a.text,a.icon),n=n||a.text!==s.text.placed||a.icon!==s.icon.placed):(this.opacities[o]=new Ie(null,i,a.text,a.icon,a.skipFade),n=n||a.text||a.icon)}for(var l in r){var u=r[l];if(!this.opacities[l]){var c=new Ie(u,i,!1,!1);c.isHidden()||(this.opacities[l]=c,n=n||u.text.placed||u.icon.placed)}}n?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)},ze.prototype.updateLayerOpacities=function(t,e){for(var n={},i=0,r=e;i<r.length;i+=1){var o=r[i],a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,n,o.collisionBoxArray)}},ze.prototype.updateBucketOpacities=function(t,e,n){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexArray.clear(),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexArray.clear();for(var i=t.layers[0].layout,r=new Ie(null,0,!1,!1,!0),o=new Ie(null,0,i.get("text-allow-overlap"),i.get("icon-allow-overlap"),!0),a=0;a<t.symbolInstances.length;a++){var s=t.symbolInstances[a],l=e[s.crossTileID],u=this.opacities[s.crossTileID];l?u=r:u||(u=o,this.opacities[s.crossTileID]=u),e[s.crossTileID]=!0;var c=s.numGlyphVertices>0||s.numVerticalGlyphVertices>0,h=s.numIconVertices>0;if(c){for(var p=Ve(u.text),f=(s.numGlyphVertices+s.numVerticalGlyphVertices)/4,d=0;d<f;d++)t.text.opacityVertexArray.emplaceBack(p);for(var m=0,v=s.placedTextSymbolIndices;m<v.length;m+=1){var g=v[m];t.text.placedSymbolArray.get(g).hidden=u.text.isHidden()}}if(h){for(var y=Ve(u.icon),_=0;_<s.numIconVertices/4;_++)t.icon.opacityVertexArray.emplaceBack(y);t.icon.placedSymbolArray.get(a).hidden=u.icon.isHidden()}s.collisionArrays||(s.collisionArrays=t.deserializeCollisionBoxes(n,s.textBoxStartIndex,s.textBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex));var x=s.collisionArrays;if(x){x.textBox&&t.hasCollisionBoxData()&&De(t.collisionBox.collisionVertexArray,u.text.placed,!1),x.iconBox&&t.hasCollisionBoxData()&&De(t.collisionBox.collisionVertexArray,u.icon.placed,!1);var b=x.textCircles;if(b&&t.hasCollisionCircleData())for(var w=0;w<b.length;w+=5){var E=l||0===b[w+4];De(t.collisionCircle.collisionVertexArray,u.text.placed,E)}}}t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexBuffer&&t.collisionBox.collisionVertexBuffer.updateData(t.collisionBox.collisionVertexArray),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexBuffer&&t.collisionCircle.collisionVertexBuffer.updateData(t.collisionCircle.collisionVertexArray)},ze.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration},ze.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},ze.prototype.stillRecent=function(t){return"undefined"!==this.commitTime&&this.commitTime+this.fadeDuration>t},ze.prototype.setStale=function(){this.stale=!0};var Le=Math.pow(2,25),Pe=Math.pow(2,24),Oe=Math.pow(2,17),Re=Math.pow(2,16),Be=Math.pow(2,9),Fe=Math.pow(2,8),Ne=Math.pow(2,1);function Ve(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*Le+e*Pe+n*Oe+e*Re+n*Be+e*Fe+n*Ne+e}var je=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};je.prototype.continuePlacement=function(t,e,n,i,r){for(;this._currentTileIndex<t.length;){var o=t[this._currentTileIndex];if(e.placeLayerTile(i,o,n,this._seenCrossTileIDs),this._currentTileIndex++,r())return!0}};var Ue=function(t,e,n,i,r){this.placement=new ze(t,r),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1};Ue.prototype.isDone=function(){return this._done},Ue.prototype.continuePlacement=function(t,e,n){for(var i=this,r=o.now(),a=function(){var t=o.now()-r;return!i._forceFullPlacement&&t>2};this._currentPlacementIndex>=0;){var s=e[t[i._currentPlacementIndex]],l=i.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(i._inProgressLayer||(i._inProgressLayer=new je),i._inProgressLayer.continuePlacement(n[s.source],i.placement,i._showCollisionBoxes,s,a))return;delete i._inProgressLayer}i._currentPlacementIndex--}this._done=!0},Ue.prototype.commit=function(t,e){return this.placement.commit(t,e),this.placement};var qe=512/t.default$8/2,$e=function(t,e,n){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var i=0,r=e;i<r.length;i+=1){var o=r[i],a=o.key;this.indexedSymbolInstances[a]||(this.indexedSymbolInstances[a]=[]),this.indexedSymbolInstances[a].push({crossTileID:o.crossTileID,coord:this.getScaledCoordinates(o,t)})}};$e.prototype.getScaledCoordinates=function(e,n){var i=n.canonical.z-this.tileID.canonical.z,r=qe/Math.pow(2,i),o=e.anchor;return{x:Math.floor((n.canonical.x*t.default$8+o.x)*r),y:Math.floor((n.canonical.y*t.default$8+o.y)*r)}},$e.prototype.findMatches=function(t,e,n){for(var i=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),r=0,o=t;r<o.length;r+=1){var a=o[r];if(!a.crossTileID){var s=this.indexedSymbolInstances[a.key];if(s)for(var l=this.getScaledCoordinates(a,e),u=0,c=s;u<c.length;u+=1){var h=c[u];if(Math.abs(h.coord.x-l.x)<=i&&Math.abs(h.coord.y-l.y)<=i&&!n[h.crossTileID]){n[h.crossTileID]=!0,a.crossTileID=h.crossTileID;break}}}}};var Ze=function(){this.maxCrossTileID=0};Ze.prototype.generate=function(){return++this.maxCrossTileID};var Ge=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Ge.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var n in this.indexes){var i=this.indexes[n],r={};for(var o in i){var a=i[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),r[a.tileID.key]=a}this.indexes[n]=r}this.lng=t},Ge.prototype.addBucket=function(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var i=0,r=e.symbolInstances;i<r.length;i+=1)r[i].crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var o=this.usedCrossTileIDs[t.overscaledZ];for(var a in this.indexes){var s=this.indexes[a];if(Number(a)>t.overscaledZ)for(var l in s){var u=s[l];u.tileID.isChildOf(t)&&u.findMatches(e.symbolInstances,t,o)}else{var c=s[t.scaledTo(Number(a)).key];c&&c.findMatches(e.symbolInstances,t,o)}}for(var h=0,p=e.symbolInstances;h<p.length;h+=1){var f=p[h];f.crossTileID||(f.crossTileID=n.generate(),o[f.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new $e(t,e.symbolInstances,e.bucketInstanceId),!0},Ge.prototype.removeBucketCrossTileIDs=function(t,e){for(var n in e.indexedSymbolInstances)for(var i=0,r=e.indexedSymbolInstances[n];i<r.length;i+=1){var o=r[i];delete this.usedCrossTileIDs[t][o.crossTileID]}},Ge.prototype.removeStaleBuckets=function(t){var e=!1;for(var n in this.indexes){var i=this.indexes[n];for(var r in i)t[i[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[r]),delete i[r],e=!0)}return e};var We=function(){this.layerIndexes={},this.crossTileIDs=new Ze,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};We.prototype.addLayer=function(t,e,n){var i=this.layerIndexes[t.id];void 0===i&&(i=this.layerIndexes[t.id]=new Ge);var r=!1,o={};i.handleWrapJump(n);for(var a=0,s=e;a<s.length;a+=1){var l=s[a],u=l.getBucket(t);u&&t.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(l.tileID,u,this.crossTileIDs)&&(r=!0),o[u.bucketInstanceId]=!0)}return i.removeStaleBuckets(o)&&(r=!0),r},We.prototype.pruneUnusedLayers=function(t){var e={};for(var n in t.forEach((function(t){e[t]=!0})),this.layerIndexes)e[n]||delete this.layerIndexes[n]};var Ye=function(e,n){return t.emitValidationErrors(e,n&&n.filter((function(t){return"source.canvas"!==t.identifier})))},He=t.pick(ee,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Xe=t.pick(ee,["setCenter","setZoom","setBearing","setPitch"]),Ke=(function(e){function n(i,r){var o=this;void 0===r&&(r={}),e.call(this),this.map=i,this.dispatcher=new q((Kt||(Kt=new Jt),Kt),this),this.imageManager=new D,this.glyphManager=new F(i._transformRequest,r.localIdeographFontFamily),this.lineAtlas=new U(256,512),this.crossTileSymbolIndex=new We,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.default$23,this._loaded=!1,this._resetUpdates();var a=this;this._rtlTextPluginCallback=n.registerForPluginAvailability((function(t){for(var e in a.dispatcher.broadcast("loadRTLTextPlugin",t.pluginURL,t.completionCallback),a.sourceCaches)a.sourceCaches[e].reload()})),this.on("data",(function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=o.sourceCaches[t.sourceId];if(e){var n=e.getSource();if(n&&n.vectorLayerIds)for(var i in o._layers){var r=o._layers[i];r.source===n.id&&o._validateLayer(r)}}}}))}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.loadURL=function(e,n){var i=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var r="boolean"==typeof n.validate?n.validate:!_(e);e=(function(t,e){if(!_(t))return t;var n=C(t);return n.path="/styles/v1"+n.path,y(n,e)})(e,n.accessToken);var o=this.map._transformRequest(e,t.ResourceType.Style);t.getJSON(o,(function(e,n){e?i.fire(new t.ErrorEvent(e)):n&&i._load(n,r)}))},n.prototype.loadJSON=function(e,n){var i=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"})),o.frame((function(){i._load(e,!1!==n.validate)}))},n.prototype._load=function(e,n){var i=this;if(!n||!Ye(this,t.validateStyle(e))){for(var r in this._loaded=!0,this.stylesheet=e,e.sources)i.addSource(r,e.sources[r],{validate:!1});e.sprite?(function(e,n,i){var r,a,s,l=o.devicePixelRatio>1?"@2x":"";function u(){if(s)i(s);else if(r&&a){var e=o.getImageData(a),n={};for(var l in r){var u=r[l],c=u.width,h=u.height,p=u.x,f=u.y,d=u.sdf,m=u.pixelRatio,v=new t.RGBAImage({width:c,height:h});t.RGBAImage.copy(e,v,{x:p,y:f},{x:0,y:0},{width:c,height:h}),n[l]={data:v,pixelRatio:m,sdf:d}}i(null,n)}}t.getJSON(n(b(e,l,".json"),t.ResourceType.SpriteJSON),(function(t,e){s||(s=t,r=e,u())})),t.getImage(n(b(e,l,".png"),t.ResourceType.SpriteImage),(function(t,e){s||(s=t,a=e,u())}))})(e.sprite,this.map._transformRequest,(function(e,n){if(e)i.fire(new t.ErrorEvent(e));else if(n)for(var r in n)i.imageManager.addImage(r,n[r]);i.imageManager.setLoaded(!0),i.fire(new t.Event("data",{dataType:"style"}))})):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var a=te(this.stylesheet.layers);this._order=a.map((function(t){return t.id})),this._layers={};for(var s=0,l=a;s<l.length;s+=1){var u=l[s];(u=t.default$22(u)).setEventedParent(i,{layer:{id:u.id}}),i._layers[u.id]=u}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new j(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},n.prototype._validateLayer=function(e){var n=this.sourceCaches[e.source];if(n){var i=e.sourceLayer;if(i){var r=n.getSource();("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(i))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+i+'" does not exist on source "'+r.id+'" as specified by style layer "'+e.id+'"')))}}},n.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},n.prototype._serializeLayers=function(t){var e=this;return t.map((function(t){return e._layers[t].serialize()}))},n.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},n.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},n.prototype.update=function(e){if(this._loaded){if(this._changed){var n=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);for(var r in(n.length||i.length)&&this._updateWorkerLayers(n,i),this._updatedSources){var o=this._updatedSources[r];"reload"===o?this._reloadSource(r):"clear"===o&&this._clearSource(r)}for(var a in this._updatedPaintProps)this._layers[a].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates(),this.fire(new t.Event("data",{dataType:"style"}))}for(var s in this.sourceCaches)this.sourceCaches[s].used=!1;for(var l=0,u=this._order;l<u.length;l+=1){var c=u[l],h=this._layers[c];h.recalculate(e),!h.isHidden(e.zoom)&&h.source&&(this.sourceCaches[h.source].used=!0)}this.light.recalculate(e),this.z=e.zoom}},n.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},n.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},n.prototype.setState=function(e){var n=this;if(this._checkLoaded(),Ye(this,t.validateStyle(e)))return!1;(e=t.clone(e)).layers=te(e.layers);var i=(function(e,n){if(!e)return[{command:ee.setStyle,args:[n]}];var i=[];try{if(!t.default$10(e.version,n.version))return[{command:ee.setStyle,args:[n]}];t.default$10(e.center,n.center)||i.push({command:ee.setCenter,args:[n.center]}),t.default$10(e.zoom,n.zoom)||i.push({command:ee.setZoom,args:[n.zoom]}),t.default$10(e.bearing,n.bearing)||i.push({command:ee.setBearing,args:[n.bearing]}),t.default$10(e.pitch,n.pitch)||i.push({command:ee.setPitch,args:[n.pitch]}),t.default$10(e.sprite,n.sprite)||i.push({command:ee.setSprite,args:[n.sprite]}),t.default$10(e.glyphs,n.glyphs)||i.push({command:ee.setGlyphs,args:[n.glyphs]}),t.default$10(e.transition,n.transition)||i.push({command:ee.setTransition,args:[n.transition]}),t.default$10(e.light,n.light)||i.push({command:ee.setLight,args:[n.light]});var r={},o=[];!(function(e,n,i,r){var o;for(o in n=n||{},e=e||{})e.hasOwnProperty(o)&&(n.hasOwnProperty(o)||ie(o,i,r));for(o in n)n.hasOwnProperty(o)&&(e.hasOwnProperty(o)?t.default$10(e[o],n[o])||("geojson"===e[o].type&&"geojson"===n[o].type&&oe(e,n,o)?i.push({command:ee.setGeoJSONSourceData,args:[o,n[o].data]}):re(o,n,i,r)):ne(o,n,i))})(e.sources,n.sources,o,r);var a=[];e.layers&&e.layers.forEach((function(t){r[t.source]?i.push({command:ee.removeLayer,args:[t.id]}):a.push(t)})),i=i.concat(o),(function(e,n,i){n=n||[];var r,o,a,s,l,u,c,h=(e=e||[]).map(se),p=n.map(se),f=e.reduce(le,{}),d=n.reduce(le,{}),m=h.slice(),v=Object.create(null);for(r=0,o=0;r<h.length;r++)a=h[r],d.hasOwnProperty(a)?o++:(i.push({command:ee.removeLayer,args:[a]}),m.splice(m.indexOf(a,o),1));for(r=0,o=0;r<p.length;r++)a=p[p.length-1-r],m[m.length-1-r]!==a&&(f.hasOwnProperty(a)?(i.push({command:ee.removeLayer,args:[a]}),m.splice(m.lastIndexOf(a,m.length-o),1)):o++,u=m[m.length-r],i.push({command:ee.addLayer,args:[d[a],u]}),m.splice(m.length-r,0,a),v[a]=!0);for(r=0;r<p.length;r++)if(s=f[a=p[r]],l=d[a],!v[a]&&!t.default$10(s,l))if(t.default$10(s.source,l.source)&&t.default$10(s["source-layer"],l["source-layer"])&&t.default$10(s.type,l.type)){for(c in ae(s.layout,l.layout,i,a,null,ee.setLayoutProperty),ae(s.paint,l.paint,i,a,null,ee.setPaintProperty),t.default$10(s.filter,l.filter)||i.push({command:ee.setFilter,args:[a,l.filter]}),t.default$10(s.minzoom,l.minzoom)&&t.default$10(s.maxzoom,l.maxzoom)||i.push({command:ee.setLayerZoomRange,args:[a,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?ae(s[c],l[c],i,a,c.slice(6),ee.setPaintProperty):t.default$10(s[c],l[c])||i.push({command:ee.setLayerProperty,args:[a,c,l[c]]}));for(c in l)l.hasOwnProperty(c)&&!s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?ae(s[c],l[c],i,a,c.slice(6),ee.setPaintProperty):t.default$10(s[c],l[c])||i.push({command:ee.setLayerProperty,args:[a,c,l[c]]}))}else i.push({command:ee.removeLayer,args:[a]}),u=m[m.lastIndexOf(a)+1],i.push({command:ee.addLayer,args:[l,u]})})(a,n.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:ee.setStyle,args:[n]}]}return i})(this.serialize(),e).filter((function(t){return!(t.command in Xe)}));if(0===i.length)return!1;var r=i.filter((function(t){return!(t.command in He)}));if(r.length>0)throw new Error("Unimplemented: "+r.map((function(t){return t.command})).join(", ")+".");return i.forEach((function(t){"setTransition"!==t.command&&n[t.command].apply(n,t.args)})),this.stylesheet=e,!0},n.prototype.addImage=function(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,n),this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.getImage=function(t){return this.imageManager.getImage(t)},n.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.addSource=function(e,n,i){var r=this;if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!n.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(n).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateStyle.source,"sources."+e,n,null,i))){this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);var o=this.sourceCaches[e]=new Wt(e,n,this.dispatcher);o.style=this,o.setEventedParent(this,(function(){return{isSourceLoaded:r.loaded(),source:o.serialize(),sourceId:e}})),o.onAdd(this.map),this._changed=!0}},n.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var n in this._layers)if(this._layers[n].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+n+'" is using it.')));var i=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],i.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),i.setEventedParent(null),i.clearTiles(),i.onRemove&&i.onRemove(this.map),this._changed=!0},n.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},n.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},n.prototype.addLayer=function(e,n,i){this._checkLoaded();var r=e.id;if(this.getLayer(r))this.fire(new t.ErrorEvent(new Error('Layer with id "'+r+'" already exists on this map')));else if("object"==typeof e.source&&(this.addSource(r,e.source),e=t.clone(e),e=t.extend(e,{source:r})),!this._validate(t.validateStyle.layer,"layers."+r,e,{arrayIndex:-1},i)){var o=t.default$22(e);this._validateLayer(o),o.setEventedParent(this,{layer:{id:r}});var a=n?this._order.indexOf(n):this._order.length;if(n&&-1===a)this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.')));else{if(this._order.splice(a,0,r),this._layerOrderChanged=!0,this._layers[r]=o,this._removedLayers[r]&&o.source){var s=this._removedLayers[r];delete this._removedLayers[r],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o)}}},n.prototype.moveLayer=function(e,n){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==n){var i=this._order.indexOf(e);this._order.splice(i,1);var r=n?this._order.indexOf(n):this._order.length;n&&-1===r?this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.'))):(this._order.splice(r,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},n.prototype.removeLayer=function(e){this._checkLoaded();var n=this._layers[e];if(n){n.setEventedParent(null);var i=this._order.indexOf(e);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e]}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},n.prototype.getLayer=function(t){return this._layers[t]},n.prototype.setLayerZoomRange=function(e,n,i){this._checkLoaded();var r=this.getLayer(e);r?r.minzoom===n&&r.maxzoom===i||(null!=n&&(r.minzoom=n),null!=i&&(r.maxzoom=i),this._updateLayer(r)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},n.prototype.setFilter=function(e,n){this._checkLoaded();var i=this.getLayer(e);if(i){if(!t.default$10(i.filter,n))return null==n?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(t.validateStyle.filter,"layers."+i.id+".filter",n)||(i.filter=t.clone(n),this._updateLayer(i)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},n.prototype.getFilter=function(e){return t.clone(this.getLayer(e).filter)},n.prototype.setLayoutProperty=function(e,n,i){this._checkLoaded();var r=this.getLayer(e);r?t.default$10(r.getLayoutProperty(n),i)||(r.setLayoutProperty(n,i),this._updateLayer(r)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getLayoutProperty=function(t,e){return this.getLayer(t).getLayoutProperty(e)},n.prototype.setPaintProperty=function(e,n,i){this._checkLoaded();var r=this.getLayer(e);if(r){if(!t.default$10(r.getPaintProperty(n),i)){var o=r._transitionablePaint._values[n].value.isDataDriven();r.setPaintProperty(n,i),(r._transitionablePaint._values[n].value.isDataDriven()||o)&&this._updateLayer(r),this._changed=!0,this._updatedPaintProps[e]=!0}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},n.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},n.prototype.serialize=function(){var e=this;return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,(function(t){return t.serialize()})),layers:this._order.map((function(t){return e._layers[t].serialize()}))},(function(t){return void 0!==t}))},n.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},n.prototype._flattenRenderedFeatures=function(t){for(var e=[],n=this._order.length-1;n>=0;n--)for(var i=this._order[n],r=0,o=t;r<o.length;r+=1){var a=o[r][i];if(a)for(var s=0,l=a;s<l.length;s+=1){var u=l[s];e.push(u)}}return e},n.prototype.queryRenderedFeatures=function(e,n,i){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter);var r={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,a=n.layers;o<a.length;o+=1){var s=a[o],l=this._layers[s];if(!l)return this.fire(new t.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];r[l.source]=!0}}var u=[];for(var c in this.sourceCaches)n.layers&&!r[c]||u.push(ot(this.sourceCaches[c],this._layers,e.worldCoordinate,n,i));return this.placement&&u.push(function(t,e,n,i,r){for(var o={},a=i.queryRenderedSymbols(e),s=[],l=0,u=Object.keys(a).map(Number);l<u.length;l+=1){var c=u[l];s.push(r[c])}s.sort(at);for(var h=function(){var e=f[p],i=e.featureIndex.lookupSymbolFeatures(a[e.bucketInstanceId],e.bucketIndex,e.sourceLayerIndex,n.filter,n.layers,t);for(var r in i){var s=o[r]=o[r]||[],l=i[r];l.sort((function(t,n){var i=e.featureSortOrder;if(i){var r=i.indexOf(t.featureIndex);return i.indexOf(n.featureIndex)-r}return n.featureIndex-t.featureIndex}));for(var u=0,c=l;u<c.length;u+=1){var h=c[u];s.push(h.feature)}}},p=0,f=s;p<f.length;p+=1)h();return o}(this._layers,e.viewport,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenRenderedFeatures(u)},n.prototype.querySourceFeatures=function(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter);var i=this.sourceCaches[e];return i?(function(t,e){for(var n=t.getRenderableIds().map((function(e){return t.getTileByID(e)})),i=[],r={},o=0;o<n.length;o++){var a=n[o],s=a.tileID.canonical.key;r[s]||(r[s]=!0,a.querySourceFeatures(i,e))}return i})(i,n):[]},n.prototype.addSourceType=function(t,e,i){return n.getSourceType(t)?i(new Error('A source type called "'+t+'" already exists.')):(n.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},i):i(null,null))},n.prototype.getLight=function(){return this.light.getLight()},n.prototype.setLight=function(e){this._checkLoaded();var n=this.light.getLight(),i=!1;for(var r in e)if(!t.default$10(e[r],n[r])){i=!0;break}if(i){var a={now:o.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e),this.light.updateTransitions(a)}},n.prototype._validate=function(e,n,i,r,o){return(!o||!1!==o.validate)&&Ye(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:i,styleSpec:t.default$5},r)))},n.prototype._remove=function(){for(var e in t.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[e].clearTiles();this.dispatcher.remove()},n.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},n.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},n.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},n.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},n.prototype._updatePlacement=function(t,e,n){for(var i=!1,r=!1,a={},s=0,l=this._order;s<l.length;s+=1){var u=l[s],c=this._layers[u];if("symbol"===c.type){if(!a[c.source]){var h=this.sourceCaches[c.source];a[c.source]=h.getRenderableIds().map((function(t){return h.getTileByID(t)})).sort((function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)}))}var p=this.crossTileSymbolIndex.addLayer(c,a[c.source],t.center.lng);i=i||p}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var f=this._layerOrderChanged;if((f||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.now()))&&(this.pauseablePlacement=new Ue(t,this._order,f,e,n),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,a),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(this.placement,o.now()),r=!0),i&&this.pauseablePlacement.placement.setStale()),r||i)for(var d=0,m=this._order;d<m.length;d+=1){var v=m[d],g=this._layers[v];"symbol"===g.type&&this.placement.updateLayerOpacities(g,a[g.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.now())},n.prototype.getImages=function(t,e,n){this.imageManager.getImages(e.icons,n)},n.prototype.getGlyphs=function(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)},n})(t.Evented);Ke.getSourceType=function(t){return it[t]},Ke.setSourceType=function(t,e){it[t]=e},Ke.registerForPluginAvailability=t.registerForPluginAvailability;var Je=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),Qe={prelude:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n// Unpack a pair of values that have been packed into a single float.\n// The packed values are assumed to be 8-bit unsigned integers, and are\n// packed like so:\n// packedValue = floor(input[0]) * 256 + input[1],\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue = int(packedValue);\n    int v0 = packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec2 unpack_opacity(const float packedOpacity) {\n    int intOpacity = int(packedOpacity) / 2;\n    return vec2(float(intOpacity) / 127.0, mod(packedOpacity, 2.0));\n}\n\n// To minimize the number of attributes needed, we encode a 4-component\n// color into a pair of floats (i.e. a vec2) as follows:\n// [ floor(color.r * 255) * 256 + color.g * 255,\n//   floor(color.b * 255) * 256 + color.g * 255 ]\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\n// Unpack a pair of paint values and interpolate between them.\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\n// Unpack a pair of paint values and interpolate between them.\nvec4 unpack_mix_vec4(const vec4 packedColors, const float t) {\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\n// vec2 offset = mod(pixel_coord, size)\n//\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\n//\n// The pixel_coord is passed in as two 16 bit values:\n// pixel_coord_upper = floor(pixel_coord / 2^16)\n// pixel_coord_lower = mod(pixel_coord, 2^16)\n//\n// The offset is calculated in a series of steps that should preserve this precision:\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n}\n"},background:{fragmentSource:"uniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main() {\n    gl_FragColor = u_color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},backgroundPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\nuniform float u_opacity;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    vec2 extrude = v_data.xy;\n    float extrude_length = length(extrude);\n\n    lowp float antialiasblur = v_data.z;\n    float antialiased_blur = -max(blur, antialiasblur);\n\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\n        antialiased_blur,\n        0.0,\n        extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main(void) {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center = floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position = circle_center;\n        if (u_scale_with_map) {\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\n    } else {\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\n\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\n}\n"},clippingMask:{fragmentSource:"void main() {\n    gl_FragColor = vec4(1.0);\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},heatmap:{fragmentSource:"#pragma mapbox: define highp float weight\n\nuniform highp float u_intensity;\nvarying vec2 v_extrude;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main() {\n    #pragma mapbox: initialize highp float weight\n\n    // Kernel density estimation with a Gaussian kernel of size 5x5\n    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);\n    float val = weight * u_intensity * GAUSS_COEF * exp(d);\n\n    gl_FragColor = vec4(val, 1.0, 1.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\n\nuniform mat4 u_matrix;\nuniform float u_extrude_scale;\nuniform float u_opacity;\nuniform float u_intensity;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_extrude;\n\n// Effective \"0\" in the kernel density texture to adjust the kernel size to;\n// this empirically chosen number minimizes artifacts on overlapping kernels\n// for typical heatmap cases (assuming clustered source)\nconst highp float ZERO = 1.0 / 255.0 / 16.0;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main(void) {\n    #pragma mapbox: initialize highp float weight\n    #pragma mapbox: initialize mediump float radius\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 unscaled_extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // This 'extrude' comes in ranging from [-1, -1], to [1, 1].  We'll use\n    // it to produce the vertices of a square mesh framing the point feature\n    // we're adding to the kernel density texture.  We'll also pass it as\n    // a varying, so that the fragment shader can determine the distance of\n    // each fragment from the point feature.\n    // Before we do so, we need to scale it up sufficiently so that the\n    // kernel falls effectively to zero at the edge of the mesh.\n    // That is, we want to know S such that\n    // weight * u_intensity * GAUSS_COEF * exp(-0.5 * 3.0^2 * S^2) == ZERO\n    // Which solves to:\n    // S = sqrt(-2.0 * log(ZERO / (weight * u_intensity * GAUSS_COEF))) / 3.0\n    float S = sqrt(-2.0 * log(ZERO / weight / u_intensity / GAUSS_COEF)) / 3.0;\n\n    // Pass the varying in units of radius\n    v_extrude = S * unscaled_extrude;\n\n    // Scale by radius and the zoom-based scale factor to produce actual\n    // mesh position\n    vec2 extrude = v_extrude * radius * u_extrude_scale;\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec4 pos = vec4(floor(a_pos * 0.5) + extrude, 0, 1);\n\n    gl_Position = u_matrix * pos;\n}\n"},heatmapTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform sampler2D u_color_ramp;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    float t = texture2D(u_image, v_pos).r;\n    vec4 color = texture2D(u_color_ramp, vec2(t, 0.5));\n    gl_FragColor = color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},collisionBox:{fragmentSource:"\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        gl_FragColor *= .1;\n    }\n}",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field boxes in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    gl_Position.xy += a_extrude * u_extrude_scale * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n}\n"},collisionCircle:{fragmentSource:"uniform float u_overscale_factor;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    vec4 color = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        color = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        color *= .2;\n    }\n\n    float extrude_scale_length = length(v_extrude_scale);\n    float extrude_length = length(v_extrude) * extrude_scale_length;\n    float stroke_width = 15.0 * extrude_scale_length / u_overscale_factor;\n    float radius = v_radius * extrude_scale_length;\n\n    float distance_to_edge = abs(extrude_length - radius);\n    float opacity_t = smoothstep(-stroke_width, 0.0, -distance_to_edge);\n\n    gl_FragColor = opacity_t * color;\n}\n",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\n\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field circles in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n\n    highp float padding_factor = 1.2; // Pad the vertices slightly to make room for anti-alias blur\n    gl_Position.xy += a_extrude * u_extrude_scale * padding_factor * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n    v_radius = abs(a_extrude.y); // We don't pitch the circles, so both units of the extrusion vector are equal in magnitude to the radius\n\n    v_extrude = a_extrude * padding_factor;\n    v_extrude_scale = u_extrude_scale * u_camera_to_center_distance * collision_perspective_ratio;\n}\n"},debug:{fragmentSource:"uniform highp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillOutlinePattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n\n\n    gl_FragColor = mix(color1, color2, u_mix) * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},fillExtrusion:{fragmentSource:"varying vec4 v_color;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    gl_FragColor = v_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec4 v_color;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    vec3 normal = a_normal_ed.xyz;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\n\n    // Relative luminance (how dark/bright is the surface color?)\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\n\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Add slight ambient lighting so no extrusions are totally black\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\n    color += ambientlight;\n\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\n    float directional = clamp(dot(normal / 16384.0, u_lightpos), 0.0, 1.0);\n\n    // Adjust directional so that\n    // the range of values for highlight/shading is narrower\n    // with lower light intensity\n    // and with lighter/brighter surface colors\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\n\n    // Add gradient along z axis of side surfaces\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\n    // with lower bounds adjusted to hue of light\n    // so that shading is tinted with the complementary (opposite) color to the light color\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\n}\n"},fillExtrusionPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    vec4 mixedColor = mix(color1, color2, u_mix);\n\n    gl_FragColor = mixedColor * v_lighting;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\nuniform float u_height_factor;\n\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\nvarying float v_directional;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec3 normal = a_normal_ed.xyz;\n    float edgedistance = a_normal_ed.w;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n    float z = t > 0.0 ? height : base;\n\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\n\n    vec2 pos = normal.x == 1.0 && normal.y == 0.0 && normal.z == 16384.0\n        ? a_pos // extrusion top\n        : vec2(edgedistance, z * u_height_factor); // extrusion side\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, pos);\n\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\n    float directional = clamp(dot(normal / 16383.0, u_lightpos), 0.0, 1.0);\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\n\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\n}\n"},extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},hillshadePrepare:{fragmentSource:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D u_image;\nvarying vec2 v_pos;\nuniform vec2 u_dimension;\nuniform float u_zoom;\nuniform float u_maxzoom;\n\nfloat getElevation(vec2 coord, float bias) {\n    // Convert encoded elevation value to meters\n    vec4 data = texture2D(u_image, coord) * 255.0;\n    return (data.r + data.g * 256.0 + data.b * 256.0 * 256.0) / 4.0;\n}\n\nvoid main() {\n    vec2 epsilon = 1.0 / u_dimension;\n\n    // queried pixels:\n    // +-----------+\n    // |   |   |   |\n    // | a | b | c |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | d | e | f |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | g | h | i |\n    // |   |   |   |\n    // +-----------+\n\n    float a = getElevation(v_pos + vec2(-epsilon.x, -epsilon.y), 0.0);\n    float b = getElevation(v_pos + vec2(0, -epsilon.y), 0.0);\n    float c = getElevation(v_pos + vec2(epsilon.x, -epsilon.y), 0.0);\n    float d = getElevation(v_pos + vec2(-epsilon.x, 0), 0.0);\n    float e = getElevation(v_pos, 0.0);\n    float f = getElevation(v_pos + vec2(epsilon.x, 0), 0.0);\n    float g = getElevation(v_pos + vec2(-epsilon.x, epsilon.y), 0.0);\n    float h = getElevation(v_pos + vec2(0, epsilon.y), 0.0);\n    float i = getElevation(v_pos + vec2(epsilon.x, epsilon.y), 0.0);\n\n    // here we divide the x and y slopes by 8 * pixel size\n    // where pixel size (aka meters/pixel) is:\n    // circumference of the world / (pixels per tile * number of tiles)\n    // which is equivalent to: 8 * 40075016.6855785 / (512 * pow(2, u_zoom))\n    // which can be reduced to: pow(2, 19.25619978527 - u_zoom)\n    // we want to vertically exaggerate the hillshading though, because otherwise\n    // it is barely noticeable at low zooms. to do this, we multiply this by some\n    // scale factor pow(2, (u_zoom - u_maxzoom) * a) where a is an arbitrary value\n    // Here we use a=0.3 which works out to the expression below. see \n    // nickidlugash's awesome breakdown for more info\n    // https://github.com/mapbox/mapbox-gl-js/pull/5286#discussion_r148419556\n    float exaggeration = u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;\n\n    vec2 deriv = vec2(\n        (c + f + f + i) - (a + d + d + g),\n        (g + h + h + i) - (a + b + b + c)\n    ) /  pow(2.0, (u_zoom - u_maxzoom) * exaggeration + 19.2562 - u_zoom);\n\n    gl_FragColor = clamp(vec4(\n        deriv.x / 2.0 + 0.5,\n        deriv.y / 2.0 + 0.5,\n        1.0,\n        1.0), 0.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (a_texture_pos / 8192.0) / 2.0 + 0.25;\n}\n"},hillshade:{fragmentSource:"uniform sampler2D u_image;\nvarying vec2 v_pos;\n\nuniform vec2 u_latrange;\nuniform vec2 u_light;\nuniform vec4 u_shadow;\nuniform vec4 u_highlight;\nuniform vec4 u_accent;\n\n#define PI 3.141592653589793\n\nvoid main() {\n    vec4 pixel = texture2D(u_image, v_pos);\n\n    vec2 deriv = ((pixel.rg * 2.0) - 1.0);\n\n    // We divide the slope by a scale factor based on the cosin of the pixel's approximate latitude\n    // to account for mercator projection distortion. see #4807 for details\n    float scaleFactor = cos(radians((u_latrange[0] - u_latrange[1]) * (1.0 - v_pos.y) + u_latrange[1]));\n    // We also multiply the slope by an arbitrary z-factor of 1.25\n    float slope = atan(1.25 * length(deriv) / scaleFactor);\n    float aspect = deriv.x != 0.0 ? atan(deriv.y, -deriv.x) : PI / 2.0 * (deriv.y > 0.0 ? 1.0 : -1.0);\n\n    float intensity = u_light.x;\n    // We add PI to make this property match the global light object, which adds PI/2 to the light's azimuthal\n    // position property to account for 0deg corresponding to north/the top of the viewport in the style spec\n    // and the original shader was written to accept (-illuminationDirection - 90) as the azimuthal.\n    float azimuth = u_light.y + PI;\n\n    // We scale the slope exponentially based on intensity, using a calculation similar to\n    // the exponential interpolation function in the style spec:\n    // https://github.com/mapbox/mapbox-gl-js/blob/master/src/style-spec/expression/definitions/interpolate.js#L217-L228\n    // so that higher intensity values create more opaque hillshading.\n    float base = 1.875 - intensity * 1.75;\n    float maxValue = 0.5 * PI;\n    float scaledSlope = intensity != 0.5 ? ((pow(base, slope) - 1.0) / (pow(base, maxValue) - 1.0)) * maxValue : slope;\n\n    // The accent color is calculated with the cosine of the slope while the shade color is calculated with the sine\n    // so that the accent color's rate of change eases in while the shade color's eases out.\n    float accent = cos(scaledSlope);\n    // We multiply both the accent and shade color by a clamped intensity value\n    // so that intensities >= 0.5 do not additionally affect the color values\n    // while intensity values < 0.5 make the overall color more transparent.\n    vec4 accent_color = (1.0 - accent) * u_accent * clamp(intensity * 2.0, 0.0, 1.0);\n    float shade = abs(mod((aspect + azimuth) / PI + 0.5, 2.0) - 1.0);\n    vec4 shade_color = mix(u_shadow, u_highlight, shade) * sin(scaledSlope) * clamp(intensity * 2.0, 0.0, 1.0);\n    gl_FragColor = accent_color * (1.0 - shade_color.a) + shade_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = a_texture_pos / 8192.0;\n}\n"},line:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_linesofar;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},lineGradient:{fragmentSource:"\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nuniform sampler2D u_image;\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    // For gradient lines, v_lineprogress is the ratio along the entire line,\n    // scaled to [0, 2^15), and the gradient ramp is stored in a texture.\n    vec4 color = texture2D(u_image, vec2(v_lineprogress, 0.5));\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n// the attribute conveying progress along a line is scaled to [0, 2^15)\n#define MAX_LINE_DISTANCE 32767.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_lineprogress = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0 / MAX_LINE_DISTANCE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},linePattern:{fragmentSource:"uniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\n\n    // v_normal.y is 0 at the midpoint of the line, -1 at the lower edge, 1 at the upper edge\n    // we clamp the line width outset to be between 0 and half the pattern height plus padding (2.0)\n    // to ensure we don't sample outside the designated symbol on the sprite sheet.\n    // 0.5 is added to shift the component to be bounded between 0 and 1 for interpolation of\n    // the texture coordinate\n    float y_a = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (u_pattern_size_a.y + 2.0) / 2.0) / u_pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (u_pattern_size_b.y + 2.0) / 2.0) / u_pattern_size_b.y);\n    vec2 pos_a = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, vec2(x_a, y_a));\n    vec2 pos_b = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    gl_FragColor = color * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_linesofar = a_linesofar;\n    v_width2 = vec2(outset, inset);\n}\n"},lineSDF:{fragmentSource:"\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist =outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 = vec2(outset, inset);\n}\n"},raster:{fragmentSource:"uniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    if (color0.a > 0.0) {\n        color0.rgb = color0.rgb / color0.a;\n    }\n    if (color1.a > 0.0) {\n        color1.rgb = color1.rgb / color1.a;\n    }\n    vec4 color = mix(color0, color1, u_fade_t);\n    color.a *= u_opacity;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    // We are using Int16 for texture position coordinates to give us enough precision for\n    // fractional coordinates. We use 8192 to scale the texture coordinates in the buffer\n    // as an arbitrarily high number to preserve adequate precision when rendering.\n    // This is also the same value as the EXTENT we are using for our tile buffer pos coordinates,\n    // so math for modifying either is consistent.\n    v_pos0 = (((a_texture_pos / 8192.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\n\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    lowp float alpha = opacity * v_fade_opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform float u_fade_change;\n\n#pragma mapbox: define lowp float opacity\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n\n    float size;\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // See comments in symbol_sdf.vertex\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n            0.5 + 0.5 * distance_ratio,\n            0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n            4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // See comments in symbol_sdf.vertex\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n\n    v_tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    v_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n}\n"},symbolSDF:{fragmentSource:"#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\n\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform sampler2D u_texture;\nuniform highp float u_gamma_scale;\nuniform bool u_is_text;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 tex = v_data0.xy;\n    float gamma_scale = v_data1.x;\n    float size = v_data1.y;\n    float fade_opacity = v_data1[2];\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    lowp vec4 color = fill_color;\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff = (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color = halo_color;\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n\n    lowp float dist = texture2D(u_texture, tex).a;\n    highp float gamma_scaled = gamma * gamma_scale;\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n    gl_FragColor = color * (alpha * opacity * fade_opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\n// contents of a_size vary based on the type of property value\n// used for {text,icon}-size.\n// For constants, a_size is disabled.\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\n// For composite functions:\n// [ text-size(lowerZoomStop, feature),\n//   text-size(upperZoomStop, feature) ]\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\n\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform float u_fade_change;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n    float size;\n\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // If the label is pitched with the map, layout is done in pitched space,\n    // which makes labels in the distance smaller relative to viewport space.\n    // We counteract part of that effect by multiplying by the perspective ratio.\n    // If the label isn't pitched with the map, we do layout in viewport space,\n    // which makes labels in the distance larger relative to the features around\n    // them. We counteract part of that effect by dividing by the perspective ratio.\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n        0.5 + 0.5 * distance_ratio,\n        0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n        4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\n        // space, project it, and measure its angle in projected space.\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n    float gamma_scale = gl_Position.w;\n\n    vec2 tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    float interpolated_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n\n    v_data0 = vec2(tex.x, tex.y);\n    v_data1 = vec3(gamma_scale, size, interpolated_fade_opacity);\n}\n"}},tn=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,en=function(t){var e=Qe[t],n={};e.fragmentSource=e.fragmentSource.replace(tn,(function(t,e,i,r,o){return n[o]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nvarying "+i+" "+r+" "+o+";\n#else\nuniform "+i+" "+r+" u_"+o+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+o+"\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n"})),e.vertexSource=e.vertexSource.replace(tn,(function(t,e,i,r,o){var a="float"===r?"vec2":"vec4";return n[o]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+i+" "+a+" a_"+o+";\nvarying "+i+" "+r+" "+o+";\n#else\nuniform "+i+" "+r+" u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = unpack_mix_"+a+"(a_"+o+", a_"+o+"_t);\n#else\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+i+" "+a+" a_"+o+";\n#else\nuniform "+i+" "+r+" u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+i+" "+r+" "+o+" = unpack_mix_"+a+"(a_"+o+", a_"+o+"_t);\n#else\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n"}))};for(var nn in Qe)en(nn);var rn=Qe,on=function(t,e,n,i){var r=t.gl;this.program=r.createProgram();var a=n.defines().concat("#define DEVICE_PIXEL_RATIO "+o.devicePixelRatio.toFixed(1));i&&a.push("#define OVERDRAW_INSPECTOR;");var s=a.concat(rn.prelude.fragmentSource,e.fragmentSource).join("\n"),l=a.concat(rn.prelude.vertexSource,e.vertexSource).join("\n"),u=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(u,s),r.compileShader(u),r.attachShader(this.program,u);var c=r.createShader(r.VERTEX_SHADER);r.shaderSource(c,l),r.compileShader(c),r.attachShader(this.program,c);for(var h=n.layoutAttributes||[],p=0;p<h.length;p++)r.bindAttribLocation(this.program,p,h[p].name);r.linkProgram(this.program),this.numAttributes=r.getProgramParameter(this.program,r.ACTIVE_ATTRIBUTES),this.attributes={},this.uniforms={};for(var f=0;f<this.numAttributes;f++){var d=r.getActiveAttrib(this.program,f);d&&(this.attributes[d.name]=r.getAttribLocation(this.program,d.name))}for(var m=r.getProgramParameter(this.program,r.ACTIVE_UNIFORMS),v=0;v<m;v++){var g=r.getActiveUniform(this.program,v);g&&(this.uniforms[g.name]=r.getUniformLocation(this.program,g.name))}};function an(e,n,i,r,o){for(var a=0;a<i.length;a++){var s=i[a];if(r.isLessThan(s.tileID))break;if(n.key===s.tileID.key)return;if(s.tileID.isChildOf(n)){for(var l=n.children(1/0),u=0;u<l.length;u++)an(e,l[u],i.slice(a),r,o);return}}var c=n.overscaledZ-e.overscaledZ,h=new t.CanonicalTileID(c,n.canonical.x-(e.canonical.x<<c),n.canonical.y-(e.canonical.y<<c));o[h.key]=o[h.key]||h}function sn(t,e,n,i,r){var o=t.context,a=o.gl,s=r?t.useProgram("collisionCircle"):t.useProgram("collisionBox");o.setDepthMode(qt.disabled),o.setStencilMode($t.disabled),o.setColorMode(t.colorModeForRenderPass());for(var l=0;l<i.length;l++){var u=i[l],c=e.getTile(u),h=c.getBucket(n);if(h){var p=r?h.collisionCircle:h.collisionBox;if(p){a.uniformMatrix4fv(s.uniforms.u_matrix,!1,u.posMatrix),r||o.lineWidth.set(1),a.uniform1f(s.uniforms.u_camera_to_center_distance,t.transform.cameraToCenterDistance);var f=Te(c,1,t.transform.zoom),d=Math.pow(2,t.transform.zoom-c.tileID.overscaledZ);a.uniform1f(s.uniforms.u_pixels_to_tile_units,f),a.uniform2f(s.uniforms.u_extrude_scale,t.transform.pixelsToGLUnits[0]/(f*d),t.transform.pixelsToGLUnits[1]/(f*d)),a.uniform1f(s.uniforms.u_overscale_factor,c.tileID.overscaleFactor()),s.draw(o,r?a.TRIANGLES:a.LINES,n.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,null,p.collisionVertexBuffer,null)}}}}on.prototype.draw=function(t,e,n,i,r,o,a,s,l){for(var u,c=t.gl,h=(u={},u[c.LINES]=2,u[c.TRIANGLES]=3,u)[e],p=0,f=o.get();p<f.length;p+=1){var d=f[p],m=d.vaos||(d.vaos={});(m[n]||(m[n]=new Q)).bind(t,this,i,a?a.getPaintVertexBuffers():[],r,d.vertexOffset,s,l),c.drawElements(e,d.primitiveLength*h,c.UNSIGNED_SHORT,d.primitiveOffset*h*2)}};var ln=t.mat4.identity(new Float32Array(16)),un=t.default$19.layout;function cn(t,e,n,i,r,o,a,s,l,u){var c,h=t.context,p=h.gl,f=t.transform,d="map"===s,m="map"===l,v=d&&"line"===n.layout.get("symbol-placement"),g=d&&!m&&!v,y=m;h.setDepthMode(y?t.depthModeForSublayer(0,qt.ReadOnly):qt.disabled);for(var _=0,x=i;_<x.length;_+=1){var b=x[_],w=e.getTile(b),E=w.getBucket(n);if(E){var S=r?E.text:E.icon;if(S&&S.segments.get().length){var C=S.programConfigurations.get(n.id),T=r||E.sdfIcons,A=r?E.textSizeData:E.iconSizeData;if(c||(c=t.useProgram(T?"symbolSDF":"symbolIcon",C),C.setUniforms(t.context,c,n.paint,{zoom:t.transform.zoom}),hn(c,t,n,r,g,m,A)),h.activeTexture.set(p.TEXTURE0),p.uniform1i(c.uniforms.u_texture,0),r)w.glyphAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.uniform2fv(c.uniforms.u_texsize,w.glyphAtlasTexture.size);else{var M=1!==n.layout.get("icon-size").constantOr(0)||E.iconsNeedLinear,I=m||0!==f.pitch;w.iconAtlasTexture.bind(T||t.options.rotating||t.options.zooming||M||I?p.LINEAR:p.NEAREST,p.CLAMP_TO_EDGE),p.uniform2fv(c.uniforms.u_texsize,w.iconAtlasTexture.size)}p.uniformMatrix4fv(c.uniforms.u_matrix,!1,t.translatePosMatrix(b.posMatrix,w,o,a));var k=Te(w,1,t.transform.zoom),z=he(b.posMatrix,m,d,t.transform,k),D=pe(b.posMatrix,m,d,t.transform,k);p.uniformMatrix4fv(c.uniforms.u_gl_coord_matrix,!1,t.translatePosMatrix(D,w,o,a,!0)),v?(p.uniformMatrix4fv(c.uniforms.u_label_plane_matrix,!1,ln),me(E,b.posMatrix,t,r,z,D,m,u)):p.uniformMatrix4fv(c.uniforms.u_label_plane_matrix,!1,z),p.uniform1f(c.uniforms.u_fade_change,t.options.fadeDuration?t.symbolFadeChange:1),pn(c,C,t,n,w,S,r,T,m)}}}}function hn(e,n,i,r,o,a,s){var l=n.context.gl,u=n.transform;l.uniform1i(e.uniforms.u_pitch_with_map,a?1:0),l.uniform1f(e.uniforms.u_is_text,r?1:0),l.uniform1f(e.uniforms.u_pitch,u.pitch/360*2*Math.PI);var c="constant"===s.functionType||"source"===s.functionType,h="constant"===s.functionType||"camera"===s.functionType;l.uniform1i(e.uniforms.u_is_size_zoom_constant,c?1:0),l.uniform1i(e.uniforms.u_is_size_feature_constant,h?1:0),l.uniform1f(e.uniforms.u_camera_to_center_distance,u.cameraToCenterDistance);var p=t.evaluateSizeForZoom(s,u.zoom,un.properties[r?"text-size":"icon-size"]);void 0!==p.uSizeT&&l.uniform1f(e.uniforms.u_size_t,p.uSizeT),void 0!==p.uSize&&l.uniform1f(e.uniforms.u_size,p.uSize),l.uniform1f(e.uniforms.u_aspect_ratio,u.width/u.height),l.uniform1i(e.uniforms.u_rotate_symbol,o?1:0)}function pn(t,e,n,i,r,o,a,s,l){var u=n.context,c=u.gl,h=n.transform;if(s){var p=0!==i.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1),f=l?Math.cos(h._pitch)*h.cameraToCenterDistance:1;c.uniform1f(t.uniforms.u_gamma_scale,f),p&&(c.uniform1f(t.uniforms.u_is_halo,1),fn(o,i,u,t)),c.uniform1f(t.uniforms.u_is_halo,0)}fn(o,i,u,t)}function fn(t,e,n,i){i.draw(n,n.gl.TRIANGLES,e.id,t.layoutVertexBuffer,t.indexBuffer,t.segments,t.programConfigurations.get(e.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function dn(t,e,n,i,r,a,s,l,u){var c,h,p,f,d=e.context,m=d.gl,v=r.paint.get("line-dasharray"),g=r.paint.get("line-pattern");if(l||u){var y=1/Te(n,1,e.transform.tileZoom);if(v){c=e.lineAtlas.getDash(v.from,"round"===r.layout.get("line-cap")),h=e.lineAtlas.getDash(v.to,"round"===r.layout.get("line-cap"));var _=c.width*v.fromScale,x=h.width*v.toScale;m.uniform2f(t.uniforms.u_patternscale_a,y/_,-c.height/2),m.uniform2f(t.uniforms.u_patternscale_b,y/x,-h.height/2),m.uniform1f(t.uniforms.u_sdfgamma,e.lineAtlas.width/(256*Math.min(_,x)*o.devicePixelRatio)/2)}else if(g){if(p=e.imageManager.getPattern(g.from),f=e.imageManager.getPattern(g.to),!p||!f)return;m.uniform2f(t.uniforms.u_pattern_size_a,p.displaySize[0]*g.fromScale/y,p.displaySize[1]),m.uniform2f(t.uniforms.u_pattern_size_b,f.displaySize[0]*g.toScale/y,f.displaySize[1]);var b=e.imageManager.getPixelSize(),w=b.width,E=b.height;m.uniform2fv(t.uniforms.u_texsize,[w,E])}m.uniform2f(t.uniforms.u_gl_units_to_pixels,1/e.transform.pixelsToGLUnits[0],1/e.transform.pixelsToGLUnits[1])}l&&(v?(m.uniform1i(t.uniforms.u_image,0),d.activeTexture.set(m.TEXTURE0),e.lineAtlas.bind(d),m.uniform1f(t.uniforms.u_tex_y_a,c.y),m.uniform1f(t.uniforms.u_tex_y_b,h.y),m.uniform1f(t.uniforms.u_mix,v.t)):g&&(m.uniform1i(t.uniforms.u_image,0),d.activeTexture.set(m.TEXTURE0),e.imageManager.bind(d),m.uniform2fv(t.uniforms.u_pattern_tl_a,p.tl),m.uniform2fv(t.uniforms.u_pattern_br_a,p.br),m.uniform2fv(t.uniforms.u_pattern_tl_b,f.tl),m.uniform2fv(t.uniforms.u_pattern_br_b,f.br),m.uniform1f(t.uniforms.u_fade,g.t))),d.setStencilMode(e.stencilModeForClipping(a));var S=e.translatePosMatrix(a.posMatrix,n,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"));if(m.uniformMatrix4fv(t.uniforms.u_matrix,!1,S),m.uniform1f(t.uniforms.u_ratio,1/Te(n,1,e.transform.zoom)),r.paint.get("line-gradient")){d.activeTexture.set(m.TEXTURE0);var C=r.gradientTexture;if(!r.gradient)return;C||(C=r.gradientTexture=new z(d,r.gradient,m.RGBA)),C.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.uniform1i(t.uniforms.u_image,0)}t.draw(d,m.TRIANGLES,r.id,i.layoutVertexBuffer,i.indexBuffer,i.segments,s)}var mn=function(t,e){if(!t)return!1;var n=e.imageManager.getPattern(t.from),i=e.imageManager.getPattern(t.to);return!n||!i},vn=function(t,e,n){var i=e.context,r=i.gl,o=e.imageManager.getPattern(t.from),a=e.imageManager.getPattern(t.to);r.uniform1i(n.uniforms.u_image,0),r.uniform2fv(n.uniforms.u_pattern_tl_a,o.tl),r.uniform2fv(n.uniforms.u_pattern_br_a,o.br),r.uniform2fv(n.uniforms.u_pattern_tl_b,a.tl),r.uniform2fv(n.uniforms.u_pattern_br_b,a.br);var s=e.imageManager.getPixelSize(),l=s.width,u=s.height;r.uniform2fv(n.uniforms.u_texsize,[l,u]),r.uniform1f(n.uniforms.u_mix,t.t),r.uniform2fv(n.uniforms.u_pattern_size_a,o.displaySize),r.uniform2fv(n.uniforms.u_pattern_size_b,a.displaySize),r.uniform1f(n.uniforms.u_scale_a,t.fromScale),r.uniform1f(n.uniforms.u_scale_b,t.toScale),i.activeTexture.set(r.TEXTURE0),e.imageManager.bind(e.context)},gn=function(t,e,n){var i=e.context.gl;i.uniform1f(n.uniforms.u_tile_units_to_pixels,1/Te(t,1,e.transform.tileZoom));var r=Math.pow(2,t.tileID.overscaledZ),o=t.tileSize*Math.pow(2,e.transform.tileZoom)/r,a=o*(t.tileID.canonical.x+t.tileID.wrap*r),s=o*t.tileID.canonical.y;i.uniform2f(n.uniforms.u_pixel_coord_upper,a>>16,s>>16),i.uniform2f(n.uniforms.u_pixel_coord_lower,65535&a,65535&s)};function yn(t,e,n,i,r){if(!mn(n.paint.get("fill-pattern"),t))for(var o=!0,a=0,s=i;a<s.length;a+=1){var l=s[a],u=e.getTile(l),c=u.getBucket(n);c&&(t.context.setStencilMode(t.stencilModeForClipping(l)),r(t,e,n,u,l,c,o),o=!1)}}function _n(t,e,n,i,r,o,a){var s=t.context.gl,l=o.programConfigurations.get(n.id);bn("fill",n.paint.get("fill-pattern"),t,l,n,i,r,a).draw(t.context,s.TRIANGLES,n.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,l)}function xn(t,e,n,i,r,o,a){var s=t.context.gl,l=o.programConfigurations.get(n.id),u=bn("fillOutline",n.getPaintProperty("fill-outline-color")?null:n.paint.get("fill-pattern"),t,l,n,i,r,a);s.uniform2f(u.uniforms.u_world,s.drawingBufferWidth,s.drawingBufferHeight),u.draw(t.context,s.LINES,n.id,o.layoutVertexBuffer,o.indexBuffer2,o.segments2,l)}function bn(t,e,n,i,r,o,a,s){var l,u=n.context.program.get();return e?(l=n.useProgram(t+"Pattern",i),(s||l.program!==u)&&(i.setUniforms(n.context,l,r.paint,{zoom:n.transform.zoom}),vn(e,n,l)),gn(o,n,l)):(l=n.useProgram(t,i),(s||l.program!==u)&&i.setUniforms(n.context,l,r.paint,{zoom:n.transform.zoom})),n.context.gl.uniformMatrix4fv(l.uniforms.u_matrix,!1,n.translatePosMatrix(a.posMatrix,o,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"))),l}var wn=t.default$20.mat3,En=t.default$20.mat4,Sn=t.default$20.vec3;function Cn(t,e,n,i,r,o,a){var s=t.context,l=s.gl,u=n.paint.get("fill-extrusion-pattern"),c=t.context.program.get(),h=o.programConfigurations.get(n.id),p=t.useProgram(u?"fillExtrusionPattern":"fillExtrusion",h);if((a||p.program!==c)&&h.setUniforms(s,p,n.paint,{zoom:t.transform.zoom}),u){if(mn(u,t))return;vn(u,t,p),gn(i,t,p),l.uniform1f(p.uniforms.u_height_factor,-Math.pow(2,r.overscaledZ)/i.tileSize/8)}t.context.gl.uniformMatrix4fv(p.uniforms.u_matrix,!1,t.translatePosMatrix(r.posMatrix,i,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor"))),(function(t,e){var n=e.context.gl,i=e.style.light,r=i.properties.get("position"),o=[r.x,r.y,r.z],a=wn.create();"viewport"===i.properties.get("anchor")&&wn.fromRotation(a,-e.transform.angle),Sn.transformMat3(o,o,a);var s=i.properties.get("color");n.uniform3fv(t.uniforms.u_lightpos,o),n.uniform1f(t.uniforms.u_lightintensity,i.properties.get("intensity")),n.uniform3f(t.uniforms.u_lightcolor,s.r,s.g,s.b)})(p,t),p.draw(s,l.TRIANGLES,n.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,h)}function Tn(e,n,i){var r=e.context,o=r.gl,a=n.fbo;if(a){var s=e.useProgram("hillshade"),l=e.transform.calculatePosMatrix(n.tileID.toUnwrapped(),!0);!(function(t,e,n){var i=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(i-=e.transform.angle),e.context.gl.uniform2f(t.uniforms.u_light,n.paint.get("hillshade-exaggeration"),i)})(s,e,i);var u=(function(e,n){var i=n.toCoordinate(),r=new t.default$17(i.column,i.row+1,i.zoom);return[e.transform.coordinateLocation(i).lat,e.transform.coordinateLocation(r).lat]})(e,n.tileID);r.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,a.colorAttachment.get()),o.uniformMatrix4fv(s.uniforms.u_matrix,!1,l),o.uniform2fv(s.uniforms.u_latrange,u),o.uniform1i(s.uniforms.u_image,0);var c=i.paint.get("hillshade-shadow-color");o.uniform4f(s.uniforms.u_shadow,c.r,c.g,c.b,c.a);var h=i.paint.get("hillshade-highlight-color");o.uniform4f(s.uniforms.u_highlight,h.r,h.g,h.b,h.a);var p=i.paint.get("hillshade-accent-color");if(o.uniform4f(s.uniforms.u_accent,p.r,p.g,p.b,p.a),n.maskedBoundsBuffer&&n.maskedIndexBuffer&&n.segments)s.draw(r,o.TRIANGLES,i.id,n.maskedBoundsBuffer,n.maskedIndexBuffer,n.segments);else{var f=e.rasterBoundsBuffer;e.rasterBoundsVAO.bind(r,s,f,[]),o.drawArrays(o.TRIANGLE_STRIP,0,f.length)}}}function An(e,n,i){var r=e.context,o=r.gl;if(n.dem&&n.dem.level){var a=n.dem.level.dim,s=n.dem.getPixels();if(r.activeTexture.set(o.TEXTURE1),r.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(n.tileSize),n.demTexture){var l=n.demTexture;l.update(s,{premultiply:!1}),l.bind(o.NEAREST,o.CLAMP_TO_EDGE)}else n.demTexture=new z(r,s,o.RGBA,{premultiply:!1}),n.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE);r.activeTexture.set(o.TEXTURE0);var u=n.fbo;if(!u){var c=new z(r,{width:a,height:a,data:null},o.RGBA);c.bind(o.LINEAR,o.CLAMP_TO_EDGE),(u=n.fbo=r.createFramebuffer(a,a)).colorAttachment.set(c.texture)}r.bindFramebuffer.set(u.framebuffer),r.viewport.set([0,0,a,a]);var h=t.mat4.create();t.mat4.ortho(h,0,t.default$8,-t.default$8,0,0,1),t.mat4.translate(h,h,[0,-t.default$8,0]);var p=e.useProgram("hillshadePrepare");o.uniformMatrix4fv(p.uniforms.u_matrix,!1,h),o.uniform1f(p.uniforms.u_zoom,n.tileID.overscaledZ),o.uniform2fv(p.uniforms.u_dimension,[2*a,2*a]),o.uniform1i(p.uniforms.u_image,1),o.uniform1f(p.uniforms.u_maxzoom,i);var f=e.rasterBoundsBuffer;e.rasterBoundsVAO.bind(r,p,f,[]),o.drawArrays(o.TRIANGLE_STRIP,0,f.length),n.needsHillshadePrepare=!1}}function Mn(e,n,i,r,a){var s=r.paint.get("raster-fade-duration");if(s>0){var l=o.now(),u=(l-e.timeAdded)/s,c=n?(l-n.timeAdded)/s:-1,h=i.getSource(),p=a.coveringZoomLevel({tileSize:h.tileSize,roundZoom:h.roundZoom}),f=!n||Math.abs(n.tileID.overscaledZ-p)>Math.abs(e.tileID.overscaledZ-p),d=f&&e.refreshedUponExpiration?1:t.clamp(f?u:1-c,0,1);return e.refreshedUponExpiration&&u>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}function In(e,n,i){var r=e.context,a=r.gl;r.lineWidth.set(1*o.devicePixelRatio);var s=i.posMatrix,l=e.useProgram("debug");r.setDepthMode(qt.disabled),r.setStencilMode($t.disabled),r.setColorMode(e.colorModeForRenderPass()),a.uniformMatrix4fv(l.uniforms.u_matrix,!1,s),a.uniform4f(l.uniforms.u_color,1,0,0,1),e.debugVAO.bind(r,l,e.debugBuffer,[]),a.drawArrays(a.LINE_STRIP,0,e.debugBuffer.length);for(var u=(function(t,e,n,i){i=i||1;var r,o,a,s,l,u,c,h,p=[];for(r=0,o=t.length;r<o;r++)if(l=kn[t[r]]){for(h=null,a=0,s=l[1].length;a<s;a+=2)-1===l[1][a]&&-1===l[1][a+1]?h=null:(u=e+l[1][a]*i,c=200-l[1][a+1]*i,h&&p.push(h.x,h.y,u,c),h={x:u,y:c});e+=l[0]*i}return p})(i.toString(),50,0,5),c=new t.PosArray,h=0;h<u.length;h+=2)c.emplaceBack(u[h],u[h+1]);var p=r.createVertexBuffer(c,Je.members);(new Q).bind(r,l,p,[]),a.uniform4f(l.uniforms.u_color,1,1,1,1);for(var f=n.getTile(i).tileSize,d=t.default$8/(Math.pow(2,e.transform.zoom-i.overscaledZ)*f),m=[[-1,-1],[-1,1],[1,-1],[1,1]],v=0;v<m.length;v++){var g=m[v];a.uniformMatrix4fv(l.uniforms.u_matrix,!1,t.mat4.translate([],s,[d*g[0],d*g[1],0])),a.drawArrays(a.LINES,0,p.length)}a.uniform4f(l.uniforms.u_color,0,0,0,1),a.uniformMatrix4fv(l.uniforms.u_matrix,!1,s),a.drawArrays(a.LINES,0,p.length)}var kn={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},zn={symbol:function(t,e,n,i){if("translucent"===t.renderPass){var r=t.context;r.setStencilMode($t.disabled),r.setColorMode(t.colorModeForRenderPass()),0!==n.paint.get("icon-opacity").constantOr(1)&&cn(t,e,n,i,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright")),0!==n.paint.get("text-opacity").constantOr(1)&&cn(t,e,n,i,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright")),e.map.showCollisionBoxes&&(function(t,e,n,i){sn(t,e,n,i,!1),sn(t,e,n,i,!0)})(t,e,n,i)}},circle:function(t,e,n,i){if("translucent"===t.renderPass){var r=n.paint.get("circle-opacity"),o=n.paint.get("circle-stroke-width"),a=n.paint.get("circle-stroke-opacity");if(0!==r.constantOr(1)||0!==o.constantOr(1)&&0!==a.constantOr(1)){var s=t.context,l=s.gl;s.setDepthMode(t.depthModeForSublayer(0,qt.ReadOnly)),s.setStencilMode($t.disabled),s.setColorMode(t.colorModeForRenderPass());for(var u=!0,c=0;c<i.length;c++){var h=i[c],p=e.getTile(h),f=p.getBucket(n);if(f){var d=t.context.program.get(),m=f.programConfigurations.get(n.id),v=t.useProgram("circle",m);if((u||v.program!==d)&&(m.setUniforms(s,v,n.paint,{zoom:t.transform.zoom}),u=!1),l.uniform1f(v.uniforms.u_camera_to_center_distance,t.transform.cameraToCenterDistance),l.uniform1i(v.uniforms.u_scale_with_map,"map"===n.paint.get("circle-pitch-scale")?1:0),"map"===n.paint.get("circle-pitch-alignment")){l.uniform1i(v.uniforms.u_pitch_with_map,1);var g=Te(p,1,t.transform.zoom);l.uniform2f(v.uniforms.u_extrude_scale,g,g)}else l.uniform1i(v.uniforms.u_pitch_with_map,0),l.uniform2fv(v.uniforms.u_extrude_scale,t.transform.pixelsToGLUnits);l.uniformMatrix4fv(v.uniforms.u_matrix,!1,t.translatePosMatrix(h.posMatrix,p,n.paint.get("circle-translate"),n.paint.get("circle-translate-anchor"))),v.draw(s,l.TRIANGLES,n.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,m)}}}}},heatmap:function(e,n,i,r){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var o=e.context,a=o.gl;o.setDepthMode(e.depthModeForSublayer(0,qt.ReadOnly)),o.setStencilMode($t.disabled),(function(t,e,n){var i=t.gl;t.activeTexture.set(i.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var r=n.heatmapFbo;if(r)i.bindTexture(i.TEXTURE_2D,r.colorAttachment.get()),t.bindFramebuffer.set(r.framebuffer);else{var o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),(function t(e,n,i,r){var o=e.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,n.width/4,n.height/4,0,o.RGBA,e.extTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),r.colorAttachment.set(i),e.extTextureHalfFloat&&o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&(e.extTextureHalfFloat=null,r.colorAttachment.setDirty(),t(e,n,i,r))})(t,e,o,r=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4))}})(o,e,i),o.clear({color:t.default$6.transparent}),o.setColorMode(new Zt([a.ONE,a.ONE],t.default$6.transparent,[!0,!0,!0,!0]));for(var s=!0,l=0;l<r.length;l++){var u=r[l];if(!n.hasRenderableParent(u)){var c=n.getTile(u),h=c.getBucket(i);if(h){var p=e.context.program.get(),f=h.programConfigurations.get(i.id),d=e.useProgram("heatmap",f),m=e.transform.zoom;(s||d.program!==p)&&(f.setUniforms(e.context,d,i.paint,{zoom:m}),s=!1),a.uniform1f(d.uniforms.u_extrude_scale,Te(c,1,m)),a.uniform1f(d.uniforms.u_intensity,i.paint.get("heatmap-intensity")),a.uniformMatrix4fv(d.uniforms.u_matrix,!1,u.posMatrix),d.draw(o,a.TRIANGLES,i.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,f)}}}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),(function(e,n){var i=e.context,r=i.gl,o=n.heatmapFbo;if(o){i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,o.colorAttachment.get()),i.activeTexture.set(r.TEXTURE1);var a=n.colorRampTexture;a||(a=n.colorRampTexture=new z(i,n.colorRamp,r.RGBA)),a.bind(r.LINEAR,r.CLAMP_TO_EDGE),i.setDepthMode(qt.disabled);var s=e.useProgram("heatmapTexture"),l=n.paint.get("heatmap-opacity");r.uniform1f(s.uniforms.u_opacity,l),r.uniform1i(s.uniforms.u_image,0),r.uniform1i(s.uniforms.u_color_ramp,1);var u=t.mat4.create();t.mat4.ortho(u,0,e.width,e.height,0,0,1),r.uniformMatrix4fv(s.uniforms.u_matrix,!1,u),r.uniform2f(s.uniforms.u_world,r.drawingBufferWidth,r.drawingBufferHeight),e.viewportVAO.bind(e.context,s,e.viewportBuffer,[]),r.drawArrays(r.TRIANGLE_STRIP,0,4)}})(e,i))},line:function(t,e,n,i){if("translucent"===t.renderPass&&0!==n.paint.get("line-opacity").constantOr(1)){var r=t.context;r.setDepthMode(t.depthModeForSublayer(0,qt.ReadOnly)),r.setColorMode(t.colorModeForRenderPass());for(var o,a=n.paint.get("line-dasharray")?"lineSDF":n.paint.get("line-pattern")?"linePattern":n.paint.get("line-gradient")?"lineGradient":"line",s=!0,l=0,u=i;l<u.length;l+=1){var c=u[l],h=e.getTile(c),p=h.getBucket(n);if(p){var f=p.programConfigurations.get(n.id),d=t.context.program.get(),m=t.useProgram(a,f),v=s||m.program!==d,g=o!==h.tileID.overscaledZ;v&&f.setUniforms(t.context,m,n.paint,{zoom:t.transform.zoom}),dn(m,t,h,p,n,c,f,v,g),o=h.tileID.overscaledZ,s=!1}}}},fill:function(e,n,i,r){var o=i.paint.get("fill-color"),a=i.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=e.context;s.setColorMode(e.colorModeForRenderPass());var l=i.paint.get("fill-pattern")||1!==o.constantOr(t.default$6.transparent).a||1!==a.constantOr(0)?"translucent":"opaque";e.renderPass===l&&(s.setDepthMode(e.depthModeForSublayer(1,"opaque"===e.renderPass?qt.ReadWrite:qt.ReadOnly)),yn(e,n,i,r,_n)),"translucent"===e.renderPass&&i.paint.get("fill-antialias")&&(s.lineWidth.set(2),s.setDepthMode(e.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,qt.ReadOnly)),yn(e,n,i,r,xn))}},"fill-extrusion":function(e,n,i,r){if(0!==i.paint.get("fill-extrusion-opacity"))if("offscreen"===e.renderPass){!(function(e,n){var i=e.context,r=i.gl,o=n.viewportFrame;if(e.depthRboNeedsClear&&e.setupOffscreenDepthRenderbuffer(),!o){var a=new z(i,{width:e.width,height:e.height,data:null},r.RGBA);a.bind(r.LINEAR,r.CLAMP_TO_EDGE),(o=n.viewportFrame=i.createFramebuffer(e.width,e.height)).colorAttachment.set(a.texture)}i.bindFramebuffer.set(o.framebuffer),o.depthAttachment.set(e.depthRbo),e.depthRboNeedsClear&&(i.clear({depth:1}),e.depthRboNeedsClear=!1),i.clear({color:t.default$6.transparent}),i.setStencilMode($t.disabled),i.setDepthMode(new qt(r.LEQUAL,qt.ReadWrite,[0,1])),i.setColorMode(e.colorModeForRenderPass())})(e,i);for(var o=!0,a=0,s=r;a<s.length;a+=1){var l=s[a],u=n.getTile(l),c=u.getBucket(i);c&&(Cn(e,0,i,u,l,c,o),o=!1)}}else"translucent"===e.renderPass&&(function(t,e){var n=e.viewportFrame;if(n){var i=t.context,r=i.gl,o=t.useProgram("extrusionTexture");i.setStencilMode($t.disabled),i.setDepthMode(qt.disabled),i.setColorMode(t.colorModeForRenderPass()),i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n.colorAttachment.get()),r.uniform1f(o.uniforms.u_opacity,e.paint.get("fill-extrusion-opacity")),r.uniform1i(o.uniforms.u_image,0);var a=En.create();En.ortho(a,0,t.width,t.height,0,0,1),r.uniformMatrix4fv(o.uniforms.u_matrix,!1,a),r.uniform2f(o.uniforms.u_world,r.drawingBufferWidth,r.drawingBufferHeight),t.viewportVAO.bind(i,o,t.viewportBuffer,[]),r.drawArrays(r.TRIANGLE_STRIP,0,4)}})(e,i)},hillshade:function(t,e,n,i){if("offscreen"===t.renderPass||"translucent"===t.renderPass){var r=t.context,o=e.getSource().maxzoom;r.setDepthMode(t.depthModeForSublayer(0,qt.ReadOnly)),r.setStencilMode($t.disabled),r.setColorMode(t.colorModeForRenderPass());for(var a=0,s=i;a<s.length;a+=1){var l=s[a],u=e.getTile(l);u.needsHillshadePrepare&&"offscreen"===t.renderPass?An(t,u,o):"translucent"===t.renderPass&&Tn(t,u,n)}r.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,n,i){if("translucent"===t.renderPass&&0!==n.paint.get("raster-opacity")){var r,o,a=t.context,s=a.gl,l=e.getSource(),u=t.useProgram("raster");a.setStencilMode($t.disabled),a.setColorMode(t.colorModeForRenderPass()),s.uniform1f(u.uniforms.u_brightness_low,n.paint.get("raster-brightness-min")),s.uniform1f(u.uniforms.u_brightness_high,n.paint.get("raster-brightness-max")),s.uniform1f(u.uniforms.u_saturation_factor,(r=n.paint.get("raster-saturation"))>0?1-1/(1.001-r):-r),s.uniform1f(u.uniforms.u_contrast_factor,(o=n.paint.get("raster-contrast"))>0?1/(1-o):1+o),s.uniform3fv(u.uniforms.u_spin_weights,(function(t){t*=Math.PI/180;var e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]})(n.paint.get("raster-hue-rotate"))),s.uniform1f(u.uniforms.u_buffer_scale,1),s.uniform1i(u.uniforms.u_image0,0),s.uniform1i(u.uniforms.u_image1,1);for(var c=i.length&&i[0].overscaledZ,h=0,p=i;h<p.length;h+=1){var f=p[h];a.setDepthMode(t.depthModeForSublayer(f.overscaledZ-c,1===n.paint.get("raster-opacity")?qt.ReadWrite:qt.ReadOnly,s.LESS));var d=e.getTile(f),m=t.transform.calculatePosMatrix(f.toUnwrapped(),!0);d.registerFadeDuration(n.paint.get("raster-fade-duration")),s.uniformMatrix4fv(u.uniforms.u_matrix,!1,m);var v=e.findLoadedParent(f,0,{}),g=Mn(d,v,e,n,t.transform),y=void 0,_=void 0;if(a.activeTexture.set(s.TEXTURE0),d.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.activeTexture.set(s.TEXTURE1),v?(v.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),y=Math.pow(2,v.tileID.overscaledZ-d.tileID.overscaledZ),_=[d.tileID.canonical.x*y%1,d.tileID.canonical.y*y%1]):d.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),s.uniform2fv(u.uniforms.u_tl_parent,_||[0,0]),s.uniform1f(u.uniforms.u_scale_parent,y||1),s.uniform1f(u.uniforms.u_fade_t,g.mix),s.uniform1f(u.uniforms.u_opacity,g.opacity*n.paint.get("raster-opacity")),l instanceof tt){var x=l.boundsBuffer;l.boundsVAO.bind(a,u,x,[]),s.drawArrays(s.TRIANGLE_STRIP,0,x.length)}else if(d.maskedBoundsBuffer&&d.maskedIndexBuffer&&d.segments)u.draw(a,s.TRIANGLES,n.id,d.maskedBoundsBuffer,d.maskedIndexBuffer,d.segments);else{var b=t.rasterBoundsBuffer;t.rasterBoundsVAO.bind(a,u,b,[]),s.drawArrays(s.TRIANGLE_STRIP,0,b.length)}}}},background:function(t,e,n){var i=n.paint.get("background-color"),r=n.paint.get("background-opacity");if(0!==r){var o=t.context,a=o.gl,s=t.transform,l=s.tileSize,u=n.paint.get("background-pattern"),c=u||1!==i.a||1!==r?"translucent":"opaque";if(t.renderPass===c){var h;if(o.setStencilMode($t.disabled),o.setDepthMode(t.depthModeForSublayer(0,"opaque"===c?qt.ReadWrite:qt.ReadOnly)),o.setColorMode(t.colorModeForRenderPass()),u){if(mn(u,t))return;h=t.useProgram("backgroundPattern"),vn(u,t,h),t.tileExtentPatternVAO.bind(o,h,t.tileExtentBuffer,[])}else h=t.useProgram("background"),a.uniform4fv(h.uniforms.u_color,[i.r,i.g,i.b,i.a]),t.tileExtentVAO.bind(o,h,t.tileExtentBuffer,[]);a.uniform1f(h.uniforms.u_opacity,r);for(var p=0,f=s.coveringTiles({tileSize:l});p<f.length;p+=1){var d=f[p];u&&gn({tileID:d,tileSize:l},t,h),a.uniformMatrix4fv(h.uniforms.u_matrix,!1,t.transform.calculatePosMatrix(d.toUnwrapped())),a.drawArrays(a.TRIANGLE_STRIP,0,t.tileExtentBuffer.length)}}}},debug:function(t,e,n){for(var i=0;i<n.length;i++)In(t,e,n[i])}},Dn=function(e,n){this.context=new Gt(e),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=Wt.maxUnderzooming+Wt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new t.default$24,this.crossTileSymbolIndex=new We};function Ln(t,e){if(t.row>e.row){var n=t;t=e,e=n}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function Pn(t,e,n,i,r){var o=Math.max(n,Math.floor(e.y0)),a=Math.min(i,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var l=t.dx/t.dy,u=e.dx/e.dy,c=t.dx>0,h=e.dx<0,p=o;p<a;p++){var f=l*Math.max(0,Math.min(t.dy,p+c-t.y0))+t.x0,d=u*Math.max(0,Math.min(e.dy,p+h-e.y0))+e.x0;r(Math.floor(d),Math.ceil(f),p)}}function On(t,e,n,i,r,o){var a,s=Ln(t,e),l=Ln(e,n),u=Ln(n,t);s.dy>l.dy&&(a=s,s=l,l=a),s.dy>u.dy&&(a=s,s=u,u=a),l.dy>u.dy&&(a=l,l=u,u=a),s.dy&&Pn(u,s,i,r,o),l.dy&&Pn(u,l,i,r,o)}Dn.prototype.resize=function(t,e){var n=this.context.gl;if(this.width=t*o.devicePixelRatio,this.height=e*o.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,r=this.style._order;i<r.length;i+=1){var a=r[i];this.style._layers[a].resize()}this.depthRbo&&(n.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},Dn.prototype.setup=function(){var e=this.context,n=new t.PosArray;n.emplaceBack(0,0),n.emplaceBack(t.default$8,0),n.emplaceBack(0,t.default$8),n.emplaceBack(t.default$8,t.default$8),this.tileExtentBuffer=e.createVertexBuffer(n,Je.members),this.tileExtentVAO=new Q,this.tileExtentPatternVAO=new Q;var i=new t.PosArray;i.emplaceBack(0,0),i.emplaceBack(t.default$8,0),i.emplaceBack(t.default$8,t.default$8),i.emplaceBack(0,t.default$8),i.emplaceBack(0,0),this.debugBuffer=e.createVertexBuffer(i,Je.members),this.debugVAO=new Q;var r=new t.RasterBoundsArray;r.emplaceBack(0,0,0,0),r.emplaceBack(t.default$8,0,t.default$8,0),r.emplaceBack(0,t.default$8,0,t.default$8),r.emplaceBack(t.default$8,t.default$8,t.default$8,t.default$8),this.rasterBoundsBuffer=e.createVertexBuffer(r,J.members),this.rasterBoundsVAO=new Q;var o=new t.PosArray;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,Je.members),this.viewportVAO=new Q},Dn.prototype.clearStencil=function(){var e=this.context,n=e.gl;e.setColorMode(Zt.disabled),e.setDepthMode(qt.disabled),e.setStencilMode(new $t({func:n.ALWAYS,mask:0},0,255,n.ZERO,n.ZERO,n.ZERO));var i=t.mat4.create();t.mat4.ortho(i,0,this.width,this.height,0,0,1),t.mat4.scale(i,i,[n.drawingBufferWidth,n.drawingBufferHeight,0]);var r=this.useProgram("clippingMask");n.uniformMatrix4fv(r.uniforms.u_matrix,!1,i),this.viewportVAO.bind(e,r,this.viewportBuffer,[]),n.drawArrays(n.TRIANGLE_STRIP,0,4)},Dn.prototype._renderTileClippingMasks=function(t){var e=this.context,n=e.gl;e.setColorMode(Zt.disabled),e.setDepthMode(qt.disabled);var i=1;this._tileClippingMaskIDs={};for(var r=0,o=t;r<o.length;r+=1){var a=o[r],s=this._tileClippingMaskIDs[a.key]=i++;e.setStencilMode(new $t({func:n.ALWAYS,mask:0},s,255,n.KEEP,n.KEEP,n.REPLACE));var l=this.useProgram("clippingMask");n.uniformMatrix4fv(l.uniforms.u_matrix,!1,a.posMatrix),this.tileExtentVAO.bind(this.context,l,this.tileExtentBuffer,[]),n.drawArrays(n.TRIANGLE_STRIP,0,this.tileExtentBuffer.length)}},Dn.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new $t({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},Dn.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new Zt([e.CONSTANT_COLOR,e.ONE],new t.default$6(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Zt.unblended:Zt.alphaBlended},Dn.prototype.depthModeForSublayer=function(t,e,n){var i=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon,r=i-1+this.depthRange;return new qt(n||this.context.gl.LEQUAL,e,[r,i])},Dn.prototype.render=function(e,n){var i=this;for(var r in this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(o.now()),e.sourceCaches){var a=i.style.sourceCaches[r];a.used&&a.prepare(i.context)}var s=this.style._order,l=t.filterObject(this.style.sourceCaches,(function(t){return"raster"===t.getSource().type||"raster-dem"===t.getSource().type})),u=function(e){var n=l[e];!(function(e,n){for(var i=e.sort((function(t,e){return t.tileID.isLessThan(e.tileID)?-1:e.tileID.isLessThan(t.tileID)?1:0})),r=0;r<i.length;r++){var o={},a=i[r],s=i.slice(r+1);an(a.tileID.wrapped(),a.tileID,s,new t.OverscaledTileID(0,a.tileID.wrap+1,0,0,0),o),a.setMask(o,n)}})(n.getVisibleCoordinates().map((function(t){return n.getTile(t)})),i.context)};for(var c in l)u(c);this.renderPass="offscreen";var h,p=[];this.depthRboNeedsClear=!0;for(var f=0;f<s.length;f++){var d=i.style._layers[s[f]];d.hasOffscreenPass()&&!d.isHidden(i.transform.zoom)&&(d.source!==(h&&h.id)&&(p=[],(h=i.style.sourceCaches[d.source])&&(p=h.getVisibleCoordinates()).reverse()),p.length&&i.renderLayer(i,h,d,p))}this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?t.default$6.black:t.default$6.transparent,depth:1}),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRange=(e._order.length+2)*this.numSublayers*this.depthEpsilon,this.renderPass="opaque";var m,v=[];for(this.currentLayer=s.length-1,this.currentLayer;this.currentLayer>=0;this.currentLayer--){var g=i.style._layers[s[i.currentLayer]];g.source!==(m&&m.id)&&(v=[],(m=i.style.sourceCaches[g.source])&&(i.clearStencil(),v=m.getVisibleCoordinates(),m.getSource().isTileClipped&&i._renderTileClippingMasks(v))),i.renderLayer(i,m,g,v)}this.renderPass="translucent";var y,_=[];for(this.currentLayer=0,this.currentLayer;this.currentLayer<s.length;this.currentLayer++){var x=i.style._layers[s[i.currentLayer]];x.source!==(y&&y.id)&&(_=[],(y=i.style.sourceCaches[x.source])&&(i.clearStencil(),_=y.getVisibleCoordinates(),y.getSource().isTileClipped&&i._renderTileClippingMasks(_)),_.reverse()),i.renderLayer(i,y,x,_)}if(this.options.showTileBoundaries){var b=this.style.sourceCaches[Object.keys(this.style.sourceCaches)[0]];b&&zn.debug(this,b,b.getVisibleCoordinates())}},Dn.prototype.setupOffscreenDepthRenderbuffer=function(){var t=this.context;this.depthRbo||(this.depthRbo=t.createRenderbuffer(t.gl.DEPTH_COMPONENT16,this.width,this.height))},Dn.prototype.renderLayer=function(t,e,n,i){n.isHidden(this.transform.zoom)||("background"===n.type||i.length)&&(this.id=n.id,zn[n.type](t,e,n,i))},Dn.prototype.translatePosMatrix=function(e,n,i,r,o){if(!i[0]&&!i[1])return e;var a=o?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(a){var s=Math.sin(a),l=Math.cos(a);i=[i[0]*l-i[1]*s,i[0]*s+i[1]*l]}var u=[o?i[0]:Te(n,i[0],this.transform.zoom),o?i[1]:Te(n,i[1],this.transform.zoom),0],c=new Float32Array(16);return t.mat4.translate(c,e,u),c},Dn.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},Dn.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},Dn.prototype._createProgramCached=function(t,e){this.cache=this.cache||{};var n=""+t+(e.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new on(this.context,rn[t],e,this._showOverdrawInspector)),this.cache[n]},Dn.prototype.useProgram=function(t,e){var n=this._createProgramCached(t,e||this.emptyProgramConfiguration);return this.context.program.set(n.program),n};var Rn=t.default$20.vec4,Bn=t.default$20.mat4,Fn=t.default$20.mat2,Nn=function(t,e,n){this.tileSize=512,this._renderWorldCopies=void 0===n||n,this._minZoom=t||0,this._maxZoom=e||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this._center=new Z(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},Vn={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},x:{configurable:!0},y:{configurable:!0},point:{configurable:!0}};Nn.prototype.clone=function(){var t=new Nn(this._minZoom,this._maxZoom,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._calcMatrices(),t},Vn.minZoom.get=function(){return this._minZoom},Vn.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},Vn.maxZoom.get=function(){return this._maxZoom},Vn.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},Vn.renderWorldCopies.get=function(){return this._renderWorldCopies},Vn.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},Vn.worldSize.get=function(){return this.tileSize*this.scale},Vn.centerPoint.get=function(){return this.size._div(2)},Vn.size.get=function(){return new t.default$1(this.width,this.height)},Vn.bearing.get=function(){return-this.angle/Math.PI*180},Vn.bearing.set=function(e){var n=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=Fn.create(),Fn.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Vn.pitch.get=function(){return this._pitch/Math.PI*180},Vn.pitch.set=function(e){var n=t.clamp(e,0,60)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())},Vn.fov.get=function(){return this._fov/Math.PI*180},Vn.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},Vn.zoom.get=function(){return this._zoom},Vn.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},Vn.center.get=function(){return this._center},Vn.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},Nn.prototype.coveringZoomLevel=function(t){return(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize))},Nn.prototype.getVisibleUnwrappedCoordinates=function(e){var n=this.pointCoordinate(new t.default$1(0,0),0),i=this.pointCoordinate(new t.default$1(this.width,0),0),r=Math.floor(n.column),o=Math.floor(i.column),a=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var s=r;s<=o;s++)0!==s&&a.push(new t.UnwrappedTileID(s,e));return a},Nn.prototype.coveringTiles=function(e){var n=this.coveringZoomLevel(e),i=n;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);var r=this.pointCoordinate(this.centerPoint,n),o=new t.default$1(r.column-.5,r.row-.5);return (function(e,n,i,r){void 0===r&&(r=!0);var o=1<<e,a={};function s(n,s,l){var u,c,h,p;if(l>=0&&l<=o)for(u=n;u<s;u++)c=Math.floor(u/o),h=(u%o+o)%o,0!==c&&!0!==r||(p=new t.OverscaledTileID(i,c,e,h,l),a[p.key]=p)}return On(n[0],n[1],n[2],0,o,s),On(n[2],n[3],n[0],0,o,s),Object.keys(a).map((function(t){return a[t]}))})(n,[this.pointCoordinate(new t.default$1(0,0),n),this.pointCoordinate(new t.default$1(this.width,0),n),this.pointCoordinate(new t.default$1(this.width,this.height),n),this.pointCoordinate(new t.default$1(0,this.height),n)],e.reparseOverscaled?i:n,this._renderWorldCopies).sort((function(t,e){return o.dist(t.canonical)-o.dist(e.canonical)}))},Nn.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},Vn.unmodified.get=function(){return this._unmodified},Nn.prototype.zoomScale=function(t){return Math.pow(2,t)},Nn.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},Nn.prototype.project=function(e){return new t.default$1(this.lngX(e.lng),this.latY(e.lat))},Nn.prototype.unproject=function(t){return new Z(this.xLng(t.x),this.yLat(t.y))},Vn.x.get=function(){return this.lngX(this.center.lng)},Vn.y.get=function(){return this.latY(this.center.lat)},Vn.point.get=function(){return new t.default$1(this.x,this.y)},Nn.prototype.lngX=function(t){return(180+t)*this.worldSize/360},Nn.prototype.latY=function(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))*this.worldSize/360},Nn.prototype.xLng=function(t){return 360*t/this.worldSize-180},Nn.prototype.yLat=function(t){var e=180-360*t/this.worldSize;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90},Nn.prototype.setLocationAtPoint=function(t,e){var n=this.pointCoordinate(e)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(t)._sub(n)),this._renderWorldCopies&&(this.center=this.center.wrap())},Nn.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},Nn.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},Nn.prototype.locationCoordinate=function(e){return new t.default$17(this.lngX(e.lng)/this.tileSize,this.latY(e.lat)/this.tileSize,this.zoom).zoomTo(this.tileZoom)},Nn.prototype.coordinateLocation=function(t){var e=t.zoomTo(this.zoom);return new Z(this.xLng(e.column*this.tileSize),this.yLat(e.row*this.tileSize))},Nn.prototype.pointCoordinate=function(e,n){void 0===n&&(n=this.tileZoom);var i=[e.x,e.y,0,1],r=[e.x,e.y,1,1];Rn.transformMat4(i,i,this.pixelMatrixInverse),Rn.transformMat4(r,r,this.pixelMatrixInverse);var o=i[3],a=r[3],s=i[0]/o,l=r[0]/a,u=i[1]/o,c=r[1]/a,h=i[2]/o,p=r[2]/a,f=h===p?0:(0-h)/(p-h);return new t.default$17(t.number(s,l,f)/this.tileSize,t.number(u,c,f)/this.tileSize,this.zoom)._zoomTo(n)},Nn.prototype.coordinatePoint=function(e){var n=e.zoomTo(this.zoom),i=[n.column*this.tileSize,n.row*this.tileSize,0,1];return Rn.transformMat4(i,i,this.pixelMatrix),new t.default$1(i[0]/i[3],i[1]/i[3])},Nn.prototype.calculatePosMatrix=function(e,n){void 0===n&&(n=!1);var i=e.key,r=n?this._alignedPosMatrixCache:this._posMatrixCache;if(r[i])return r[i];var o=e.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*e.wrap,l=Bn.identity(new Float64Array(16));return Bn.translate(l,l,[s*a,o.y*a,0]),Bn.scale(l,l,[a/t.default$8,a/t.default$8,1]),Bn.multiply(l,n?this.alignedProjMatrix:this.projMatrix,l),r[i]=new Float32Array(l),r[i]},Nn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,n,i,r,o=-90,a=90,s=-180,l=180,u=this.size,c=this._unmodified;if(this.latRange){var h=this.latRange;o=this.latY(h[1]),e=(a=this.latY(h[0]))-o<u.y?u.y/(a-o):0}if(this.lngRange){var p=this.lngRange;s=this.lngX(p[0]),n=(l=this.lngX(p[1]))-s<u.x?u.x/(l-s):0}var f=Math.max(n||0,e||0);if(f)return this.center=this.unproject(new t.default$1(n?(l+s)/2:this.x,e?(a+o)/2:this.y)),this.zoom+=this.scaleZoom(f),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var d=this.y,m=u.y/2;d-m<o&&(r=o+m),d+m>a&&(r=a-m)}if(this.lngRange){var v=this.x,g=u.x/2;v-g<s&&(i=s+g),v+g>l&&(i=l-g)}void 0===i&&void 0===r||(this.center=this.unproject(new t.default$1(void 0!==i?i:this.x,void 0!==r?r:this.y))),this._unmodified=c,this._constraining=!1}},Nn.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var t=this._fov/2,e=Math.PI/2+this._pitch,n=Math.sin(t)*this.cameraToCenterDistance/Math.sin(Math.PI-e-t),i=this.x,r=this.y,o=1.01*(Math.cos(Math.PI/2-this._pitch)*n+this.cameraToCenterDistance),a=new Float64Array(16);Bn.perspective(a,this._fov,this.width/this.height,1,o),Bn.scale(a,a,[1,-1,1]),Bn.translate(a,a,[0,0,-this.cameraToCenterDistance]),Bn.rotateX(a,a,this._pitch),Bn.rotateZ(a,a,this.angle),Bn.translate(a,a,[-i,-r,0]);var s=this.worldSize/(2*Math.PI*6378137*Math.abs(Math.cos(this.center.lat*(Math.PI/180))));Bn.scale(a,a,[1,1,s,1]),this.projMatrix=a;var l=this.width%2/2,u=this.height%2/2,c=Math.cos(this.angle),h=Math.sin(this.angle),p=i-Math.round(i)+c*l+h*u,f=r-Math.round(r)+c*u+h*l,d=new Float64Array(a);if(Bn.translate(d,d,[p>.5?p-1:p,f>.5?f-1:f,0]),this.alignedProjMatrix=d,a=Bn.create(),Bn.scale(a,a,[this.width/2,-this.height/2,1]),Bn.translate(a,a,[1,-1,0]),this.pixelMatrix=Bn.multiply(new Float64Array(16),a,this.projMatrix),!(a=Bn.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=a,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Nn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.default$1(0,0)).zoomTo(this.zoom),n=[e.column*this.tileSize,e.row*this.tileSize,0,1];return Rn.transformMat4(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance},Object.defineProperties(Nn.prototype,Vn);var jn=function(){var e,n,i,r;t.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(e=this._updateHashUnthrottled.bind(this),300,n=!1,i=0,r=function(){i=0,n&&(e(),i=setTimeout(r,300),n=!1)},function(){return n=!0,i||r(),i})};jn.prototype.addTo=function(e){return this._map=e,t.default.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},jn.prototype.remove=function(){return t.default.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},jn.prototype.getHashString=function(t){var e=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,i=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),r=Math.pow(10,i),o=Math.round(e.lng*r)/r,a=Math.round(e.lat*r)/r,s=this._map.getBearing(),l=this._map.getPitch(),u="";return u+=t?"#/"+o+"/"+a+"/"+n:"#"+n+"/"+a+"/"+o,(s||l)&&(u+="/"+Math.round(10*s)/10),l&&(u+="/"+Math.round(l)),u},jn.prototype._onHashChange=function(){var e=t.default.location.hash.replace("#","").split("/");return e.length>=3&&(this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:+(e[3]||0),pitch:+(e[4]||0)}),!0)},jn.prototype._updateHashUnthrottled=function(){var e=this.getHashString();t.default.history.replaceState(t.default.history.state,"",e)};var Un=(function(e){function n(n,i,r,o){void 0===o&&(o={});var a=s.mousePos(i.getCanvasContainer(),r),l=i.unproject(a);e.call(this,n,t.extend({point:a,lngLat:l,originalEvent:r},o)),this._defaultPrevented=!1,this.target=i}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var i={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,i),n})(t.Event),qn=(function(e){function n(n,i,r){var o=s.touchPos(i.getCanvasContainer(),r),a=o.map((function(t){return i.unproject(t)})),l=o.reduce((function(t,e,n,i){return t.add(e.div(i.length))}),new t.default$1(0,0)),u=i.unproject(l);e.call(this,n,{points:o,point:l,lngLats:a,lngLat:u,originalEvent:r}),this._defaultPrevented=!1}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var i={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,i),n})(t.Event),$n=(function(t){function e(e,n,i){t.call(this,e,{originalEvent:i}),this._defaultPrevented=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,n),e})(t.Event),Zn=function(e){this._map=e,this._el=e.getCanvasContainer(),this._delta=0,t.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Zn.prototype.isEnabled=function(){return!!this._enabled},Zn.prototype.isActive=function(){return!!this._active},Zn.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},Zn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Zn.prototype.onWheel=function(e){if(this.isEnabled()){var n=e.deltaMode===t.default.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,i=o.now(),r=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==n&&n%4.000244140625==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(r*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this.isActive()||this._start(e)),e.preventDefault()}},Zn.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(t)},Zn.prototype._start=function(e){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this._map.fire(new t.Event("movestart",{originalEvent:e})),this._map.fire(new t.Event("zoomstart",{originalEvent:e})),this._finishTimeout&&clearTimeout(this._finishTimeout);var n=s.mousePos(this._el,e);this._around=Z.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(n)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},Zn.prototype._onScrollFrame=function(){var e=this;if(this._frameId=null,this.isActive()){var n=this._map.transform;if(0!==this._delta){var i="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?1/450:.01,r=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&0!==r&&(r=1/r);var a="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(a*r))),"wheel"===this._type&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var s=!1;if("wheel"===this._type){var l=Math.min((o.now()-this._lastWheelEventTime)/200,1),u=this._easing(l);n.zoom=t.number(this._startZoom,this._targetZoom,u),l<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):s=!0}else n.zoom=this._targetZoom,s=!0;n.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new t.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new t.Event("zoom",{originalEvent:this._lastWheelEvent})),s&&(this._active=!1,this._finishTimeout=setTimeout((function(){e._map.fire(new t.Event("zoomend",{originalEvent:e._lastWheelEvent})),e._map.fire(new t.Event("moveend",{originalEvent:e._lastWheelEvent})),delete e._targetZoom}),200))}},Zn.prototype._smoothOutEasing=function(e){var n=t.ease;if(this._prevEase){var i=this._prevEase,r=(o.now()-i.start)/i.duration,a=i.easing(r+.01)-i.easing(r),s=.27/Math.sqrt(a*a+1e-4)*.01,l=Math.sqrt(.0729-s*s);n=t.bezier(s,l,.25,1)}return this._prevEase={start:o.now(),duration:e,easing:n},n};var Gn=function(e){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),t.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};Gn.prototype.isEnabled=function(){return!!this._enabled},Gn.prototype.isActive=function(){return!!this._active},Gn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Gn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Gn.prototype.onMouseDown=function(e){this.isEnabled()&&e.shiftKey&&0===e.button&&(t.default.document.addEventListener("mousemove",this._onMouseMove,!1),t.default.document.addEventListener("keydown",this._onKeyDown,!1),t.default.document.addEventListener("mouseup",this._onMouseUp,!1),s.disableDrag(),this._startPos=s.mousePos(this._el,e),this._active=!0)},Gn.prototype._onMouseMove=function(t){var e=this._startPos,n=s.mousePos(this._el,t);this._box||(this._box=s.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var i=Math.min(e.x,n.x),r=Math.max(e.x,n.x),o=Math.min(e.y,n.y),a=Math.max(e.y,n.y);s.setTransform(this._box,"translate("+i+"px,"+o+"px)"),this._box.style.width=r-i+"px",this._box.style.height=a-o+"px"},Gn.prototype._onMouseUp=function(e){if(0===e.button){var n=this._startPos,i=s.mousePos(this._el,e),r=(new G).extend(this._map.unproject(n)).extend(this._map.unproject(i));this._finish(),s.suppressClick(),n.x===i.x&&n.y===i.y?this._fireEvent("boxzoomcancel",e):this._map.fitBounds(r,{linear:!0}).fire(new t.Event("boxzoomend",{originalEvent:e,boxZoomBounds:r}))}},Gn.prototype._onKeyDown=function(t){27===t.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",t))},Gn.prototype._finish=function(){this._active=!1,t.default.document.removeEventListener("mousemove",this._onMouseMove,!1),t.default.document.removeEventListener("keydown",this._onKeyDown,!1),t.default.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(s.remove(this._box),this._box=null),s.enableDrag()},Gn.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))};var Wn=t.bezier(0,0,.25,1),Yn=function(e,n){this._map=e,this._el=n.element||e.getCanvasContainer(),this._state="disabled",this._button=n.button||"right",this._bearingSnap=n.bearingSnap||0,this._pitchWithRotate=!1!==n.pitchWithRotate,t.bindAll(["_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};Yn.prototype.isEnabled=function(){return"disabled"!==this._state},Yn.prototype.isActive=function(){return"active"===this._state},Yn.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},Yn.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Yn.prototype.onMouseDown=function(e){if("enabled"===this._state){if("right"===this._button){if(this._eventButton=s.mouseButton(e),this._eventButton!==(e.ctrlKey?0:2))return}else{if(e.ctrlKey||0!==s.mouseButton(e))return;this._eventButton=0}s.disableDrag(),t.default.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),t.default.document.addEventListener("mouseup",this._onMouseUp),t.default.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[o.now(),this._map.getBearing()]],this._previousPos=s.mousePos(this._el,e),this._center=this._map.transform.centerPoint,e.preventDefault()}},Yn.prototype._onMouseMove=function(t){this._lastMoveEvent=t,this._pos=s.mousePos(this._el,t),"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",t),this._fireEvent("movestart",t),this._pitchWithRotate&&this._fireEvent("pitchstart",t)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame))},Yn.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t){var e=this._map.transform,n=this._previousPos,i=this._pos,r=.8*(n.x-i.x),a=-.5*(n.y-i.y),s=e.bearing-r,l=e.pitch-a,u=this._inertia,c=u[u.length-1];this._drainInertiaBuffer(),u.push([o.now(),this._map._normalizeBearing(s,c[1])]),e.bearing=s,this._pitchWithRotate&&(this._fireEvent("pitch",t),e.pitch=l),this._fireEvent("rotate",t),this._fireEvent("move",t),delete this._lastMoveEvent,this._previousPos=this._pos}},Yn.prototype._onMouseUp=function(t){if(s.mouseButton(t)===this._eventButton)switch(this._state){case"active":this._state="enabled",s.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(t);break;case"pending":this._state="enabled",this._unbind()}},Yn.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",t),this._pitchWithRotate&&this._fireEvent("pitchend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},Yn.prototype._unbind=function(){t.default.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),t.default.document.removeEventListener("mouseup",this._onMouseUp),t.default.removeEventListener("blur",this._onBlur),s.enableDrag()},Yn.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._previousPos},Yn.prototype._inertialRotate=function(t){var e=this;this._fireEvent("rotateend",t),this._drainInertiaBuffer();var n=this._map,i=n.getBearing(),r=this._inertia,o=function(){Math.abs(i)<e._bearingSnap?n.resetNorth({noMoveStart:!0},{originalEvent:t}):e._fireEvent("moveend",t),e._pitchWithRotate&&e._fireEvent("pitchend",t)};if(r.length<2)o();else{var a=r[0],s=r[r.length-1],l=r[r.length-2],u=n._normalizeBearing(i,l[1]),c=s[1]-a[1],h=c<0?-1:1,p=(s[0]-a[0])/1e3;if(0!==c&&0!==p){var f=Math.abs(c*(.25/p));f>180&&(f=180);var d=f/180;u+=h*f*(d/2),Math.abs(n._normalizeBearing(u,0))<this._bearingSnap&&(u=n._normalizeBearing(0,u)),n.rotateTo(u,{duration:1e3*d,easing:Wn,noMoveStart:!0},{originalEvent:t})}else o()}},Yn.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},Yn.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=o.now();t.length>0&&e-t[0][0]>160;)t.shift()};var Hn=t.bezier(0,0,.3,1),Xn=function(e){this._map=e,this._el=e.getCanvasContainer(),this._state="disabled",t.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};Xn.prototype.isEnabled=function(){return"disabled"!==this._state},Xn.prototype.isActive=function(){return"active"===this._state},Xn.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},Xn.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Xn.prototype.onMouseDown=function(e){"enabled"===this._state&&(e.ctrlKey||0!==s.mouseButton(e)||(s.addEventListener(t.default.document,"mousemove",this._onMove,{capture:!0}),s.addEventListener(t.default.document,"mouseup",this._onMouseUp),this._start(e)))},Xn.prototype.onTouchStart=function(e){"enabled"===this._state&&(e.touches.length>1||(s.addEventListener(t.default.document,"touchmove",this._onMove,{capture:!0,passive:!1}),s.addEventListener(t.default.document,"touchend",this._onTouchEnd),this._start(e)))},Xn.prototype._start=function(e){t.default.addEventListener("blur",this._onBlur),this._state="pending",this._previousPos=s.mousePos(this._el,e),this._inertia=[[o.now(),this._previousPos]]},Xn.prototype._onMove=function(t){this._lastMoveEvent=t,t.preventDefault(),this._pos=s.mousePos(this._el,t),this._drainInertiaBuffer(),this._inertia.push([o.now(),this._pos]),"pending"===this._state&&(this._state="active",this._fireEvent("dragstart",t),this._fireEvent("movestart",t)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame))},Xn.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t){var e=this._map.transform;e.setLocationAtPoint(e.pointLocation(this._previousPos),this._pos),this._fireEvent("drag",t),this._fireEvent("move",t),this._previousPos=this._pos,delete this._lastMoveEvent}},Xn.prototype._onMouseUp=function(t){if(0===s.mouseButton(t))switch(this._state){case"active":this._state="enabled",s.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},Xn.prototype._onTouchEnd=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},Xn.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("dragend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},Xn.prototype._unbind=function(){s.removeEventListener(t.default.document,"touchmove",this._onMove,{capture:!0,passive:!1}),s.removeEventListener(t.default.document,"touchend",this._onTouchEnd),s.removeEventListener(t.default.document,"mousemove",this._onMove,{capture:!0}),s.removeEventListener(t.default.document,"mouseup",this._onMouseUp),s.removeEventListener(t.default,"blur",this._onBlur)},Xn.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._previousPos,delete this._pos},Xn.prototype._inertialPan=function(t){this._fireEvent("dragend",t),this._drainInertiaBuffer();var e=this._inertia;if(e.length<2)this._fireEvent("moveend",t);else{var n=e[e.length-1],i=e[0],r=n[1].sub(i[1]),o=(n[0]-i[0])/1e3;if(0===o||n[1].equals(i[1]))this._fireEvent("moveend",t);else{var a=r.mult(.3/o),s=a.mag();s>1400&&(s=1400,a._unit()._mult(s));var l=s/750,u=a.mult(-l/2);this._map.panBy(u,{duration:1e3*l,easing:Hn,noMoveStart:!0},{originalEvent:t})}}},Xn.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},Xn.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=o.now();t.length>0&&e-t[0][0]>160;)t.shift()};var Kn=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onKeyDown"],this)};function Jn(t){return t*(2-t)}Kn.prototype.isEnabled=function(){return!!this._enabled},Kn.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},Kn.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},Kn.prototype._onKeyDown=function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=0,n=0,i=0,r=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),r=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),r=1);break;case 38:t.shiftKey?i=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?i=-1:(o=1,t.preventDefault());break;default:return}var a=this._map,s=a.getZoom(),l={duration:300,delayEndEvents:500,easing:Jn,zoom:e?Math.round(s)+e*(t.shiftKey?2:1):s,bearing:a.getBearing()+15*n,pitch:a.getPitch()+10*i,offset:[100*-r,100*-o],center:a.getCenter()};a.easeTo(l,{originalEvent:t})}};var Qn=function(e){this._map=e,t.bindAll(["_onDblClick","_onZoomEnd"],this)};Qn.prototype.isEnabled=function(){return!!this._enabled},Qn.prototype.isActive=function(){return!!this._active},Qn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Qn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Qn.prototype.onTouchStart=function(t){var e=this;this.isEnabled()&&(t.points.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._zoom(t)):this._tapped=setTimeout((function(){e._tapped=null}),300)))},Qn.prototype.onDblClick=function(t){this.isEnabled()&&(t.originalEvent.preventDefault(),this._zoom(t))},Qn.prototype._zoom=function(t){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(t.originalEvent.shiftKey?-1:1),{around:t.lngLat},t)},Qn.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var ti=t.bezier(0,0,.15,1),ei=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};ei.prototype.isEnabled=function(){return!!this._enabled},ei.prototype.enable=function(t){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)},ei.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},ei.prototype.disableRotation=function(){this._rotationDisabled=!0},ei.prototype.enableRotation=function(){this._rotationDisabled=!1},ei.prototype.onStart=function(e){if(this.isEnabled()&&2===e.touches.length){var n=s.mousePos(this._el,e.touches[0]),i=s.mousePos(this._el,e.touches[1]);this._startVec=n.sub(i),this._gestureIntent=void 0,this._inertia=[],s.addEventListener(t.default.document,"touchmove",this._onMove,{passive:!1}),s.addEventListener(t.default.document,"touchend",this._onEnd)}},ei.prototype._getTouchEventData=function(t){var e=s.mousePos(this._el,t.touches[0]),n=s.mousePos(this._el,t.touches[1]),i=e.sub(n);return{vec:i,center:e.add(n).div(2),scale:i.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*i.angleWith(this._startVec)/Math.PI}},ei.prototype._onMove=function(e){if(2===e.touches.length){var n=this._getTouchEventData(e),i=n.vec,r=n.scale,o=n.bearing;if(!this._gestureIntent){var a=Math.abs(1-r)>.15;Math.abs(o)>10?this._gestureIntent="rotate":a&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new t.Event(this._gestureIntent+"start",{originalEvent:e})),this._map.fire(new t.Event("movestart",{originalEvent:e})),this._startVec=i)}this._lastTouchEvent=e,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),e.preventDefault()}},ei.prototype._onTouchFrame=function(){this._frameId=null;var e=this._gestureIntent;if(e){var n=this._map.transform;this._startScale||(this._startScale=n.scale,this._startBearing=n.bearing);var i=this._getTouchEventData(this._lastTouchEvent),r=i.center,a=i.bearing,s=i.scale,l=n.pointLocation(r),u=n.locationPoint(l);"rotate"===e&&(n.bearing=this._startBearing+a),n.zoom=n.scaleZoom(this._startScale*s),n.setLocationAtPoint(l,u),this._map.fire(new t.Event(e,{originalEvent:this._lastTouchEvent})),this._map.fire(new t.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([o.now(),s,r])}},ei.prototype._onEnd=function(e){s.removeEventListener(t.default.document,"touchmove",this._onMove,{passive:!1}),s.removeEventListener(t.default.document,"touchend",this._onEnd);var n=this._gestureIntent,i=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,n){this._map.fire(new t.Event(n+"end",{originalEvent:e})),this._drainInertiaBuffer();var r=this._inertia,o=this._map;if(r.length<2)o.snapToNorth({},{originalEvent:e});else{var a=r[r.length-1],l=r[0],u=o.transform.scaleZoom(i*a[1]),c=o.transform.scaleZoom(i*l[1]),h=u-c,p=(a[0]-l[0])/1e3,f=a[2];if(0!==p&&u!==c){var d=.15*h/p;Math.abs(d)>2.5&&(d=d>0?2.5:-2.5);var m=1e3*Math.abs(d/(12*.15)),v=u+d*m/2e3;v<0&&(v=0),o.easeTo({zoom:v,duration:m,easing:ti,around:this._aroundCenter?o.getCenter():o.unproject(f),noMoveStart:!0},{originalEvent:e})}else o.snapToNorth({},{originalEvent:e})}}},ei.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=o.now();t.length>2&&e-t[0][0]>160;)t.shift()};var ni={scrollZoom:Zn,boxZoom:Gn,dragRotate:Yn,dragPan:Xn,keyboard:Kn,doubleClickZoom:Qn,touchZoomRotate:ei},ii=(function(e){function n(n,i){e.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=i.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getCenter=function(){return this.transform.center},n.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},n.prototype.panBy=function(e,n,i){return e=t.default$1.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),i)},n.prototype.panTo=function(e,n,i){return this.easeTo(t.extend({center:e},n),i)},n.prototype.getZoom=function(){return this.transform.zoom},n.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},n.prototype.zoomTo=function(e,n,i){return this.easeTo(t.extend({zoom:e},n),i)},n.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},n.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},n.prototype.getBearing=function(){return this.transform.bearing},n.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},n.prototype.rotateTo=function(e,n,i){return this.easeTo(t.extend({bearing:e},n),i)},n.prototype.resetNorth=function(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this},n.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},n.prototype.getPitch=function(){return this.transform.pitch},n.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},n.prototype.fitBounds=function(e,n,i){if("number"==typeof(n=t.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding){var r=n.padding;n.padding={top:r,bottom:r,right:r,left:r}}if(!t.default$10(Object.keys(n.padding).sort((function(t,e){return t<e?-1:t>e?1:0})),["bottom","left","right","top"]))return t.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'"),this;e=G.convert(e);var o=[(n.padding.left-n.padding.right)/2,(n.padding.top-n.padding.bottom)/2],a=Math.min(n.padding.right,n.padding.left),s=Math.min(n.padding.top,n.padding.bottom);n.offset=[n.offset[0]+o[0],n.offset[1]+o[1]];var l=t.default$1.convert(n.offset),u=this.transform,c=u.project(e.getNorthWest()),h=u.project(e.getSouthEast()),p=h.sub(c),f=(u.width-2*a-2*Math.abs(l.x))/p.x,d=(u.height-2*s-2*Math.abs(l.y))/p.y;return d<0||f<0?(t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset."),this):(n.center=u.unproject(c.add(h).div(2)),n.zoom=Math.min(u.scaleZoom(u.scale*Math.min(f,d)),n.maxZoom),n.bearing=0,n.linear?this.easeTo(n,i):this.flyTo(n,i))},n.prototype.jumpTo=function(e,n){this.stop();var i=this.transform,r=!1,o=!1,a=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(r=!0,i.zoom=+e.zoom),void 0!==e.center&&(i.center=Z.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(o=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(a=!0,i.pitch=+e.pitch),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),r&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),o&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),a&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))},n.prototype.easeTo=function(e,n){var i=this;this.stop(),!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate&&(e.duration=0);var r=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),l="zoom"in e?+e.zoom:o,u="bearing"in e?this._normalizeBearing(e.bearing,a):a,c="pitch"in e?+e.pitch:s,h=r.centerPoint.add(t.default$1.convert(e.offset)),p=r.pointLocation(h),f=Z.convert(e.center||p);this._normalizeCenter(f);var d,m,v=r.project(p),g=r.project(f).sub(v),y=r.zoomScale(l-o);return e.around&&(d=Z.convert(e.around),m=r.locationPoint(d)),this._zooming=l!==o,this._rotating=a!==u,this._pitching=c!==s,this._prepareEase(n,e.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease((function(e){if(i._zooming&&(r.zoom=t.number(o,l,e)),i._rotating&&(r.bearing=t.number(a,u,e)),i._pitching&&(r.pitch=t.number(s,c,e)),d)r.setLocationAtPoint(d,m);else{var p=r.zoomScale(r.zoom-o),f=l>o?Math.min(2,y):Math.max(.5,y),_=Math.pow(f,1-e),x=r.unproject(v.add(g.mult(e*_)).mult(p));r.setLocationAtPoint(r.renderWorldCopies?x.wrap():x,h)}i._fireMoveEvents(n)}),(function(){e.delayEndEvents?i._easeEndTimeoutID=setTimeout((function(){return i._afterEase(n)}),e.delayEndEvents):i._afterEase(n)}),e),this},n.prototype._prepareEase=function(e,n){this._moving=!0,n||this.fire(new t.Event("movestart",e)),this._zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&this.fire(new t.Event("pitchstart",e))},n.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},n.prototype._afterEase=function(e){var n=this._zooming,i=this._rotating,r=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,n&&this.fire(new t.Event("zoomend",e)),i&&this.fire(new t.Event("rotateend",e)),r&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))},n.prototype.flyTo=function(e,n){var i=this;this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var r=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),l="zoom"in e?t.clamp(+e.zoom,r.minZoom,r.maxZoom):o,u="bearing"in e?this._normalizeBearing(e.bearing,a):a,c="pitch"in e?+e.pitch:s,h=r.zoomScale(l-o),p=r.centerPoint.add(t.default$1.convert(e.offset)),f=r.pointLocation(p),d=Z.convert(e.center||f);this._normalizeCenter(d);var m=r.project(f),v=r.project(d).sub(m),g=e.curve,y=Math.max(r.width,r.height),_=y/h,x=v.mag();if("minZoom"in e){var b=t.clamp(Math.min(e.minZoom,o,l),r.minZoom,r.maxZoom),w=y/r.zoomScale(b-o);g=Math.sqrt(w/x*2)}var E=g*g;function S(t){var e=(_*_-y*y+(t?-1:1)*E*E*x*x)/(2*(t?_:y)*E*x);return Math.log(Math.sqrt(e*e+1)-e)}function C(t){return(Math.exp(t)-Math.exp(-t))/2}function T(t){return(Math.exp(t)+Math.exp(-t))/2}var A=S(0),M=function(t){return T(A)/T(A+g*t)},I=function(t){return y*((T(A)*(C(e=A+g*t)/T(e))-C(A))/E)/x;var e},k=(S(1)-A)/g;if(Math.abs(x)<1e-6||!isFinite(k)){if(Math.abs(y-_)<1e-6)return this.easeTo(e,n);var z=_<y?-1:1;k=Math.abs(Math.log(_/y))/g,I=function(){return 0},M=function(t){return Math.exp(z*g*t)}}if("duration"in e)e.duration=+e.duration;else{var D="screenSpeed"in e?+e.screenSpeed/g:+e.speed;e.duration=1e3*k/D}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=a!==u,this._pitching=c!==s,this._prepareEase(n,!1),this._ease((function(e){var l=e*k,h=1/M(l);r.zoom=o+r.scaleZoom(h),i._rotating&&(r.bearing=t.number(a,u,e)),i._pitching&&(r.pitch=t.number(s,c,e));var f=r.unproject(m.add(v.mult(I(l))).mult(h));r.setLocationAtPoint(r.renderWorldCopies?f.wrap():f,p),i._fireMoveEvents(n)}),(function(){return i._afterEase(n)}),e),this},n.prototype.isEasing=function(){return!!this._easeFrameId},n.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var t=this._onEaseEnd;delete this._onEaseEnd,t.call(this)}return this},n.prototype._ease=function(t,e,n){!1===n.animate||0===n.duration?(t(1),e()):(this._easeStart=o.now(),this._easeOptions=n,this._onEaseFrame=t,this._onEaseEnd=e,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},n.prototype._renderFrameCallback=function(){var t=Math.min((o.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},n.prototype._normalizeBearing=function(e,n){e=t.wrap(e,-180,180);var i=Math.abs(e-n);return Math.abs(e-360-n)<i&&(e-=360),Math.abs(e+360-n)<i&&(e+=360),e},n.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}},n})(t.Evented),ri=function(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};ri.prototype.getDefaultPosition=function(){return"bottom-right"},ri.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ri.prototype.onRemove=function(){s.remove(this._container),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},ri.prototype._updateEditLink=function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var e=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:v.ACCESS_TOKEN}];if(t){var n=e.reduce((function(t,n,i){return n.value&&(t+=n.key+"="+n.value+(i<e.length-1?"&":"")),t}),"?");t.href="https://www.mapbox.com/feedback/"+n+(this._map._hash?this._map._hash.getHashString(!0):"")}},ri.prototype._updateData=function(t){t&&"metadata"===t.sourceDataType&&(this._updateAttributions(),this._updateEditLink())},ri.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var n=this._map.style.sourceCaches;for(var i in n){var r=n[i].getSource();r.attribution&&t.indexOf(r.attribution)<0&&t.push(r.attribution)}t.sort((function(t,e){return t.length-e.length})),(t=t.filter((function(e,n){for(var i=n+1;i<t.length;i++)if(t[i].indexOf(e)>=0)return!1;return!0}))).length?(this._container.innerHTML=t.join(" | "),this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null}},ri.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var oi=function(){t.bindAll(["_updateLogo"],this)};oi.prototype.onAdd=function(t){this._map=t,this._container=s.create("div","mapboxgl-ctrl");var e=s.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.href="https://www.mapbox.com/",e.setAttribute("aria-label","Mapbox logo"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._container},oi.prototype.onRemove=function(){s.remove(this._container),this._map.off("sourcedata",this._updateLogo)},oi.prototype.getDefaultPosition=function(){return"bottom-left"},oi.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},oi.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}};var ai=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};ai.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},ai.prototype.remove=function(t){for(var e=this._currentlyRunning,n=0,i=e?this._queue.concat(e):this._queue;n<i.length;n+=1){var r=i[n];if(r.id===t)return void(r.cancelled=!0)}},ai.prototype.run=function(){var t=this._currentlyRunning=this._queue;this._queue=[];for(var e=0,n=t;e<n.length;e+=1){var i=n[e];if(!i.cancelled&&(i.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},ai.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var si=t.default.HTMLImageElement,li=t.default.HTMLElement,ui={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,transformRequest:null,fadeDuration:300},ci=(function(n){function i(e){if(null!=(e=t.extend({},ui,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than minZoom");var i=new Nn(e.minZoom,e.maxZoom,e.renderWorldCopies);n.call(this,i,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new ai;var r=e.transformRequest;if(this._transformRequest=r?function(t,e){return r(t,e)||{url:t}}:function(t){return{url:t}},"string"==typeof e.container){var o=t.default.document.getElementById(e.container);if(!o)throw new Error("Container '"+e.container+"' not found.");this._container=o}else{if(!(e.container instanceof li))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored","_update","_render","_onData","_onDataLoading"],this),this._setupContainer(),this._setupPainter(),this.on("move",this._update.bind(this,!1)),this.on("zoom",this._update.bind(this,!0)),void 0!==t.default&&(t.default.addEventListener("online",this._onWindowOnline,!1),t.default.addEventListener("resize",this._onWindowResize,!1)),(function(t,e){var n=t.getCanvasContainer(),i=null,r=!1;for(var o in ni)t[o]=new ni[o](t,e),e.interactive&&e[o]&&t[o].enable(e[o]);s.addEventListener(n,"mouseout",(function(e){t.fire(new Un("mouseout",t,e))})),s.addEventListener(n,"mousedown",(function(n){r=!0;var i=new Un("mousedown",t,n);t.fire(i),i.defaultPrevented||(e.interactive&&!t.doubleClickZoom.isActive()&&t.stop(),t.boxZoom.onMouseDown(n),t.boxZoom.isActive()||t.dragPan.isActive()||t.dragRotate.onMouseDown(n),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onMouseDown(n))})),s.addEventListener(n,"mouseup",(function(e){var n=t.dragRotate.isActive();i&&!n&&t.fire(new Un("contextmenu",t,i)),i=null,r=!1,t.fire(new Un("mouseup",t,e))})),s.addEventListener(n,"mousemove",(function(e){if(!t.dragPan.isActive()&&!t.dragRotate.isActive()){for(var i=e.toElement||e.target;i&&i!==n;)i=i.parentNode;i===n&&t.fire(new Un("mousemove",t,e))}})),s.addEventListener(n,"mouseover",(function(e){for(var i=e.toElement||e.target;i&&i!==n;)i=i.parentNode;i===n&&t.fire(new Un("mouseover",t,e))})),s.addEventListener(n,"touchstart",(function(n){var i=new qn("touchstart",t,n);t.fire(i),i.defaultPrevented||(e.interactive&&t.stop(),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onTouchStart(n),t.touchZoomRotate.onStart(n),t.doubleClickZoom.onTouchStart(i))}),{passive:!1}),s.addEventListener(n,"touchmove",(function(e){t.fire(new qn("touchmove",t,e))}),{passive:!1}),s.addEventListener(n,"touchend",(function(e){t.fire(new qn("touchend",t,e))})),s.addEventListener(n,"touchcancel",(function(e){t.fire(new qn("touchcancel",t,e))})),s.addEventListener(n,"click",(function(e){t.fire(new Un("click",t,e))})),s.addEventListener(n,"dblclick",(function(e){var n=new Un("dblclick",t,e);t.fire(n),n.defaultPrevented||t.doubleClickZoom.onDblClick(n)})),s.addEventListener(n,"contextmenu",(function(e){var n=t.dragRotate.isActive();r||n?r&&(i=e):t.fire(new Un("contextmenu",t,e)),e.preventDefault()})),s.addEventListener(n,"wheel",(function(e){var n=new $n("wheel",t,e);t.fire(n),n.defaultPrevented||t.scrollZoom.onWheel(e)}),{passive:!1})})(this,e),this._hash=e.hash&&(new jn).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),this.resize(),e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new ri),this.addControl(new oi,e.logoPosition),this.on("style.load",(function(){this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",this._onData),this.on("dataloading",this._onDataLoading)}n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i;var r={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0}};return i.prototype.addControl=function(t,e){void 0===e&&t.getDefaultPosition&&(e=t.getDefaultPosition()),void 0===e&&(e="top-right");var n=t.onAdd(this),i=this._controlPositions[e];return-1!==e.indexOf("bottom")?i.insertBefore(n,i.firstChild):i.appendChild(n),this},i.prototype.removeControl=function(t){return t.onRemove(this),this},i.prototype.resize=function(e){var n=this._containerDimensions(),i=n[0],r=n[1];return this._resizeCanvas(i,r),this.transform.resize(i,r),this.painter.resize(i,r),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)).fire(new t.Event("resize",e)).fire(new t.Event("moveend",e))},i.prototype.getBounds=function(){var e=new G(this.transform.pointLocation(new t.default$1(0,this.transform.height)),this.transform.pointLocation(new t.default$1(this.transform.width,0)));return(this.transform.angle||this.transform.pitch)&&(e.extend(this.transform.pointLocation(new t.default$1(this.transform.size.x,0))),e.extend(this.transform.pointLocation(new t.default$1(0,this.transform.size.y)))),e},i.prototype.getMaxBounds=function(){return this.transform.latRange&&2===this.transform.latRange.length&&this.transform.lngRange&&2===this.transform.lngRange.length?new G([this.transform.lngRange[0],this.transform.latRange[0]],[this.transform.lngRange[1],this.transform.latRange[1]]):null},i.prototype.setMaxBounds=function(t){if(t){var e=G.convert(t);this.transform.lngRange=[e.getWest(),e.getEast()],this.transform.latRange=[e.getSouth(),e.getNorth()],this.transform._constrain(),this._update()}else null==t&&(this.transform.lngRange=null,this.transform.latRange=null,this._update());return this},i.prototype.setMinZoom=function(t){if((t=null==t?0:t)>=0&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},i.prototype.getMinZoom=function(){return this.transform.minZoom},i.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},i.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},i.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update(),this},i.prototype.getMaxZoom=function(){return this.transform.maxZoom},i.prototype.project=function(t){return this.transform.locationPoint(Z.convert(t))},i.prototype.unproject=function(e){return this.transform.pointLocation(t.default$1.convert(e))},i.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},i.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isActive()},i.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},i.prototype.on=function(t,e,i){var r,o=this;if(void 0===i)return n.prototype.on.call(this,t,e);var a=(function(){if("mouseenter"===t||"mouseover"===t){var n=!1;return{layer:e,listener:i,delegates:{mousemove:function(r){var a=o.getLayer(e)?o.queryRenderedFeatures(r.point,{layers:[e]}):[];a.length?n||(n=!0,i.call(o,new Un(t,o,r.originalEvent,{features:a}))):n=!1},mouseout:function(){n=!1}}}}if("mouseleave"===t||"mouseout"===t){var a=!1;return{layer:e,listener:i,delegates:{mousemove:function(n){(o.getLayer(e)?o.queryRenderedFeatures(n.point,{layers:[e]}):[]).length?a=!0:a&&(a=!1,i.call(o,new Un(t,o,n.originalEvent)))},mouseout:function(e){a&&(a=!1,i.call(o,new Un(t,o,e.originalEvent)))}}}}return{layer:e,listener:i,delegates:(r={},r[t]=function(t){var n=o.getLayer(e)?o.queryRenderedFeatures(t.point,{layers:[e]}):[];n.length&&(t.features=n,i.call(o,t),delete t.features)},r)}})();for(var s in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(a),a.delegates)o.on(s,a.delegates[s]);return this},i.prototype.off=function(t,e,i){if(void 0===i)return n.prototype.off.call(this,t,e);if(this._delegatedListeners&&this._delegatedListeners[t])for(var r=this._delegatedListeners[t],o=0;o<r.length;o++){var a=r[o];if(a.layer===e&&a.listener===i){for(var s in a.delegates)this.off(s,a.delegates[s]);return r.splice(o,1),this}}return this},i.prototype.queryRenderedFeatures=function(e,n){var i;return 2===arguments.length?(e=arguments[0],n=arguments[1]):1===arguments.length&&((i=arguments[0])instanceof t.default$1||Array.isArray(i))?(e=arguments[0],n={}):1===arguments.length?(e=void 0,n=arguments[0]):(e=void 0,n={}),this.style?this.style.queryRenderedFeatures(this._makeQueryGeometry(e),n,this.transform):[]},i.prototype._makeQueryGeometry=function(e){var n,i=this;if(void 0===e&&(e=[t.default$1.convert([0,0]),t.default$1.convert([this.transform.width,this.transform.height])]),e instanceof t.default$1||"number"==typeof e[0])n=[t.default$1.convert(e)];else{var r=[t.default$1.convert(e[0]),t.default$1.convert(e[1])];n=[r[0],new t.default$1(r[1].x,r[0].y),r[1],new t.default$1(r[0].x,r[1].y),r[0]]}return{viewport:n,worldCoordinate:n.map((function(t){return i.transform.pointCoordinate(t)}))}},i.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},i.prototype.setStyle=function(e,n){if((!n||!1!==n.diff&&!n.localIdeographFontFamily)&&this.style&&e&&"object"==typeof e)try{return this.style.setState(e)&&this._update(!0),this}catch(e){t.warnOnce("Unable to perform style diff: "+(e.message||e.error||e)+".  Rebuilding the style from scratch.")}return this.style&&(this.style.setEventedParent(null),this.style._remove()),e?(this.style=new Ke(this,n||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e),this):(delete this.style,this)},i.prototype.getStyle=function(){if(this.style)return this.style.serialize()},i.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},i.prototype.addSource=function(t,e){return this.style.addSource(t,e),this._update(!0),this},i.prototype.isSourceLoaded=function(e){var n=this.style&&this.style.sourceCaches[e];if(void 0!==n)return n.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},i.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var n=t[e]._tiles;for(var i in n){var r=n[i];if("loaded"!==r.state&&"errored"!==r.state)return!1}}return!0},i.prototype.addSourceType=function(t,e,n){return this.style.addSourceType(t,e,n)},i.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0),this},i.prototype.getSource=function(t){return this.style.getSource(t)},i.prototype.addImage=function(e,n,i){void 0===i&&(i={});var r=i.pixelRatio;void 0===r&&(r=1);var a=i.sdf;if(void 0===a&&(a=!1),n instanceof si){var s=o.getImageData(n),l=s.width,u=s.height,c=s.data;this.style.addImage(e,{data:new t.RGBAImage({width:l,height:u},c),pixelRatio:r,sdf:a})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var h=n.width,p=n.height,f=n.data;this.style.addImage(e,{data:new t.RGBAImage({width:h,height:p},f.slice(0)),pixelRatio:r,sdf:a})}},i.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},i.prototype.removeImage=function(t){this.style.removeImage(t)},i.prototype.loadImage=function(e,n){t.getImage(this._transformRequest(e,t.ResourceType.Image),n)},i.prototype.addLayer=function(t,e){return this.style.addLayer(t,e),this._update(!0),this},i.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0),this},i.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0),this},i.prototype.getLayer=function(t){return this.style.getLayer(t)},i.prototype.setFilter=function(t,e){return this.style.setFilter(t,e),this._update(!0),this},i.prototype.setLayerZoomRange=function(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0),this},i.prototype.getFilter=function(t){return this.style.getFilter(t)},i.prototype.setPaintProperty=function(t,e,n){return this.style.setPaintProperty(t,e,n),this._update(!0),this},i.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},i.prototype.setLayoutProperty=function(t,e,n){return this.style.setLayoutProperty(t,e,n),this._update(!0),this},i.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},i.prototype.setLight=function(t){return this.style.setLight(t),this._update(!0),this},i.prototype.getLight=function(){return this.style.getLight()},i.prototype.getContainer=function(){return this._container},i.prototype.getCanvasContainer=function(){return this._canvasContainer},i.prototype.getCanvas=function(){return this._canvas},i.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.offsetWidth||400,e=this._container.offsetHeight||300),[t,e]},i.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSContainer=s.create("div","mapboxgl-missing-css",t)).innerHTML="Missing Mapbox GL JS CSS";var e=this._canvasContainer=s.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=s.create("canvas","mapboxgl-canvas",e),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var n=this._containerDimensions();this._resizeCanvas(n[0],n[1]);var i=this._controlContainer=s.create("div","mapboxgl-control-container",t),r=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(t){r[t]=s.create("div","mapboxgl-ctrl-"+t,i)}))},i.prototype._resizeCanvas=function(e,n){var i=t.default.devicePixelRatio||1;this._canvas.width=i*e,this._canvas.height=i*n,this._canvas.style.width=e+"px",this._canvas.style.height=n+"px"},i.prototype._setupPainter=function(){var n=t.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},e.webGLContextAttributes),i=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);i?this.painter=new Dn(i,this.transform):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},i.prototype._contextLost=function(e){e.preventDefault(),this._frameId&&(o.cancelFrame(this._frameId),this._frameId=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},i.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},i.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!(!this.style||!this.style.loaded())},i.prototype._update=function(t){this.style&&(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this._rerender())},i.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},i.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},i.prototype._render=function(){this._renderTaskQueue.run();var e=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var n=this.transform.zoom,i=o.now();this.style.zoomHistory.update(n,i);var r=new t.default$16(n,{now:i,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),a=r.crossFadingFactor();1===a&&a===this._crossFadingFactor||(e=!0,this._crossFadingFactor=a),this.style.update(r)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),fadeDuration:this._fadeDuration}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||e)&&(this._styleDirty=!0),(this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty)&&this._rerender(),this},i.prototype.remove=function(){this._hash&&this._hash.remove(),o.cancelFrame(this._frameId),this._renderTaskQueue.clear(),this._frameId=null,this.setStyle(null),void 0!==t.default&&(t.default.removeEventListener("resize",this._onWindowResize,!1),t.default.removeEventListener("online",this._onWindowOnline,!1));var e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),hi(this._canvasContainer),hi(this._controlContainer),hi(this._missingCSSContainer),this._container.classList.remove("mapboxgl-map"),this.fire(new t.Event("remove"))},i.prototype._rerender=function(){var t=this;this.style&&!this._frameId&&(this._frameId=o.frame((function(){t._frameId=null,t._render()})))},i.prototype._onWindowOnline=function(){this._update()},i.prototype._onWindowResize=function(){this._trackResize&&this.stop().resize()._update()},r.showTileBoundaries.get=function(){return!!this._showTileBoundaries},r.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},r.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},r.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},r.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},r.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},r.repaint.get=function(){return!!this._repaint},r.repaint.set=function(t){this._repaint=t,this._update()},r.vertices.get=function(){return!!this._vertices},r.vertices.set=function(t){this._vertices=t,this._update()},i.prototype._onData=function(e){this._update("style"===e.dataType),this.fire(new t.Event(e.dataType+"data",e))},i.prototype._onDataLoading=function(e){this.fire(new t.Event(e.dataType+"dataloading",e))},Object.defineProperties(i.prototype,r),i})(ii);function hi(t){t.parentNode&&t.parentNode.removeChild(t)}var pi={showCompass:!0,showZoom:!0},fi=function(e){var n=this;this.options=t.extend({},pi,e),this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this.options.showZoom&&(this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom In",(function(){return n._map.zoomIn()})),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom Out",(function(){return n._map.zoomOut()}))),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset North",(function(){return n._map.resetNorth()})),this._compassArrow=s.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};function di(t,e,n){if(t=new Z(t.lng,t.lat),e){var i=new Z(t.lng-360,t.lat),r=new Z(t.lng+360,t.lat),o=n.locationPoint(t).distSqr(e);n.locationPoint(i).distSqr(e)<o?t=i:n.locationPoint(r).distSqr(e)<o&&(t=r)}for(;Math.abs(t.lng-n.center.lng)>180;){var a=n.locationPoint(t);if(a.x>=0&&a.y>=0&&a.x<=n.width&&a.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}fi.prototype._rotateCompassArrow=function(){var t="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=t},fi.prototype.onAdd=function(t){return this._map=t,this.options.showCompass&&(this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Yn(t,{button:"left",element:this._compass}),this._handler.enable()),this._container},fi.prototype.onRemove=function(){s.remove(this._container),this.options.showCompass&&(this._map.off("rotate",this._rotateCompassArrow),this._handler.disable(),delete this._handler),delete this._map},fi.prototype._createButton=function(t,e,n){var i=s.create("button",t,this._container);return i.type="button",i.setAttribute("aria-label",e),i.addEventListener("click",n),i};var mi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function vi(t,e,n){var i=t.classList;for(var r in mi)i.remove("mapboxgl-"+n+"-anchor-"+r);i.add("mapboxgl-"+n+"-anchor-"+e)}var gi=function(e){if((arguments[0]instanceof t.default.HTMLElement||2===arguments.length)&&(e=t.extend({element:e},arguments[1])),t.bindAll(["_update","_onMapClick"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",e&&e.element)this._element=e.element,this._offset=t.default$1.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=s.create("div");var n=s.createNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"height","41px"),n.setAttributeNS(null,"width","27px"),n.setAttributeNS(null,"viewBox","0 0 27 41");var i=s.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"stroke","none"),i.setAttributeNS(null,"stroke-width","1"),i.setAttributeNS(null,"fill","none"),i.setAttributeNS(null,"fill-rule","evenodd");var r=s.createNS("http://www.w3.org/2000/svg","g");r.setAttributeNS(null,"fill-rule","nonzero");var o=s.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"transform","translate(3.0, 29.0)"),o.setAttributeNS(null,"fill","#000000");for(var a=0,l=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];a<l.length;a+=1){var u=l[a],c=s.createNS("http://www.w3.org/2000/svg","ellipse");c.setAttributeNS(null,"opacity","0.04"),c.setAttributeNS(null,"cx","10.5"),c.setAttributeNS(null,"cy","5.80029008"),c.setAttributeNS(null,"rx",u.rx),c.setAttributeNS(null,"ry",u.ry),o.appendChild(c)}var h=s.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"fill",this._color);var p=s.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),h.appendChild(p);var f=s.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"opacity","0.25"),f.setAttributeNS(null,"fill","#000000");var d=s.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),f.appendChild(d);var m=s.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(6.0, 7.0)"),m.setAttributeNS(null,"fill","#FFFFFF");var v=s.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(8.0, 8.0)");var g=s.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");var y=s.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),v.appendChild(g),v.appendChild(y),r.appendChild(o),r.appendChild(h),r.appendChild(f),r.appendChild(m),r.appendChild(v),n.appendChild(r),this._element.appendChild(n),this._offset=t.default$1.convert(e&&e.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._popup=null};gi.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this._update(),this._map.on("click",this._onMapClick),this},gi.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),delete this._map),s.remove(this._element),this._popup&&this._popup.remove(),this},gi.prototype.getLngLat=function(){return this._lngLat},gi.prototype.setLngLat=function(t){return this._lngLat=Z.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},gi.prototype.getElement=function(){return this._element},gi.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},gi.prototype._onMapClick=function(t){var e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()},gi.prototype.getPopup=function(){return this._popup},gi.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},gi.prototype._update=function(t){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=di(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),t&&"moveend"!==t.type||(this._pos=this._pos.round()),s.setTransform(this._element,mi[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"),vi(this._element,this._anchor,"marker"))},gi.prototype.getOffset=function(){return this._offset},gi.prototype.setOffset=function(e){return this._offset=t.default$1.convert(e),this._update(),this};var yi,_i={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},xi=(function(e){function n(n){e.call(this),this.options=t.extend({},_i,n),t.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.onAdd=function(e){var n;return this._map=e,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,void 0!==yi?n(yi):void 0!==t.default.navigator.permissions?t.default.navigator.permissions.query({name:"geolocation"}).then((function(t){yi="denied"!==t.state,n(yi)})):(yi=!!t.default.navigator.geolocation,n(yi)),this._container},n.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.default.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker.remove(),s.remove(this._container),this._map=void 0},n.prototype._onSuccess=function(e){if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()},n.prototype._updateCamera=function(t){var e=new Z(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy;this._map.fitBounds(e.toBounds(n),this.options.fitBoundsOptions,{geolocateSource:!0})},n.prototype._updateMarker=function(t){t?this._userLocationDotMarker.setLngLat([t.coords.longitude,t.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},n.prototype._onError=function(e){if(this.options.trackUserLocation)if(1===e.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()},n.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},n.prototype._setupUI=function(e){var n=this;!1!==e&&(this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this._geolocateButton=s.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=s.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new gi(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(e){e.geolocateSource||"ACTIVE_LOCK"!==n._watchState||(n._watchState="BACKGROUND",n._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),n._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),n.fire(new t.Event("trackuserlocationend")))})))},n.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=t.default.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else t.default.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},n.prototype._clearWatch=function(){t.default.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},n})(t.Evented),bi={maxWidth:100,unit:"metric"},wi=function(e){this.options=t.extend({},bi,e),t.bindAll(["_onMove","setUnit"],this)};function Ei(t,e,n){var i,r,o,a,s,l,u=n&&n.maxWidth||100,c=t._container.clientHeight/2,h=(i=t.unproject([0,c]),r=t.unproject([u,c]),o=Math.PI/180,a=i.lat*o,s=r.lat*o,l=Math.sin(a)*Math.sin(s)+Math.cos(a)*Math.cos(s)*Math.cos((r.lng-i.lng)*o),6371e3*Math.acos(Math.min(l,1)));if(n&&"imperial"===n.unit){var p=3.2808*h;p>5280?Si(e,u,p/5280,"mi"):Si(e,u,p,"ft")}else n&&"nautical"===n.unit?Si(e,u,h/1852,"nm"):Si(e,u,h,"m")}function Si(t,e,n,i){var r,o,a,s=(r=n,(o=Math.pow(10,(""+Math.floor(r)).length-1))*(a=(a=r/o)>=10?10:a>=5?5:a>=3?3:a>=2?2:1)),l=s/n;"m"===i&&s>=1e3&&(s/=1e3,i="km"),t.style.width=e*l+"px",t.innerHTML=s+i}wi.prototype.getDefaultPosition=function(){return"bottom-left"},wi.prototype._onMove=function(){Ei(this._map,this._container,this.options)},wi.prototype.onAdd=function(t){return this._map=t,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},wi.prototype.onRemove=function(){s.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},wi.prototype.setUnit=function(t){this.options.unit=t,Ei(this._map,this._container,this.options)};var Ci=function(){this._fullscreen=!1,t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.default.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.default.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.default.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.default.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};Ci.prototype.onAdd=function(e){return this._map=e,this._mapContainer=this._map.getContainer(),this._container=s.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._container},Ci.prototype.onRemove=function(){s.remove(this._container),this._map=null,t.default.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ci.prototype._checkFullscreenSupport=function(){return!!(t.default.document.fullscreenEnabled||t.default.document.mozFullScreenEnabled||t.default.document.msFullscreenEnabled||t.default.document.webkitFullscreenEnabled)},Ci.prototype._setupUI=function(){var e=this._fullscreenButton=s.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);e.setAttribute("aria-label","Toggle fullscreen"),e.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.default.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ci.prototype._isFullscreen=function(){return this._fullscreen},Ci.prototype._changeIcon=function(){(t.default.document.fullscreenElement||t.default.document.mozFullScreenElement||t.default.document.webkitFullscreenElement||t.default.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},Ci.prototype._onClickFullscreen=function(){this._isFullscreen()?t.default.document.exitFullscreen?t.default.document.exitFullscreen():t.default.document.mozCancelFullScreen?t.default.document.mozCancelFullScreen():t.default.document.msExitFullscreen?t.default.document.msExitFullscreen():t.default.document.webkitCancelFullScreen&&t.default.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()};var Ti={closeButton:!0,closeOnClick:!0},Ai=(function(e){function n(n){e.call(this),this.options=t.extend(Object.create(Ti),n),t.bindAll(["_update","_onClickClose"],this)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.addTo=function(e){return this._map=e,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this.fire(new t.Event("open")),this},n.prototype.isOpen=function(){return!!this._map},n.prototype.remove=function(){return this._content&&s.remove(this._content),this._container&&(s.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire(new t.Event("close")),this},n.prototype.getLngLat=function(){return this._lngLat},n.prototype.setLngLat=function(t){return this._lngLat=Z.convert(t),this._pos=null,this._update(),this},n.prototype.setText=function(e){return this.setDOMContent(t.default.document.createTextNode(e))},n.prototype.setHTML=function(e){var n,i=t.default.document.createDocumentFragment(),r=t.default.document.createElement("body");for(r.innerHTML=e;n=r.firstChild;)i.appendChild(n);return this.setDOMContent(i)},n.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},n.prototype._createContent=function(){this._content&&s.remove(this._content),this._content=s.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=s.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},n.prototype._update=function(){if(this._map&&this._lngLat&&this._content){this._container||(this._container=s.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=s.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this._map.transform.renderWorldCopies&&(this._lngLat=di(this._lngLat,this._pos,this._map.transform));var e=this._pos=this._map.project(this._lngLat),n=this.options.anchor,i=(function e(n){if(n){if("number"==typeof n){var i=Math.round(Math.sqrt(.5*Math.pow(n,2)));return{center:new t.default$1(0,0),top:new t.default$1(0,n),"top-left":new t.default$1(i,i),"top-right":new t.default$1(-i,i),bottom:new t.default$1(0,-n),"bottom-left":new t.default$1(i,-i),"bottom-right":new t.default$1(-i,-i),left:new t.default$1(n,0),right:new t.default$1(-n,0)}}if(n instanceof t.default$1||Array.isArray(n)){var r=t.default$1.convert(n);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:t.default$1.convert(n.center||[0,0]),top:t.default$1.convert(n.top||[0,0]),"top-left":t.default$1.convert(n["top-left"]||[0,0]),"top-right":t.default$1.convert(n["top-right"]||[0,0]),bottom:t.default$1.convert(n.bottom||[0,0]),"bottom-left":t.default$1.convert(n["bottom-left"]||[0,0]),"bottom-right":t.default$1.convert(n["bottom-right"]||[0,0]),left:t.default$1.convert(n.left||[0,0]),right:t.default$1.convert(n.right||[0,0])}}return e(new t.default$1(0,0))})(this.options.offset);if(!n){var r,o=this._container.offsetWidth,a=this._container.offsetHeight;r=e.y+i.bottom.y<a?["top"]:e.y>this._map.transform.height-a?["bottom"]:[],e.x<o/2?r.push("left"):e.x>this._map.transform.width-o/2&&r.push("right"),n=0===r.length?"bottom":r.join("-")}var l=e.add(i[n]).round();s.setTransform(this._container,mi[n]+" translate("+l.x+"px,"+l.y+"px)"),vi(this._container,n,"popup")}},n.prototype._onClickClose=function(){this.remove()},n})(t.Evented),Mi={version:"0.45.0",supported:e,workerCount:Math.max(Math.floor(o.hardwareConcurrency/2),1),setRTLTextPlugin:t.setRTLTextPlugin,Map:ci,NavigationControl:fi,GeolocateControl:xi,AttributionControl:ri,ScaleControl:wi,FullscreenControl:Ci,Popup:Ai,Marker:gi,Style:Ke,LngLat:Z,LngLatBounds:G,Point:t.default$1,Evented:t.Evented,config:v,get accessToken(){return v.ACCESS_TOKEN},set accessToken(t){v.ACCESS_TOKEN=t},workerUrl:""};return Mi})),n}))},83:function(t,e,n){
/*!
 * 
 *         SimpleBar.js - v2.6.1
 *         Scrollbars, simpler.
 *         https://grsmto.github.io/simplebar/
 *         
 *         Made by Adrien Grsmto from a fork by Jonathan Nicol
 *         Under MIT License
 *       
 */
t.exports=(function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=27)})([(function(t,e,n){var i=n(23)("wks"),r=n(12),o=n(1).Symbol,a="function"==typeof o;(t.exports=function(t){return i[t]||(i[t]=a&&o[t]||(a?o:r)("Symbol."+t))}).store=i}),(function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)}),(function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}}),(function(t,e){var n=t.exports={version:"2.5.1"};"number"==typeof __e&&(__e=n)}),(function(t,e,n){var i=n(5),r=n(11);t.exports=n(7)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}}),(function(t,e,n){var i=n(6),r=n(33),o=n(34),a=Object.defineProperty;e.f=n(7)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}}),(function(t,e,n){var i=n(10);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}}),(function(t,e,n){t.exports=!n(16)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))}),(function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}}),(function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}}),(function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}}),(function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}}),(function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}}),(function(t,e){t.exports={}}),(function(t,e,n){var i=n(23)("keys"),r=n(12);t.exports=function(t){return i[t]||(i[t]=r(t))}}),(function(t,e,n){var i=n(1),r=n(3),o=n(4),a=n(18),s=n(19),l=function(t,e,n){var u,c,h,p,f=t&l.F,d=t&l.G,m=t&l.S,v=t&l.P,g=t&l.B,y=d?i:m?i[e]||(i[e]={}):(i[e]||{}).prototype,_=d?r:r[e]||(r[e]={}),x=_.prototype||(_.prototype={});for(u in d&&(n=e),n)c=!f&&y&&void 0!==y[u],h=(c?y:n)[u],p=g&&c?s(h,i):v&&"function"==typeof h?s(Function.call,h):h,y&&a(y,u,h,t&l.U),_[u]!=h&&o(_,u,p),v&&x[u]!=h&&(x[u]=h)};i.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l}),(function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}}),(function(t,e,n){var i=n(10),r=n(1).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}}),(function(t,e,n){var i=n(1),r=n(4),o=n(2),a=n(12)("src"),s=Function.toString,l=(""+s).split("toString");n(3).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var u="function"==typeof n;u&&(o(n,"name")||r(n,"name",e)),t[e]!==n&&(u&&(o(n,a)||r(n,a,t[e]?""+t[e]:l.join(String(e)))),t===i?t[e]=n:s?t[e]?t[e]=n:r(t,e,n):(delete t[e],r(t,e,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))}),(function(t,e,n){var i=n(35);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}}),(function(t,e,n){var i=n(41),r=n(9);t.exports=function(t){return i(r(t))}}),(function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}}),(function(t,e,n){var i=n(8),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}}),(function(t,e,n){var i=n(1),r=i["__core-js_shared__"]||(i["__core-js_shared__"]={});t.exports=function(t){return r[t]||(r[t]={})}}),(function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")}),(function(t,e,n){var i=n(5).f,r=n(2),o=n(0)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}}),(function(t,e,n){var i=n(9);t.exports=function(t){return Object(i(t))}}),(function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(28);var o=i(n(53)),a=i(n(54)),s=i(n(56));n(57),Object.assign=n(58);var l=(function(){function t(e,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.el=e,this.flashTimeout,this.contentEl,this.scrollContentEl,this.dragOffset={x:0,y:0},this.isVisible={x:!0,y:!0},this.scrollOffsetAttr={x:"scrollLeft",y:"scrollTop"},this.sizeAttr={x:"offsetWidth",y:"offsetHeight"},this.scrollSizeAttr={x:"scrollWidth",y:"scrollHeight"},this.offsetAttr={x:"left",y:"top"},this.globalObserver,this.mutationObserver,this.resizeObserver,this.currentAxis,this.isRtl,this.options=Object.assign({},t.defaultOptions,n),this.classNames=this.options.classNames,this.scrollbarWidth=(0,o.default)(),this.offsetSize=20,this.flashScrollbar=this.flashScrollbar.bind(this),this.onDragY=this.onDragY.bind(this),this.onDragX=this.onDragX.bind(this),this.onScrollY=this.onScrollY.bind(this),this.onScrollX=this.onScrollX.bind(this),this.drag=this.drag.bind(this),this.onEndDrag=this.onEndDrag.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.recalculate=(0,a.default)(this.recalculate,100,{leading:!0}),this.init()}return (function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)})(t,[{key:"init",value:function(){this.el.SimpleBar=this,this.initDOM(),this.scrollbarX=this.trackX.querySelector(".".concat(this.classNames.scrollbar)),this.scrollbarY=this.trackY.querySelector(".".concat(this.classNames.scrollbar)),this.isRtl="rtl"===getComputedStyle(this.contentEl).direction,this.scrollContentEl.style[this.isRtl?"paddingLeft":"paddingRight"]="".concat(this.scrollbarWidth||this.offsetSize,"px"),this.scrollContentEl.style.marginBottom="-".concat(2*this.scrollbarWidth||this.offsetSize,"px"),this.contentEl.style.paddingBottom="".concat(this.scrollbarWidth||this.offsetSize,"px"),0!==this.scrollbarWidth&&(this.contentEl.style[this.isRtl?"marginLeft":"marginRight"]="-".concat(this.scrollbarWidth,"px")),this.recalculate(),this.initListeners()}},{key:"initDOM",value:function(){var t=this;if(Array.from(this.el.children).filter((function(e){return e.classList.contains(t.classNames.scrollContent)})).length)this.trackX=this.el.querySelector(".".concat(this.classNames.track,".horizontal")),this.trackY=this.el.querySelector(".".concat(this.classNames.track,".vertical")),this.scrollContentEl=this.el.querySelector(".".concat(this.classNames.scrollContent)),this.contentEl=this.el.querySelector(".".concat(this.classNames.content));else{for(this.scrollContentEl=document.createElement("div"),this.contentEl=document.createElement("div"),this.scrollContentEl.classList.add(this.classNames.scrollContent),this.contentEl.classList.add(this.classNames.content);this.el.firstChild;)this.contentEl.appendChild(this.el.firstChild);this.scrollContentEl.appendChild(this.contentEl),this.el.appendChild(this.scrollContentEl)}if(!this.trackX||!this.trackY){var e=document.createElement("div"),n=document.createElement("div");e.classList.add(this.classNames.track),n.classList.add(this.classNames.scrollbar),e.appendChild(n),this.trackX=e.cloneNode(!0),this.trackX.classList.add("horizontal"),this.trackY=e.cloneNode(!0),this.trackY.classList.add("vertical"),this.el.insertBefore(this.trackX,this.el.firstChild),this.el.insertBefore(this.trackY,this.el.firstChild)}this.el.setAttribute("data-simplebar","init")}},{key:"initListeners",value:function(){var t=this;this.options.autoHide&&this.el.addEventListener("mouseenter",this.onMouseEnter),this.scrollbarY.addEventListener("mousedown",this.onDragY),this.scrollbarX.addEventListener("mousedown",this.onDragX),this.scrollContentEl.addEventListener("scroll",this.onScrollY),this.contentEl.addEventListener("scroll",this.onScrollX),"undefined"!=typeof MutationObserver&&(this.mutationObserver=new MutationObserver(function(e){e.forEach((function(e){(t.isChildNode(e.target)||e.addedNodes.length)&&t.recalculate()}))}),this.mutationObserver.observe(this.el,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this.resizeObserver=new s.default(this.recalculate.bind(this)),this.resizeObserver.observe(this.el)}},{key:"removeListeners",value:function(){this.options.autoHide&&this.el.removeEventListener("mouseenter",this.onMouseEnter),this.scrollbarX.removeEventListener("mousedown",this.onDragX),this.scrollbarY.removeEventListener("mousedown",this.onDragY),this.scrollContentEl.removeEventListener("scroll",this.onScrollY),this.contentEl.removeEventListener("scroll",this.onScrollX),this.mutationObserver.disconnect(),this.resizeObserver.disconnect()}},{key:"onDragX",value:function(t){this.onDrag(t,"x")}},{key:"onDragY",value:function(t){this.onDrag(t,"y")}},{key:"onDrag",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y";t.preventDefault();var n="y"===e?this.scrollbarY:this.scrollbarX,i="y"===e?t.pageY:t.pageX;this.dragOffset[e]=i-n.getBoundingClientRect()[this.offsetAttr[e]],this.currentAxis=e,document.addEventListener("mousemove",this.drag),document.addEventListener("mouseup",this.onEndDrag)}},{key:"drag",value:function(t){var e,n,i;t.preventDefault(),"y"===this.currentAxis?(e=t.pageY,n=this.trackY,i=this.scrollContentEl):(e=t.pageX,n=this.trackX,i=this.contentEl);var r=e-n.getBoundingClientRect()[this.offsetAttr[this.currentAxis]]-this.dragOffset[this.currentAxis],o=r/n[this.sizeAttr[this.currentAxis]],a=o*this.contentEl[this.scrollSizeAttr[this.currentAxis]];i[this.scrollOffsetAttr[this.currentAxis]]=a}},{key:"onEndDrag",value:function(){document.removeEventListener("mousemove",this.drag),document.removeEventListener("mouseup",this.onEndDrag)}},{key:"resizeScrollbar",value:function(){var t,e,n,i,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y";"x"===o?(t=this.trackX,e=this.scrollbarX,n=this.contentEl[this.scrollOffsetAttr[o]],i=this.contentSizeX,r=this.scrollbarXSize):(t=this.trackY,e=this.scrollbarY,n=this.scrollContentEl[this.scrollOffsetAttr[o]],i=this.contentSizeY,r=this.scrollbarYSize);var a=r/i,s=n/(i-r),l=Math.max(~~(a*r),this.options.scrollbarMinSize),u=~~((r-l)*s);this.isVisible[o]=r<i,this.isVisible[o]||this.options.forceVisible?(t.style.visibility="visible",this.options.forceVisible?e.style.visibility="hidden":e.style.visibility="visible","x"===o?(e.style.left="".concat(u,"px"),e.style.width="".concat(l,"px")):(e.style.top="".concat(u,"px"),e.style.height="".concat(l,"px"))):t.style.visibility="hidden"}},{key:"onScrollX",value:function(){this.flashScrollbar("x")}},{key:"onScrollY",value:function(){this.flashScrollbar("y")}},{key:"onMouseEnter",value:function(){this.flashScrollbar("x"),this.flashScrollbar("y")}},{key:"flashScrollbar",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y";this.resizeScrollbar(t),this.showScrollbar(t)}},{key:"showScrollbar",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y";this.isVisible[t]&&("x"===t?this.scrollbarX.classList.add("visible"):this.scrollbarY.classList.add("visible"),this.options.autoHide&&("number"==typeof this.flashTimeout&&window.clearTimeout(this.flashTimeout),this.flashTimeout=window.setTimeout(this.hideScrollbar.bind(this),1e3)))}},{key:"hideScrollbar",value:function(){this.scrollbarX.classList.remove("visible"),this.scrollbarY.classList.remove("visible"),"number"==typeof this.flashTimeout&&window.clearTimeout(this.flashTimeout)}},{key:"recalculate",value:function(){this.contentSizeX=this.contentEl[this.scrollSizeAttr.x],this.contentSizeY=this.contentEl[this.scrollSizeAttr.y]-(this.scrollbarWidth||this.offsetSize),this.scrollbarXSize=this.trackX[this.sizeAttr.x],this.scrollbarYSize=this.trackY[this.sizeAttr.y],this.resizeScrollbar("x"),this.resizeScrollbar("y"),this.options.autoHide||(this.showScrollbar("x"),this.showScrollbar("y"))}},{key:"getScrollElement",value:function(){return"y"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y")?this.scrollContentEl:this.contentEl}},{key:"getContentElement",value:function(){return this.contentEl}},{key:"unMount",value:function(){this.removeListeners(),this.el.SimpleBar=null}},{key:"isChildNode",value:function(t){return null!==t&&(t===this.el||this.isChildNode(t.parentNode))}}],[{key:"initHtmlApi",value:function(){this.initDOMLoadedElements=this.initDOMLoadedElements.bind(this),"undefined"!=typeof MutationObserver&&(this.globalObserver=new MutationObserver(function(e){e.forEach((function(e){Array.from(e.addedNodes).forEach((function(e){1===e.nodeType&&(e.hasAttribute("data-simplebar")?!e.SimpleBar&&new t(e,t.getElOptions(e)):Array.from(e.querySelectorAll("[data-simplebar]")).forEach((function(e){!e.SimpleBar&&new t(e,t.getElOptions(e))})))})),Array.from(e.removedNodes).forEach((function(t){1===t.nodeType&&(t.hasAttribute("data-simplebar")?t.SimpleBar&&t.SimpleBar.unMount():Array.from(t.querySelectorAll("[data-simplebar]")).forEach((function(t){t.SimpleBar&&t.SimpleBar.unMount()})))}))}))}),this.globalObserver.observe(document,{childList:!0,subtree:!0})),"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?window.setTimeout(this.initDOMLoadedElements.bind(this)):(document.addEventListener("DOMContentLoaded",this.initDOMLoadedElements),window.addEventListener("load",this.initDOMLoadedElements))}},{key:"getElOptions",value:function(e){return Object.keys(t.htmlAttributes).reduce((function(n,i){var r=t.htmlAttributes[i];return e.hasAttribute(r)&&(n[i]=JSON.parse(e.getAttribute(r)||!0)),n}),{})}},{key:"removeObserver",value:function(){this.globalObserver.disconnect()}},{key:"initDOMLoadedElements",value:function(){document.removeEventListener("DOMContentLoaded",this.initDOMLoadedElements),window.removeEventListener("load",this.initDOMLoadedElements),Array.from(document.querySelectorAll("[data-simplebar]")).forEach((function(e){e.SimpleBar||new t(e,t.getElOptions(e))}))}},{key:"defaultOptions",get:function(){return{autoHide:!0,forceVisible:!1,classNames:{content:"simplebar-content",scrollContent:"simplebar-scroll-content",scrollbar:"simplebar-scrollbar",track:"simplebar-track"},scrollbarMinSize:25}}},{key:"htmlAttributes",get:function(){return{autoHide:"data-simplebar-auto-hide",forceVisible:"data-simplebar-force-visible",scrollbarMinSize:"data-simplebar-scrollbar-min-size"}}}]),t})();e.default=l,l.initHtmlApi()}),(function(t,e,n){n(29),n(46),t.exports=n(3).Array.from}),(function(t,e,n){"use strict";var i=n(30)(!0);n(31)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})}))}),(function(t,e,n){var i=n(8),r=n(9);t.exports=function(t){return function(e,n){var o,a,s=String(r(e)),l=i(n),u=s.length;return l<0||l>=u?t?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):o:t?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}}}),(function(t,e,n){"use strict";var i=n(32),r=n(15),o=n(18),a=n(4),s=n(2),l=n(13),u=n(36),c=n(25),h=n(45),p=n(0)("iterator"),f=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,n,m,v,g,y){u(n,e,m);var _,x,b,w=function(t){if(!f&&t in T)return T[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},E=e+" Iterator",S="values"==v,C=!1,T=t.prototype,A=T[p]||T["@@iterator"]||v&&T[v],M=A||w(v),I=v?S?w("entries"):M:void 0,k="Array"==e&&T.entries||A;if(k&&(b=h(k.call(new t)))!==Object.prototype&&b.next&&(c(b,E,!0),i||s(b,p)||a(b,p,d)),S&&A&&"values"!==A.name&&(C=!0,M=function(){return A.call(this)}),i&&!y||!f&&!C&&T[p]||a(T,p,M),l[e]=M,l[E]=d,v)if(_={values:S?M:w("values"),keys:g?M:w("keys"),entries:I},y)for(x in _)x in T||o(T,x,_[x]);else r(r.P+r.F*(f||C),e,_);return _}}),(function(t,e){t.exports=!1}),(function(t,e,n){t.exports=!n(7)&&!n(16)((function(){return 7!=Object.defineProperty(n(17)("div"),"a",{get:function(){return 7}}).a}))}),(function(t,e,n){var i=n(10);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}}),(function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}}),(function(t,e,n){"use strict";var i=n(37),r=n(11),o=n(25),a={};n(4)(a,n(0)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=i(a,{next:r(1,n)}),o(t,e+" Iterator")}}),(function(t,e,n){var i=n(6),r=n(38),o=n(24),a=n(14)("IE_PROTO"),s=function(){},l=function(){var t,e=n(17)("iframe"),i=o.length;for(e.style.display="none",n(44).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;i--;)delete l.prototype[o[i]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=i(t),n=new s,s.prototype=null,n[a]=t):n=l(),void 0===e?n:r(n,e)}}),(function(t,e,n){var i=n(5),r=n(6),o=n(39);t.exports=n(7)?Object.defineProperties:function(t,e){r(t);for(var n,a=o(e),s=a.length,l=0;s>l;)i.f(t,n=a[l++],e[n]);return t}}),(function(t,e,n){var i=n(40),r=n(24);t.exports=Object.keys||function(t){return i(t,r)}}),(function(t,e,n){var i=n(2),r=n(20),o=n(42)(!1),a=n(14)("IE_PROTO");t.exports=function(t,e){var n,s=r(t),l=0,u=[];for(n in s)n!=a&&i(s,n)&&u.push(n);for(;e.length>l;)i(s,n=e[l++])&&(~o(u,n)||u.push(n));return u}}),(function(t,e,n){var i=n(21);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}}),(function(t,e,n){var i=n(20),r=n(22),o=n(43);t.exports=function(t){return function(e,n,a){var s,l=i(e),u=r(l.length),c=o(a,u);if(t&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}}}),(function(t,e,n){var i=n(8),r=Math.max,o=Math.min;t.exports=function(t,e){return(t=i(t))<0?r(t+e,0):o(t,e)}}),(function(t,e,n){var i=n(1).document;t.exports=i&&i.documentElement}),(function(t,e,n){var i=n(2),r=n(26),o=n(14)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}}),(function(t,e,n){"use strict";var i=n(19),r=n(15),o=n(26),a=n(47),s=n(48),l=n(22),u=n(49),c=n(50);r(r.S+r.F*!n(52)((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,r,h,p=o(t),f="function"==typeof this?this:Array,d=arguments.length,m=d>1?arguments[1]:void 0,v=void 0!==m,g=0,y=c(p);if(v&&(m=i(m,d>2?arguments[2]:void 0,2)),void 0==y||f==Array&&s(y))for(e=l(p.length),n=new f(e);e>g;g++)u(n,g,v?m(p[g],g):p[g]);else for(h=y.call(p),n=new f;!(r=h.next()).done;g++)u(n,g,v?a(h,m,[r.value,g],!0):r.value);return n.length=g,n}})}),(function(t,e,n){var i=n(6);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&i(o.call(t)),e}}}),(function(t,e,n){var i=n(13),r=n(0)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}}),(function(t,e,n){"use strict";var i=n(5),r=n(11);t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}}),(function(t,e,n){var i=n(51),r=n(0)("iterator"),o=n(13);t.exports=n(3).getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||o[i(t)]}}),(function(t,e,n){var i=n(21),r=n(0)("toStringTag"),o="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=(function(t,e){try{return t[e]}catch(t){}})(e=Object(t),r))?n:o?i(e):"Object"==(a=i(e))&&"function"==typeof e.callee?"Arguments":a}}),(function(t,e,n){var i=n(0)("iterator"),r=!1;try{var o=[7][i]();o.return=function(){r=!0},Array.from(o,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o=[7],a=o[i]();a.next=function(){return{done:n=!0}},o[i]=function(){return a},t(o)}catch(t){}return n}}),(function(t,e,n){var i,r,o;/*! scrollbarWidth.js v0.1.3 | felixexter | MIT | https://github.com/felixexter/scrollbarWidth */r=[],void 0!==(o="function"==typeof(i=function(){"use strict";return function(){if("undefined"==typeof document)return 0;var t,e=document.body,n=document.createElement("div"),i=n.style;return i.position="absolute",i.top=i.left="-9999px",i.width=i.height="100px",i.overflow="scroll",e.appendChild(n),t=n.offsetWidth-n.clientWidth,e.removeChild(n),t}})?i.apply(e,r):i)&&(t.exports=o)}),(function(t,e,n){(function(e){function n(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function i(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||(function(t){return!!t&&"object"==typeof t})(t)&&v.call(t)==a}(t))return o;if(n(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=n(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var i=u.test(t);return i||c.test(t)?h(t.slice(2),i?2:8):l.test(t)?o:+t}var r="Expected a function",o=NaN,a="[object Symbol]",s=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,h=parseInt,p="object"==typeof e&&e&&e.Object===Object&&e,f="object"==typeof self&&self&&self.Object===Object&&self,d=p||f||Function("return this")(),m=Object.prototype,v=m.toString,g=Math.max,y=Math.min,_=function(){return d.Date.now()};t.exports=function(t,e,o){function a(e){var n=h,i=p;return h=p=void 0,x=e,d=t.apply(i,n)}function s(t){var n=t-v,i=t-x;return void 0===v||n>=e||n<0||w&&i>=f}function l(){var t=_();if(s(t))return u(t);m=setTimeout(l,(function(t){var n=e-(t-v);return w?y(n,f-(t-x)):n})(t))}function u(t){return m=void 0,E&&h?a(t):(h=p=void 0,d)}function c(){var t=_(),n=s(t);if(h=arguments,p=this,v=t,n){if(void 0===m)return (function(t){return x=t,m=setTimeout(l,e),b?a(t):d})(v);if(w)return m=setTimeout(l,e),a(v)}return void 0===m&&(m=setTimeout(l,e)),d}var h,p,f,d,m,v,x=0,b=!1,w=!1,E=!0;if("function"!=typeof t)throw new TypeError(r);return e=i(e)||0,n(o)&&(b=!!o.leading,f=(w="maxWait"in o)?g(i(o.maxWait)||0,e):f,E="trailing"in o?!!o.trailing:E),c.cancel=function(){void 0!==m&&clearTimeout(m),x=0,h=v=p=m=void 0},c.flush=function(){return void 0===m?d:u(_())},c}}).call(e,n(55))}),(function(t,e){var n;n=(function(){return this})();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n}),(function(t,e,n){"use strict";function i(t){return parseFloat(t)||0}function r(t){return Array.prototype.slice.call(arguments,1).reduce((function(e,n){return e+i(t["border-"+n+"-width"])}),0)}function o(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return g;var o=getComputedStyle(t),a=(function(t){for(var e={},n=0,r=["top","right","bottom","left"];n<r.length;n+=1){var o=r[n],a=t["padding-"+o];e[o]=i(a)}return e})(o),l=a.left+a.right,u=a.top+a.bottom,c=i(o.width),h=i(o.height);if("border-box"===o.boxSizing&&(Math.round(c+l)!==e&&(c-=r(o,"left","right")+l),Math.round(h+u)!==n&&(h-=r(o,"top","bottom")+u)),!(function(t){return t===document.documentElement})(t)){var p=Math.round(c+l)-e,f=Math.round(h+u)-n;1!==Math.abs(p)&&(c-=p),1!==Math.abs(f)&&(h-=f)}return s(a.left,a.top,c,h)}function a(t){return u?y(t)?(function(t){var e=t.getBBox();return s(0,0,e.width,e.height)})(t):o(t):g}function s(t,e,n,i){return{x:t,y:e,width:n,height:i}}Object.defineProperty(e,"__esModule",{value:!0});var l=(function(){function t(t,e){var n=-1;return t.some((function(t,i){return t[0]===e&&(n=i,!0)})),n}return"undefined"!=typeof Map?Map:(function(){function e(){this.__entries__=[]}var n={size:{}};return n.size.get=function(){return this.__entries__.length},e.prototype.get=function(e){var n=t(this.__entries__,e),i=this.__entries__[n];return i&&i[1]},e.prototype.set=function(e,n){var i=t(this.__entries__,e);~i?this.__entries__[i][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,i=t(n,e);~i&&n.splice(i,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var n=0,i=this.__entries__;n<i.length;n+=1){var r=i[n];t.call(e,r[1],r[0])}},Object.defineProperties(e.prototype,n),e})()})(),u="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,c="function"==typeof requestAnimationFrame?requestAnimationFrame:function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)},h=2,p=["top","right","bottom","left","width","height","size","weight"],f="undefined"!=typeof navigator&&/Trident\/.*rv:11/.test(navigator.userAgent),d="undefined"!=typeof MutationObserver&&!f,m=function(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=(function(t,e){function n(){o&&(o=!1,t()),a&&r()}function i(){c(n)}function r(){var t=Date.now();if(o){if(t-s<h)return;a=!0}else o=!0,a=!1,setTimeout(i,e);s=t}var o=!1,a=!1,s=0;return r})(this.refresh.bind(this),20)};m.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},m.prototype.removeObserver=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.connected_&&this.disconnect_()},m.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},m.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},m.prototype.connect_=function(){u&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),d?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},m.prototype.disconnect_=function(){u&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},m.prototype.onTransitionEnd_=function(t){var e=t.propertyName;p.some((function(t){return!!~e.indexOf(t)}))&&this.refresh()},m.getInstance=function(){return this.instance_||(this.instance_=new m),this.instance_},m.instance_=null;var v=function(t,e){for(var n=0,i=Object.keys(e);n<i.length;n+=1){var r=i[n];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},g=s(0,0,0,0),y="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof SVGGraphicsElement}:function(t){return t instanceof SVGElement&&"function"==typeof t.getBBox},_=function(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=s(0,0,0,0),this.target=t};_.prototype.isActive=function(){var t=a(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},_.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t};var x=function(t,e){var n=(function(t){var e=t.x,n=t.y,i=t.width,r=t.height,o="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,a=Object.create(o.prototype);return v(a,{x:e,y:n,width:i,height:r,top:n,right:e+i,bottom:r+n,left:e}),a})(e);v(this,{target:t,contentRect:n})},b=function(t,e,n){if("function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.activeObservations_=[],this.observations_=new l,this.callback_=t,this.controller_=e,this.callbackCtx_=n};b.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new _(t)),this.controller_.addObserver(this),this.controller_.refresh())}},b.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},b.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},b.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},b.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new x(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},b.prototype.clearActive=function(){this.activeObservations_.splice(0)},b.prototype.hasActive=function(){return this.activeObservations_.length>0};var w="undefined"!=typeof WeakMap?new WeakMap:new l,E=function(t){if(!(this instanceof E))throw new TypeError("Cannot call a class as a function");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var e=m.getInstance(),n=new b(t,e,this);w.set(this,n)};["observe","unobserve","disconnect"].forEach((function(t){E.prototype[t]=function(){return(e=w.get(this))[t].apply(e,arguments);var e}}));var S="undefined"!=typeof ResizeObserver?ResizeObserver:E;e.default=S}),(function(t,e){}),(function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=(function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}})()?Object.assign:function(t,e){for(var n,a,s=(function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)})(t),l=1;l<arguments.length;l++){for(var u in n=Object(arguments[l]))r.call(n,u)&&(s[u]=n[u]);if(i){a=i(n);for(var c=0;c<a.length;c++)o.call(n,a[c])&&(s[a[c]]=n[a[c]])}}return s}})]).default},94:function(t,e){var n,i,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!(function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}})();var l,u=[],c=!1,h=-1;function p(){c&&l&&(c=!1,l.length?u=l.concat(u):h=-1,u.length&&f())}function f(){if(!c){var t=s(p);c=!0;for(var e=u.length;e;){for(l=u,u=[];++h<e;)l&&l[h].run();h=-1,e=u.length}l=null,c=!1,(function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}})(t)}}function d(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new d(t,e)),1!==u.length||c||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},95:function(t,e,n){(function(t,e){!(function(t,n){"use strict";if(!t.setImmediate){var i,r,o,a,s,l=1,u={},c=!1,h=t.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(t);p=p&&p.setTimeout?p:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick((function(){d(t)}))}:!(function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}})()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){d(t.data)},i=function(t){o.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(r=h.documentElement,i=function(t){var e=h.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e)}):i=function(t){setTimeout(d,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&d(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),i=function(e){t.postMessage(a+e,"*")}),p.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return u[l]=r,i(l),l++},p.clearImmediate=f}function f(t){delete u[t]}function d(t){if(c)setTimeout(d,0,t);else{var e=u[t];if(e){c=!0;try{!(function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(n,i)}})(e)}finally{f(t),c=!1}}}}})("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(11),n(94))},96:function(t,e,n){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(r.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new o(r.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(95),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(11))}}]);